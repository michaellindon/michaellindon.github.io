<!DOCTYPE html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width" />

<link rel="profile" href="http://gmpg.org/xfn/11" />
<link rel="pingback" href="http://www.lindonslog.com/xmlrpc.php" />
<link href='http://fonts.googleapis.com/css?family=Economica:400,400italic,700,700italic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=PT+Sans:400,700' rel='stylesheet' type='text/css'>
<!--[if lt IE 9]>
<script src="http://www.lindonslog.com/wp-content/themes/Winter/js/html5.js" type="text/javascript"></script>
<![endif]-->


<!-- This site is optimized with the Yoast SEO plugin v3.1.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Woodbury Matrix Inverse Identity - Ive Moved</title>
<link rel="canonical" href="https://michaellindon.github.io/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Woodbury Matrix Inverse Identity - Ive Moved" />
<meta property="og:description" content="Application in Conditional Distribution of Multivariate Normal The Sherman-Woodbury-Morrison matrix inverse identity can be regarded as a transform between Schur complements. That is, given one can obtain by using the Woodbury matrix identity and vice versa. Recall the Woodbury Identity: and I recently stumbled across a neat application of this whilst deriving full conditionals for &hellip;" />
<meta property="og:url" content="http://www.lindonslog.com/mathematics/woodbury-matrix-inverse-multivariate-normal/" />
<meta property="og:site_name" content="Ive Moved" />
<meta property="article:section" content="Linear Algebra" />
<meta property="article:published_time" content="2013-07-31T19:10:37+00:00" />
<meta property="article:modified_time" content="2014-06-03T19:53:34+00:00" />
<meta property="og:updated_time" content="2014-06-03T19:53:34+00:00" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="Application in Conditional Distribution of Multivariate Normal The Sherman-Woodbury-Morrison matrix inverse identity can be regarded as a transform between Schur complements. That is, given one can obtain by using the Woodbury matrix identity and vice versa. Recall the Woodbury Identity: and I recently stumbled across a neat application of this whilst deriving full conditionals for [&hellip;]" />
<meta name="twitter:title" content="Woodbury Matrix Inverse Identity - Ive Moved" />
<meta name="twitter:site" content="@lindonslog" />
<meta name="twitter:creator" content="@lindonslog" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='http://s0.wp.com/' />
<link rel='dns-prefetch' href='http://s.gravatar.com/' />
<link rel='dns-prefetch' href='http://s.w.org/' />
<link rel="alternate" type="application/rss+xml" title="Ive Moved &raquo; Feed" href="../../feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="Ive Moved &raquo; Comments Feed" href="../../comments/feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="Ive Moved &raquo; Woodbury Matrix Inverse Identity Comments Feed" href="feed/index.html" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/www.lindonslog.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.1"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='papercite_css-css'  href='../../wp-content/plugins/papercite/papercite.css%3Fver=4.6.1.css' type='text/css' media='all' />
<link rel='stylesheet' id='style-css'  href='../../wp-content/themes/Winter/style.css%3Fver=4.6.1.css' type='text/css' media='all' />
<link rel='stylesheet' id='grid-css'  href='../../wp-content/themes/Winter/css/grid.css%3Fver=4.6.1.css' type='text/css' media='all' />
<link rel='stylesheet' id='wp-style-css'  href='../../wp-content/themes/Winter/css/wp-style.css%3Fver=4.6.1.css' type='text/css' media='all' />
<link rel='stylesheet' id='fontwaesome-css'  href='../../wp-content/themes/Winter/css/font-awesome.css%3Fver=4.6.1.css' type='text/css' media='all' />
<link rel='stylesheet' id='fontwaesome-ie-css'  href='../../wp-content/themes/Winter/css/font-awesome-ie7.css%3Fver=4.6.1.css' type='text/css' media='all' />
<link rel='stylesheet' id='flexslider-css'  href='../../wp-content/themes/Winter/css/flexslider.css%3Fver=4.6.1.css' type='text/css' media='all' />
<link rel='stylesheet' id='fancybox-css'  href='../../wp-content/themes/Winter/css/jquery.fancybox.css%3Fver=4.6.1.css' type='text/css' media='all' />
<link rel='stylesheet' id='genericons-css'  href='../../wp-content/plugins/jetpack/_inc/genericons/genericons/genericons.css%3Fver=3.1.css' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='../../wp-content/plugins/jetpack/css/jetpack.css%3Fver=3.9.7.css' type='text/css' media='all' />
<script type='text/javascript' src='../../wp-includes/js/jquery/jquery.js%3Fver=1.12.4'></script>
<script type='text/javascript' src='../../wp-includes/js/jquery/jquery-migrate.min.js%3Fver=1.4.1'></script>
<script type='text/javascript' src='../../wp-content/plugins/papercite/js/papercite.js%3Fver=4.6.1'></script>
<script type='text/javascript' src='../../wp-content/themes/Winter/js/jquery.flexslider-min.js%3Fver=1'></script>
<script type='text/javascript' src='../../wp-content/themes/Winter/js/jquery.fancybox.pack.js%3Fver=1'></script>
<script type='text/javascript' src='../../wp-content/themes/Winter/js/jwplayer.js%3Fver=1'></script>
<script type='text/javascript' src='../../wp-content/themes/Winter/js/custom.js%3Fver=1'></script>
<link rel='https://api.w.org/' href='../../wp-json/index.html' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../xmlrpc.php%3Frsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 4.6.1" />
<link rel='shortlink' href='http://wp.me/p1QEx5-aH' />
<link rel="alternate" type="application/json+oembed" href="../../wp-json/oembed/1.0/embed%3Furl=http%253A%252F%252Fwww.lindonslog.com%252Fmathematics%252Fwoodbury-matrix-inverse-multivariate-normal%252F" />
<link rel="alternate" type="text/xml+oembed" href="../../wp-json/oembed/1.0/embed%3Furl=http%253A%252F%252Fwww.lindonslog.com%252Fmathematics%252Fwoodbury-matrix-inverse-multivariate-normal%252F&amp;format=xml" />

<link rel='dns-prefetch' href='http://jetpack.wordpress.com/'>
<link rel='dns-prefetch' href='http://s0.wp.com/'>
<link rel='dns-prefetch' href='http://s1.wp.com/'>
<link rel='dns-prefetch' href='http://s2.wp.com/'>
<link rel='dns-prefetch' href='http://public-api.wordpress.com/'>
<link rel='dns-prefetch' href='http://0.gravatar.com/'>
<link rel='dns-prefetch' href='http://1.gravatar.com/'>
<link rel='dns-prefetch' href='http://2.gravatar.com/'>
<link rel='dns-prefetch' href='http://widgets.wp.com/'>
<style type="text/css" id="syntaxhighlighteranchor"></style>
<link rel="icon" href="../../wp-content/uploads/2015/09/cropped-L-32x32.png" sizes="32x32" />
<link rel="icon" href="../../wp-content/uploads/2015/09/cropped-L-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon-precomposed" href="../../wp-content/uploads/2015/09/cropped-L-180x180.png" />
<meta name="msapplication-TileImage" content="http://www.lindonslog.com/wp-content/uploads/2015/09/cropped-L-270x270.png" />

<style id="custom-css-css">.input_prompt{color:#06c}.output_prompt{color:#c00}.prompt{font-family:monospace;font-size:14px}.c,c1{color:#408080;font-style:italic}.k{color:#382;font-weight:700}.kn{color:#382;font-weight:700}.mi{color:#080}.mf{color:#080}.o{color:#96f}.ow{color:#BA22FF;font-weight:700}.nb{color:#382}.n{color:#000}.s,.s1{color:#c22}.se{color:#c22;font-weight:700}.si{color:#C06688;font-weight:700}.nn{color:#4D00FF;font-weight:700}.output_area pre{background-color:#FFF;padding-left:5%}.code_cell{padding-left:1%}.cell{margin-top:10px;margin-bottom:10px}br{line-height:2}.cell h1,h2,h3,h4{margin-top:30px;margin-bottom:10px}</style>
</head>

<body class="single single-post postid-663 single-format-standard">
<div id="page" class="hfeed site">

	<header id="masthead" class="site-header" role="banner">
		<div id="botmenu">
			<div class="container_6">
			<div id="submenu" class="menu-top-container"><ul id="web2feel" class="sfmenu"><li id="menu-item-434" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-434"><a href="../../index.html">About</a></li>
<li id="menu-item-405" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-has-children menu-item-405"><a href="../../category/mathematics/index.html">Mathematics</a>
<ul class="sub-menu">
	<li id="menu-item-814" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-814"><a href="../../category/mathematics/linear-algebra/index.html">Linear Algebra</a></li>
	<li id="menu-item-406" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-406"><a href="../../category/mathematics/statistics/index.html">Statistics</a></li>
</ul>
</li>
<li id="menu-item-404" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-404"><a href="../../category/linux-unix/index.html">Linux/Unix</a></li>
<li id="menu-item-407" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-407"><a href="../../category/programming/index.html">Programming</a>
<ul class="sub-menu">
	<li id="menu-item-408" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-408"><a href="../../category/programming/openmp/index.html">OpenMP</a></li>
	<li id="menu-item-487" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-487"><a href="../../category/programming/r/index.html">R</a></li>
</ul>
</li>
<li id="menu-item-842" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-842"><a href="../../links/index.html">Links</a></li>
</ul></div>			</div>
		</div>
		
		<div class="top cf ">
			<div class="head container_6 cf">
				<div class="logo grid_3">
					
					<h1 class="site-title logo"><a id="blogname" rel="home" href="https://michaellindon.github.io/" title="Ive Moved">Ive Moved</a></h1>
	
					<h2 class="site-description"></h2>
				</div>
				<div class="topbar grid_3">
						<form method="get" id="searchform" action="../../index.html" role="search">
		<label for="s" class="assistive-text">Search</label>
		<input type="text" class="field" name="s" value="" id="s" placeholder="Search &hellip;" />
		<input type="submit" class="submit" name="submit" id="searchsubmit" value="Search" />
	</form>
				</div>
			</div>	
		</div>
	</header><!-- #masthead .site-header -->

	<div id="main" class="site-main container_6">
		<div id="primary" class="content-area">
			<div id="content" class="site-content cf" role="main">

			
				
<article id="post-663" class="grid_6 post-663 post type-post status-publish format-standard hentry category-linear-algebra category-mathematics category-statistics">

<div class="format-box">
<i class="icon-file"></i>
</div>

<div class="post-cover">

	<div class="entry-meta">
		<span class="clock"> <i class="icon-time"></i> 1248 days ago</span> 
		<span class="comments-link"> <i class="icon-comment"></i>  <a href="index.html#comments"><span class="dsq-postid" data-dsqidentifier="663 http://www.lindonslog.com/?p=663">3 Comments</span></a></span>
		<span class="perml"> <i class="icon-bolt"></i> <a href="index.html" rel="bookmark">Permalink</a></span>
	</div><!-- #entry-meta -->
	
	<header class="entry-header">
		<h2 class="entry-title">Woodbury Matrix Inverse Identity</h2>
	</header><!-- .entry-header -->

	<div class="entry-content">
								
								
				<h1>Application in Conditional Distribution of Multivariate Normal</h1>
<p>The Sherman-Woodbury-Morrison matrix inverse identity can be regarded as a transform between Schur complements. That is, given <img src="http://s0.wp.com/latex.php?latex=V_%7B22.1%7D%5E%7B-1%7D&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="V_{22.1}^{-1}" title="V_{22.1}^{-1}" class="latex" /> one can obtain <img src="http://s0.wp.com/latex.php?latex=V_%7B11.2%7D%5E%7B-1%7D&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="V_{11.2}^{-1}" title="V_{11.2}^{-1}" class="latex" /> by using the Woodbury matrix identity and vice versa. Recall the <a title="Invert Matrix Woodbury Matrix Inverse Formula Identity" href="../invert-a-matrix-using-the-woodbury-matrix-inverse-formula-identity/index.html" target="_blank">Woodbury Identity</a>:</p>
<p align="center"><img src="http://s0.wp.com/latex.php?latex=V_%7B11.2%7D%5E%7B-1%7D%3DV_%7B11%7D%5E%7B-1%7D%2BV_%7B11%7D%5E%7B-1%7DV_%7B12%7DV_%7B22.1%7D%5E%7B-1%7DV_%7B21%7DV_%7B11%7D%5E%7B-1%7D+&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="V_{11.2}^{-1}=V_{11}^{-1}+V_{11}^{-1}V_{12}V_{22.1}^{-1}V_{21}V_{11}^{-1} " title="V_{11.2}^{-1}=V_{11}^{-1}+V_{11}^{-1}V_{12}V_{22.1}^{-1}V_{21}V_{11}^{-1} " class="latex" /></p>
<p>and</p>
<p align="center"><img src="http://s0.wp.com/latex.php?latex=V_%7B22.1%7D%5E%7B-1%7D%3DV_%7B22%7D%5E%7B-1%7D%2BV_%7B22%7D%5E%7B-1%7DV_%7B21%7DV_%7B11.2%7D%5E%7B-1%7DV_%7B12%7DV_%7B22%7D%5E%7B-1%7D+&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="V_{22.1}^{-1}=V_{22}^{-1}+V_{22}^{-1}V_{21}V_{11.2}^{-1}V_{12}V_{22}^{-1} " title="V_{22.1}^{-1}=V_{22}^{-1}+V_{22}^{-1}V_{21}V_{11.2}^{-1}V_{12}V_{22}^{-1} " class="latex" /></p>
<p>I recently stumbled across a neat application of this whilst deriving full conditionals for a multivariate normal. Recall that if the data are partitioned into two blocks, <img src="http://s0.wp.com/latex.php?latex=Y_%7B1%7D%2CY_%7B2%7D&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="Y_{1},Y_{2}" title="Y_{1},Y_{2}" class="latex" />, then the variance of the conditional distribution <img src="http://s0.wp.com/latex.php?latex=Y_%7B1%7D%7CY_%7B2%7D%2C-&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="Y_{1}|Y_{2},-" title="Y_{1}|Y_{2},-" class="latex" /> is the Schur complement of the block <img src="http://s0.wp.com/latex.php?latex=V_%7B22%7D&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="V_{22}" title="V_{22}" class="latex" /> of total variance matrix <img src="http://s0.wp.com/latex.php?latex=V&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="V" title="V" class="latex" />, that is, the variance of the conditional distribution is <img src="http://s0.wp.com/latex.php?latex=V_%7B11.2%7D%3DV_%7B11%7D-V_%7B12%7DV_%7B22%7D%5E%7B-1%7DV_%7B21%7D&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="V_{11.2}=V_{11}-V_{12}V_{22}^{-1}V_{21}" title="V_{11.2}=V_{11}-V_{12}V_{22}^{-1}V_{21}" class="latex" /> which is the variance of <img src="http://s0.wp.com/latex.php?latex=Y_%7B1%7D&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="Y_{1}" title="Y_{1}" class="latex" /> subtracted by something corresponding to the reduction in uncertainty about <img src="http://s0.wp.com/latex.php?latex=Y_%7B1%7D&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="Y_{1}" title="Y_{1}" class="latex" /> gained from the knowledge about <img src="http://s0.wp.com/latex.php?latex=Y_%7B2%7D&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="Y_{2}" title="Y_{2}" class="latex" />. If, however, <img src="http://s0.wp.com/latex.php?latex=V_%7B22%7D&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="V_{22}" title="V_{22}" class="latex" /> has the form of a Schur complement itself, then it may be possible to exploit the Woodbury identity above to considerably simplify the variance term. I came across this when I derived two very different-looking expressions for the conditional distribution and found them equivalent by the Woodbury identity. Consider the model</p>
<p align="center"><img src="http://s0.wp.com/latex.php?latex=%5Cbegin%7Bbmatrix%7D+++Y_%7B1%7D%5C%5C+++Y_%7B2%7D++%5Cend%7Bbmatrix%7D++%3D++%5Cbegin%7Bbmatrix%7D+++X_%7B1%7D%5C%5C+++X_%7B2%7D++%5Cend%7Bbmatrix%7D%5Cbeta_%7B+%7D+%2B+%5Cvarepsilon++&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="&#92;begin{bmatrix}   Y_{1}&#92;&#92;   Y_{2}  &#92;end{bmatrix}  =  &#92;begin{bmatrix}   X_{1}&#92;&#92;   X_{2}  &#92;end{bmatrix}&#92;beta_{ } + &#92;varepsilon  " title="&#92;begin{bmatrix}   Y_{1}&#92;&#92;   Y_{2}  &#92;end{bmatrix}  =  &#92;begin{bmatrix}   X_{1}&#92;&#92;   X_{2}  &#92;end{bmatrix}&#92;beta_{ } + &#92;varepsilon  " class="latex" /></p>
<p>where</p>
<p align="center"><img src="http://s0.wp.com/latex.php?latex=%5Cvarepsilon+%5Csim+N%5Cleft%28+%5Cbegin%7Bbmatrix%7D0%5C%5C+0%5Cend%7Bbmatrix%7D%2C+%5Csigma%5E%7B2%7D+%5Cbegin%7Bbmatrix%7DI_%7B1%7D+%26+0+%5C%5C+0+%26+I_%7B2%7D%5Cend%7Bbmatrix%7D+%5Cright%29+&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="&#92;varepsilon &#92;sim N&#92;left( &#92;begin{bmatrix}0&#92;&#92; 0&#92;end{bmatrix}, &#92;sigma^{2} &#92;begin{bmatrix}I_{1} &amp; 0 &#92;&#92; 0 &amp; I_{2}&#92;end{bmatrix} &#92;right) " title="&#92;varepsilon &#92;sim N&#92;left( &#92;begin{bmatrix}0&#92;&#92; 0&#92;end{bmatrix}, &#92;sigma^{2} &#92;begin{bmatrix}I_{1} &amp; 0 &#92;&#92; 0 &amp; I_{2}&#92;end{bmatrix} &#92;right) " class="latex" /></p>
<p align="center"><img src="http://s0.wp.com/latex.php?latex=%5Cbeta_%7B+%7D%7C+%2C%5Csigma%5E%7B2%7D+%5Csim+N%280%2C+%5Csigma%5E%7B2%7D%5CLambda%5E%7B-1%7D%29&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="&#92;beta_{ }| ,&#92;sigma^{2} &#92;sim N(0, &#92;sigma^{2}&#92;Lambda^{-1})" title="&#92;beta_{ }| ,&#92;sigma^{2} &#92;sim N(0, &#92;sigma^{2}&#92;Lambda^{-1})" class="latex" /></p>
<p>.<br />
I was seeking the distribution <img src="http://s0.wp.com/latex.php?latex=Y_%7B1%7D%7C+Y_%7B2%7D%2C%5Csigma%5E%7B2%7D+&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="Y_{1}| Y_{2},&#92;sigma^{2} " title="Y_{1}| Y_{2},&#92;sigma^{2} " class="latex" /> and arrived there through two different paths. The distributions derived looked very different, but they turned out to be equivalent upon considering the Woodbury identity.</p>
<h2>Method 1</h2>
<p>This simply manipulates properties of the multivariate normal. Marginalizing over <img src="http://s0.wp.com/latex.php?latex=%5Cbeta&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="&#92;beta" title="&#92;beta" class="latex" /> one gets</p>
<p align="center"><img src="http://s0.wp.com/latex.php?latex=Cov+%5Cbegin%7Bbmatrix%7D+++Y_%7B1%7D+%5C%5C++Y_%7B2%7D++%5Cend%7Bbmatrix%7D+%3D+%5Cbegin%7Bbmatrix%7D+++X_%7B1%7D+%5C%5C++X_%7B2%7D++%5Cend%7Bbmatrix%7D+Cov+%28%5Cbeta_%7B+%7D%29++%5Cbegin%7Bbmatrix%7D+++X_%7B1%7D%5E%7BT%7D+%26++X_%7B2%7D%5E%7BT%7D++%5Cend%7Bbmatrix%7D+%2B+Cov%28%5Cvarepsilon%29++&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="Cov &#92;begin{bmatrix}   Y_{1} &#92;&#92;  Y_{2}  &#92;end{bmatrix} = &#92;begin{bmatrix}   X_{1} &#92;&#92;  X_{2}  &#92;end{bmatrix} Cov (&#92;beta_{ })  &#92;begin{bmatrix}   X_{1}^{T} &amp;  X_{2}^{T}  &#92;end{bmatrix} + Cov(&#92;varepsilon)  " title="Cov &#92;begin{bmatrix}   Y_{1} &#92;&#92;  Y_{2}  &#92;end{bmatrix} = &#92;begin{bmatrix}   X_{1} &#92;&#92;  X_{2}  &#92;end{bmatrix} Cov (&#92;beta_{ })  &#92;begin{bmatrix}   X_{1}^{T} &amp;  X_{2}^{T}  &#92;end{bmatrix} + Cov(&#92;varepsilon)  " class="latex" /></p>
<p align="center"><img src="http://s0.wp.com/latex.php?latex=Cov+%5Cbegin%7Bbmatrix%7D+++Y_%7B1%7D+%5C%5C++Y_%7B2%7D++%5Cend%7Bbmatrix%7D+%3D+%5Csigma%5E%7B2%7D%5Cbegin%7Bbmatrix%7D+++X_%7B1%7D%5CLambda%5E%7B-1%7D+X_%7B1%7D%5E%7BT%7D+%26++X_%7B1%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5E%7BT%7D+%5C%5C++X_%7B2%7D%5CLambda%5E%7B-1%7D+X_%7B1%7D%5E%7BT%7D+%26++X_%7B2%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5E%7BT%7D++%5Cend%7Bbmatrix%7D++%2B+%5Csigma%5E%7B2%7D++%5Cbegin%7Bbmatrix%7D++I_%7B1%7D+%26+0+%5C%5C+0+%26+I_%7B2%7D++%5Cend%7Bbmatrix%7D++&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="Cov &#92;begin{bmatrix}   Y_{1} &#92;&#92;  Y_{2}  &#92;end{bmatrix} = &#92;sigma^{2}&#92;begin{bmatrix}   X_{1}&#92;Lambda^{-1} X_{1}^{T} &amp;  X_{1}&#92;Lambda^{-1} X_{2}^{T} &#92;&#92;  X_{2}&#92;Lambda^{-1} X_{1}^{T} &amp;  X_{2}&#92;Lambda^{-1} X_{2}^{T}  &#92;end{bmatrix}  + &#92;sigma^{2}  &#92;begin{bmatrix}  I_{1} &amp; 0 &#92;&#92; 0 &amp; I_{2}  &#92;end{bmatrix}  " title="Cov &#92;begin{bmatrix}   Y_{1} &#92;&#92;  Y_{2}  &#92;end{bmatrix} = &#92;sigma^{2}&#92;begin{bmatrix}   X_{1}&#92;Lambda^{-1} X_{1}^{T} &amp;  X_{1}&#92;Lambda^{-1} X_{2}^{T} &#92;&#92;  X_{2}&#92;Lambda^{-1} X_{1}^{T} &amp;  X_{2}&#92;Lambda^{-1} X_{2}^{T}  &#92;end{bmatrix}  + &#92;sigma^{2}  &#92;begin{bmatrix}  I_{1} &amp; 0 &#92;&#92; 0 &amp; I_{2}  &#92;end{bmatrix}  " class="latex" /></p>
<p>.<br />
Such that the distribution</p>
<p align="center"><img src="http://s0.wp.com/latex.php?latex=%5Cbegin%7Bbmatrix%7D+++Y_%7B1%7D%5C%5C+++Y_%7B2%7D++%5Cend%7Bbmatrix%7D%7C+%2C%5Csigma%5E%7B2%7D+%5Csim+N+%5Cleft%28++%5Cbegin%7Bbmatrix%7D++0%5C%5C++0++%5Cend%7Bbmatrix%7D%2C++%5Csigma%5E%7B2%7D+%5Cleft%28+%5Cbegin%7Bbmatrix%7D++I_%7B1%7D%2B++X_%7B1%7D%5CLambda%5E%7B-1%7D+X_%7B1%7D%5E%7BT%7D+%26++X_%7B1%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5E%7BT%7D+%5C%5C++X_%7B2%7D%5CLambda%5E%7B-1%7D+X_%7B1%7D%5E%7BT%7D+%26+I_%7B2%7D%2B+X_%7B2%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5E%7BT%7D++%5Cend%7Bbmatrix%7D++%5Cright%29+%5Cright%29++&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="&#92;begin{bmatrix}   Y_{1}&#92;&#92;   Y_{2}  &#92;end{bmatrix}| ,&#92;sigma^{2} &#92;sim N &#92;left(  &#92;begin{bmatrix}  0&#92;&#92;  0  &#92;end{bmatrix},  &#92;sigma^{2} &#92;left( &#92;begin{bmatrix}  I_{1}+  X_{1}&#92;Lambda^{-1} X_{1}^{T} &amp;  X_{1}&#92;Lambda^{-1} X_{2}^{T} &#92;&#92;  X_{2}&#92;Lambda^{-1} X_{1}^{T} &amp; I_{2}+ X_{2}&#92;Lambda^{-1} X_{2}^{T}  &#92;end{bmatrix}  &#92;right) &#92;right)  " title="&#92;begin{bmatrix}   Y_{1}&#92;&#92;   Y_{2}  &#92;end{bmatrix}| ,&#92;sigma^{2} &#92;sim N &#92;left(  &#92;begin{bmatrix}  0&#92;&#92;  0  &#92;end{bmatrix},  &#92;sigma^{2} &#92;left( &#92;begin{bmatrix}  I_{1}+  X_{1}&#92;Lambda^{-1} X_{1}^{T} &amp;  X_{1}&#92;Lambda^{-1} X_{2}^{T} &#92;&#92;  X_{2}&#92;Lambda^{-1} X_{1}^{T} &amp; I_{2}+ X_{2}&#92;Lambda^{-1} X_{2}^{T}  &#92;end{bmatrix}  &#92;right) &#92;right)  " class="latex" /></p>
<p>It follows that the conditional distribution is<br />
<img src="http://s0.wp.com/latex.php?latex=Y_%7B1%7D%7C+Y_%7B2%7D+%2C%5Csigma%5E%7B2%7D+%5Csim+N+%5Cleft%28++X_%7B1%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5E%7BT%7D+%5Cleft%5B++X_%7B2%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5E%7BT%7D+%2B+I_%7B2%7D%5Cright%5D%5E%7B-1%7D+Y_%7B2%7D%2C+I_%7B1%7D+%2B++X_%7B1%7D%5CLambda%5E%7B-1%7D+X_%7B1%7D%5E%7BT%7D+-++X_%7B1%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5E%7BT%7D+%5Cleft%5B+I_%7B2%7D+%2B++X_%7B2%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5E%7BT%7D+%5Cright%5D%5E%7B-1%7D++X_%7B2%7D%5CLambda%5E%7B-1%7D+X_%7B1%7D%5E%7BT%7D%5Cright%29.++&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="Y_{1}| Y_{2} ,&#92;sigma^{2} &#92;sim N &#92;left(  X_{1}&#92;Lambda^{-1} X_{2}^{T} &#92;left[  X_{2}&#92;Lambda^{-1} X_{2}^{T} + I_{2}&#92;right]^{-1} Y_{2}, I_{1} +  X_{1}&#92;Lambda^{-1} X_{1}^{T} -  X_{1}&#92;Lambda^{-1} X_{2}^{T} &#92;left[ I_{2} +  X_{2}&#92;Lambda^{-1} X_{2}^{T} &#92;right]^{-1}  X_{2}&#92;Lambda^{-1} X_{1}^{T}&#92;right).  " title="Y_{1}| Y_{2} ,&#92;sigma^{2} &#92;sim N &#92;left(  X_{1}&#92;Lambda^{-1} X_{2}^{T} &#92;left[  X_{2}&#92;Lambda^{-1} X_{2}^{T} + I_{2}&#92;right]^{-1} Y_{2}, I_{1} +  X_{1}&#92;Lambda^{-1} X_{1}^{T} -  X_{1}&#92;Lambda^{-1} X_{2}^{T} &#92;left[ I_{2} +  X_{2}&#92;Lambda^{-1} X_{2}^{T} &#92;right]^{-1}  X_{2}&#92;Lambda^{-1} X_{1}^{T}&#92;right).  " class="latex" /><br />
This looks a bit nasty, but notice that <img src="http://s0.wp.com/latex.php?latex=V_%7B22%7D%5E%7B-1%7D&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="V_{22}^{-1}" title="V_{22}^{-1}" class="latex" /> looks like it too could be a Schur complement of some matrix.</p>
<h2>Method 2</h2>
<p>An alternative route to this distribution is</p>
<p align="center"><img src="http://s0.wp.com/latex.php?latex=f%28+Y_%7B1%7D%7C+Y_%7B2%7D%2C%5Csigma%5E%7B2%7D+%29%3D%5Cint+f%28+Y_%7B1%7D%7C%5Csigma%5E%7B2%7D+%2C%5Cbeta_%7B+%7D%29%5Cpi%28%5Cbeta_%7B+%7D%7C+Y_%7B2%7D%2C%5Csigma%5E%7B2%7D+%29d%5Cbeta_%7B+%7D++&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="f( Y_{1}| Y_{2},&#92;sigma^{2} )=&#92;int f( Y_{1}|&#92;sigma^{2} ,&#92;beta_{ })&#92;pi(&#92;beta_{ }| Y_{2},&#92;sigma^{2} )d&#92;beta_{ }  " title="f( Y_{1}| Y_{2},&#92;sigma^{2} )=&#92;int f( Y_{1}|&#92;sigma^{2} ,&#92;beta_{ })&#92;pi(&#92;beta_{ }| Y_{2},&#92;sigma^{2} )d&#92;beta_{ }  " class="latex" /></p>
<p>where</p>
<p align="center"><img src="http://s0.wp.com/latex.php?latex=%5Cbeta_%7B+%7D%7C+Y_%7B2%7D+%2C%5Csigma%5E%7B2%7D%5Csim+N+%5Cleft%28+%28+X_%7B2%7D%5E%7BT%7D+X_%7B2%7D%2B%5CLambda%29%5E%7B-1%7D+X_%7B2%7D%5E%7BT%7D+Y_%7B2%7D%2C+%5Csigma%5E%7B2%7D%28+X_%7B2%7D%5E%7BT%7D+X_%7B2%7D%2B%5CLambda%29%5E%7B-1%7D+%5Cright%29.++&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="&#92;beta_{ }| Y_{2} ,&#92;sigma^{2}&#92;sim N &#92;left( ( X_{2}^{T} X_{2}+&#92;Lambda)^{-1} X_{2}^{T} Y_{2}, &#92;sigma^{2}( X_{2}^{T} X_{2}+&#92;Lambda)^{-1} &#92;right).  " title="&#92;beta_{ }| Y_{2} ,&#92;sigma^{2}&#92;sim N &#92;left( ( X_{2}^{T} X_{2}+&#92;Lambda)^{-1} X_{2}^{T} Y_{2}, &#92;sigma^{2}( X_{2}^{T} X_{2}+&#92;Lambda)^{-1} &#92;right).  " class="latex" /></p>
<p>It follows that</p>
<p align="center"><img src="http://s0.wp.com/latex.php?latex=Y_%7B1%7D%7C+Y_%7B2%7D+%2C%5Csigma%5E%7B2%7D+%5Csim+N%5Cleft%28++X_%7B1%7D%28+X_%7B2%7D%5E%7BT%7D+X_%7B2%7D%2B%5CLambda%29%5E%7B-1%7D+X_%7B2%7D%5E%7BT%7D+Y_%7B2%7D%2C+%5Csigma%5E%7B2%7D+%28I_%7B1%7D+%2B++X_%7B1%7D+%28+X_%7B2%7D%5E%7BT%7D+X_%7B2%7D%2B%5CLambda%29%5E%7B-1%7D+X_%7B1%7D%5E%7BT%7D%29+%5Cright%29++&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="Y_{1}| Y_{2} ,&#92;sigma^{2} &#92;sim N&#92;left(  X_{1}( X_{2}^{T} X_{2}+&#92;Lambda)^{-1} X_{2}^{T} Y_{2}, &#92;sigma^{2} (I_{1} +  X_{1} ( X_{2}^{T} X_{2}+&#92;Lambda)^{-1} X_{1}^{T}) &#92;right)  " title="Y_{1}| Y_{2} ,&#92;sigma^{2} &#92;sim N&#92;left(  X_{1}( X_{2}^{T} X_{2}+&#92;Lambda)^{-1} X_{2}^{T} Y_{2}, &#92;sigma^{2} (I_{1} +  X_{1} ( X_{2}^{T} X_{2}+&#92;Lambda)^{-1} X_{1}^{T}) &#92;right)  " class="latex" /></p>
<p>which looks different from the distribution obtained through method 1. The expression for the variance is a lot neater. They are in fact identical by the Woodbury identity.</p>
<h2>Comparison</h2>
<h3>Mean (Submitted by Michelle Leigh)</h3>
<p align="center"><img src="http://s0.wp.com/latex.php?latex=%5Cleft%5B%5CLambda%2B++X_%7B2%7D%5ETI_%7B2%7D+X_%7B2%7D%5Cright%5D%5E%7B-1%7D+X_%7B2%7D%5ET%5C%5C++%3D%5C%7B%5CLambda%5E%7B-1%7D-%5CLambda%5E%7B-1%7D+X_%7B2%7D%5ET%5Cleft%5BI_%7B2%7D%2B++X_%7B2%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5ET%5Cright%5D%5E%7B-1%7D+X_%7B2%7D%5CLambda%5E%7B-1%7D%5C%7D+X_%7B2%7D%5ET%5C%5C++%3D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5ET%5Cleft%5BI_%7B2%7D%2B++X_%7B2%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5ET%5Cright%5D%5E%7B-1%7D%5Cleft%5BI_%7B2%7D%2B++X_%7B2%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5ET%5Cright%5D-%5CLambda%5E%7B-1%7D+X_%7B2%7D%5ET%5Cleft%5BI_%7B2%7D%2B++X_%7B2%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5ET%5Cright%5D%5E%7B-1%7D+X_%7B2%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5ET%5C%5C++%3D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5ET%5Cleft%5BI_%7B2%7D%2B++X_%7B2%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5ET%5Cright%5D%5E%7B-1%7DI_%7B2%7D&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="&#92;left[&#92;Lambda+  X_{2}^TI_{2} X_{2}&#92;right]^{-1} X_{2}^T&#92;&#92;  =&#92;{&#92;Lambda^{-1}-&#92;Lambda^{-1} X_{2}^T&#92;left[I_{2}+  X_{2}&#92;Lambda^{-1} X_{2}^T&#92;right]^{-1} X_{2}&#92;Lambda^{-1}&#92;} X_{2}^T&#92;&#92;  =&#92;Lambda^{-1} X_{2}^T&#92;left[I_{2}+  X_{2}&#92;Lambda^{-1} X_{2}^T&#92;right]^{-1}&#92;left[I_{2}+  X_{2}&#92;Lambda^{-1} X_{2}^T&#92;right]-&#92;Lambda^{-1} X_{2}^T&#92;left[I_{2}+  X_{2}&#92;Lambda^{-1} X_{2}^T&#92;right]^{-1} X_{2}&#92;Lambda^{-1} X_{2}^T&#92;&#92;  =&#92;Lambda^{-1} X_{2}^T&#92;left[I_{2}+  X_{2}&#92;Lambda^{-1} X_{2}^T&#92;right]^{-1}I_{2}" title="&#92;left[&#92;Lambda+  X_{2}^TI_{2} X_{2}&#92;right]^{-1} X_{2}^T&#92;&#92;  =&#92;{&#92;Lambda^{-1}-&#92;Lambda^{-1} X_{2}^T&#92;left[I_{2}+  X_{2}&#92;Lambda^{-1} X_{2}^T&#92;right]^{-1} X_{2}&#92;Lambda^{-1}&#92;} X_{2}^T&#92;&#92;  =&#92;Lambda^{-1} X_{2}^T&#92;left[I_{2}+  X_{2}&#92;Lambda^{-1} X_{2}^T&#92;right]^{-1}&#92;left[I_{2}+  X_{2}&#92;Lambda^{-1} X_{2}^T&#92;right]-&#92;Lambda^{-1} X_{2}^T&#92;left[I_{2}+  X_{2}&#92;Lambda^{-1} X_{2}^T&#92;right]^{-1} X_{2}&#92;Lambda^{-1} X_{2}^T&#92;&#92;  =&#92;Lambda^{-1} X_{2}^T&#92;left[I_{2}+  X_{2}&#92;Lambda^{-1} X_{2}^T&#92;right]^{-1}I_{2}" class="latex" /></p>
<p>So mean1=mean2.</p>
<h3>Variance</h3>
<p>By the Woodbury Identity it follows that</p>
<p align="center"><img src="http://s0.wp.com/latex.php?latex=%5CLambda%5E%7B-1%7D+-+%5CLambda%5E%7B-1%7D+X_%7B2%7D%5E%7BT%7D+%5Cleft%5B+I_%7B2%7D+%2B++X_%7B2%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5E%7BT%7D+%5Cright%5D%5E%7B-1%7D++X_%7B2%7D%5CLambda%5E%7B-1%7D+%3D+%28+X_%7B2%7D%5E%7BT%7DI_%7B2%7D+X_%7B2%7D%2B%5CLambda%29%5E%7B-1%7D.++&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="&#92;Lambda^{-1} - &#92;Lambda^{-1} X_{2}^{T} &#92;left[ I_{2} +  X_{2}&#92;Lambda^{-1} X_{2}^{T} &#92;right]^{-1}  X_{2}&#92;Lambda^{-1} = ( X_{2}^{T}I_{2} X_{2}+&#92;Lambda)^{-1}.  " title="&#92;Lambda^{-1} - &#92;Lambda^{-1} X_{2}^{T} &#92;left[ I_{2} +  X_{2}&#92;Lambda^{-1} X_{2}^{T} &#92;right]^{-1}  X_{2}&#92;Lambda^{-1} = ( X_{2}^{T}I_{2} X_{2}+&#92;Lambda)^{-1}.  " class="latex" /></p>
<p>Therefore</p>
<p align="center"><img src="http://s0.wp.com/latex.php?latex=X_%7B1%7D%5CLambda%5E%7B-1%7D+X_%7B1%7D%5E%7BT%7D-+X_%7B1%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5E%7BT%7D+%5Cleft%5B+I_%7B2%7D%2B+X_%7B2%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5E%7BT%7D+%5Cright%5D%5E%7B-1%7D++X_%7B2%7D%5CLambda%5E%7B-1%7D+X_%7B1%7D%5E%7BT%7D%3D%7B+X_%7B1%7D+%28+X_%7B2%7D%5E%7BT%7D+X_%7B2%7D%2B%5CLambda%29%5E%7B-1%7D+X_%7B1%7D%5E%7BT%7D%7D%5C%5C++&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="X_{1}&#92;Lambda^{-1} X_{1}^{T}- X_{1}&#92;Lambda^{-1} X_{2}^{T} &#92;left[ I_{2}+ X_{2}&#92;Lambda^{-1} X_{2}^{T} &#92;right]^{-1}  X_{2}&#92;Lambda^{-1} X_{1}^{T}={ X_{1} ( X_{2}^{T} X_{2}+&#92;Lambda)^{-1} X_{1}^{T}}&#92;&#92;  " title="X_{1}&#92;Lambda^{-1} X_{1}^{T}- X_{1}&#92;Lambda^{-1} X_{2}^{T} &#92;left[ I_{2}+ X_{2}&#92;Lambda^{-1} X_{2}^{T} &#92;right]^{-1}  X_{2}&#92;Lambda^{-1} X_{1}^{T}={ X_{1} ( X_{2}^{T} X_{2}+&#92;Lambda)^{-1} X_{1}^{T}}&#92;&#92;  " class="latex" /></p>
<p>and so variance1=variance2. The trick is recognizing the form of the formulas at the top of the page, then one can write the variance as a much neater expression.</p>
<div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-facebook"><a rel="nofollow" data-shared="sharing-facebook-663" class="share-facebook sd-button share-icon" href="index.html%3Fshare=facebook.html" target="_blank" title="Click to share on Facebook"><span>Facebook</span></a></li><li class="share-twitter"><a rel="nofollow" data-shared="sharing-twitter-663" class="share-twitter sd-button share-icon" href="index.html%3Fshare=twitter.html" target="_blank" title="Click to share on Twitter"><span>Twitter</span></a></li><li class="share-google-plus-1"><a rel="nofollow" data-shared="sharing-google-663" class="share-google-plus-1 sd-button share-icon" href="index.html%3Fshare=google-plus-1.html" target="_blank" title="Click to share on Google+"><span>Google</span></a></li><li class="share-end"></li></ul></div></div></div><div class='sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-unloaded' id='like-post-wrapper-27325203-663-5866bc3d5ad8e' data-src='//widgets.wp.com/likes/#blog_id=27325203&amp;post_id=663&amp;origin=www.lindonslog.com&amp;obj_id=27325203-663-5866bc3d5ad8e' data-name='like-post-frame-27325203-663-5866bc3d5ad8e'><h3 class='sd-title'>Like this:</h3><div class='likes-widget-placeholder post-likes-widget-placeholder' style='height:55px'><span class='button'><span>Like</span></span> <span class="loading">Loading...</span></div><span class='sd-text-color'></span><a class='sd-link-color'></a></div>					</div><!-- .entry-content -->

</div>	

</article><!-- #post-663 -->
				<div class="clear"></div>
				

				
<div id="disqus_thread">
            <div id="dsq-content">


            <ul id="dsq-comments">
                    <li class="comment even thread-even depth-1" id="dsq-comment-306">
        <div id="dsq-comment-header-306" class="dsq-comment-header">
            <cite id="dsq-cite-306">
                <a id="dsq-author-user-306" href="http://michelleleighh.wordpress.com" target="_blank" rel="nofollow">michelleleighh</a>
            </cite>
        </div>
        <div id="dsq-comment-body-306" class="dsq-comment-body">
            <div id="dsq-comment-message-306" class="dsq-comment-message"><p>Very nice series of articles about schur compliment and etc. Appreciate them very much.</p>
<p>Anyways here is my proof of mean1=mean2<br />
<img src="http://s0.wp.com/latex.php?latex=%5Cleft%5B%5CLambda%2B++X_%7B2%7D%5ETI_%7B2%7D+X_%7B2%7D%5Cright%5D%5E%7B-1%7D+X_%7B2%7D%5ET%5C%5C++%3D%5C%7B%5CLambda%5E%7B-1%7D-%5CLambda%5E%7B-1%7D+X_%7B2%7D%5ET%5Cleft%5BI_%7B2%7D%2B++X_%7B2%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5ET%5Cright%5D%5E%7B-1%7D+X_%7B2%7D%5CLambda%5E%7B-1%7D%5C%7D+X_%7B2%7D%5ET%5C%5C++%3D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5ET%5Cleft%5BI_%7B2%7D%2B++X_%7B2%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5ET%5Cright%5D%5E%7B-1%7D%5Cleft%5BI_%7B2%7D%2B++X_%7B2%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5ET%5Cright%5D-%5CLambda%5E%7B-1%7D+X_%7B2%7D%5ET%5Cleft%5BI_%7B2%7D%2B++X_%7B2%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5ET%5Cright%5D%5E%7B-1%7D+X_%7B2%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5ET%5C%5C++%3D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5ET%5Cleft%5BI_%7B2%7D%2B++X_%7B2%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5ET%5Cright%5D%5E%7B-1%7DI_%7B2%7D&amp;bg=ffffff&amp;fg=000&amp;s=0" alt="&#92;left[&#92;Lambda+  X_{2}^TI_{2} X_{2}&#92;right]^{-1} X_{2}^T&#92;&#92;  =&#92;{&#92;Lambda^{-1}-&#92;Lambda^{-1} X_{2}^T&#92;left[I_{2}+  X_{2}&#92;Lambda^{-1} X_{2}^T&#92;right]^{-1} X_{2}&#92;Lambda^{-1}&#92;} X_{2}^T&#92;&#92;  =&#92;Lambda^{-1} X_{2}^T&#92;left[I_{2}+  X_{2}&#92;Lambda^{-1} X_{2}^T&#92;right]^{-1}&#92;left[I_{2}+  X_{2}&#92;Lambda^{-1} X_{2}^T&#92;right]-&#92;Lambda^{-1} X_{2}^T&#92;left[I_{2}+  X_{2}&#92;Lambda^{-1} X_{2}^T&#92;right]^{-1} X_{2}&#92;Lambda^{-1} X_{2}^T&#92;&#92;  =&#92;Lambda^{-1} X_{2}^T&#92;left[I_{2}+  X_{2}&#92;Lambda^{-1} X_{2}^T&#92;right]^{-1}I_{2}" title="&#92;left[&#92;Lambda+  X_{2}^TI_{2} X_{2}&#92;right]^{-1} X_{2}^T&#92;&#92;  =&#92;{&#92;Lambda^{-1}-&#92;Lambda^{-1} X_{2}^T&#92;left[I_{2}+  X_{2}&#92;Lambda^{-1} X_{2}^T&#92;right]^{-1} X_{2}&#92;Lambda^{-1}&#92;} X_{2}^T&#92;&#92;  =&#92;Lambda^{-1} X_{2}^T&#92;left[I_{2}+  X_{2}&#92;Lambda^{-1} X_{2}^T&#92;right]^{-1}&#92;left[I_{2}+  X_{2}&#92;Lambda^{-1} X_{2}^T&#92;right]-&#92;Lambda^{-1} X_{2}^T&#92;left[I_{2}+  X_{2}&#92;Lambda^{-1} X_{2}^T&#92;right]^{-1} X_{2}&#92;Lambda^{-1} X_{2}^T&#92;&#92;  =&#92;Lambda^{-1} X_{2}^T&#92;left[I_{2}+  X_{2}&#92;Lambda^{-1} X_{2}^T&#92;right]^{-1}I_{2}" class="latex" /></p>
</div>
        </div>

    <ul class="children">
    <li class="comment byuser comment-author-admin bypostauthor odd alt depth-2" id="dsq-comment-309">
        <div id="dsq-comment-header-309" class="dsq-comment-header">
            <cite id="dsq-cite-309">
                <span id="dsq-author-user-309">admin</span>
            </cite>
        </div>
        <div id="dsq-comment-body-309" class="dsq-comment-body">
            <div id="dsq-comment-message-309" class="dsq-comment-message"><p>I love it, can I add it to the main post?</p>
</div>
        </div>

    <ul class="children">
    <li class="comment even depth-3" id="dsq-comment-310">
        <div id="dsq-comment-header-310" class="dsq-comment-header">
            <cite id="dsq-cite-310">
                <a id="dsq-author-user-310" href="http://michelleleighh.wordpress.com" target="_blank" rel="nofollow">michelleleighh</a>
            </cite>
        </div>
        <div id="dsq-comment-body-310" class="dsq-comment-body">
            <div id="dsq-comment-message-310" class="dsq-comment-message"><p>Sure</p>
</div>
        </div>

    </li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
            </ul>


        </div>

    </div>


			
			</div><!-- #content .site-content -->
		</div><!-- #primary .content-area -->



	</div><!-- #main .site-main -->

<div id="bottom">
<div class="container_6 cf">

<li class="botwid grid_2 widget_categories"><h3 class="bothead">Categories</h3>		<ul>
	<li class="cat-item cat-item-3"><a href="../../category/linux-unix/index.html" >Linux/Unix</a> (16)
</li>
	<li class="cat-item cat-item-5"><a href="../../category/mathematics/index.html" >Mathematics</a> (22)
<ul class='children'>
	<li class="cat-item cat-item-10"><a href="../../category/mathematics/linear-algebra/index.html" >Linear Algebra</a> (5)
</li>
	<li class="cat-item cat-item-7"><a href="../../category/mathematics/statistics/index.html" >Statistics</a> (17)
</li>
</ul>
</li>
	<li class="cat-item cat-item-6"><a href="../../category/programming/index.html" >Programming</a> (24)
<ul class='children'>
	<li class="cat-item cat-item-48"><a href="../../category/programming/clojure/index.html" >clojure</a> (1)
</li>
	<li class="cat-item cat-item-51"><a href="../../category/programming/functional-programming/index.html" >functional programming</a> (1)
</li>
	<li class="cat-item cat-item-50"><a href="../../category/programming/haskell-programming/index.html" >haskell</a> (1)
</li>
	<li class="cat-item cat-item-40"><a href="../../category/programming/julia/index.html" >julia</a> (2)
</li>
	<li class="cat-item cat-item-4"><a href="../../category/programming/openmp/index.html" >OpenMP</a> (6)
</li>
	<li class="cat-item cat-item-11"><a href="../../category/programming/r/index.html" >R</a> (12)
</li>
	<li class="cat-item cat-item-43"><a href="../../category/programming/scala/index.html" >scala</a> (1)
</li>
</ul>
</li>
		</ul>
</li>		<li class="botwid grid_2 widget_recent_entries">		<h3 class="bothead">Recent Posts</h3>		<ul>
					<li>
				<a href="../../programming/partial-application-functions-julia/index.html">Partial Application for Functions in Julia</a>
						</li>
					<li>
				<a href="../../programming/newtons-iteration-scala-clojure-haskell/index.html">Newtons Iteration in Scala, Clojure and Haskell Comparison</a>
						</li>
					<li>
				<a href="../statistics/mala-metropolis-adjusted-langevin-algorithm-julia/index.html">MALA &#8211; Metropolis Adjusted Langevin Algorithm in Julia</a>
						</li>
					<li>
				<a href="../../programming/passing-julia-type-to-c-function-as-struct/index.html">Passing Julia Type to C Function as Struct</a>
						</li>
					<li>
				<a href="../../linux-unix/send-lines-code-vim-r-julia-python-repl-slime/index.html">Send Lines of Code from Vim to R/Julia/Python REPL</a>
						</li>
					<li>
				<a href="../../linux-unix/c-merge-sort-algorithm/index.html">C++ Merge Sort Algorithm</a>
						</li>
					<li>
				<a href="../../programming/generate-random-inverse-gaussian-r/index.html">Generate Random Inverse Gaussian in R</a>
						</li>
					<li>
				<a href="../statistics/generalized-double-pareto-shrinkage-priors-sparse-estimation-regression/index.html">Generalized Double Pareto Priors for Regression</a>
						</li>
					<li>
				<a href="../em-algorithm-bayesian-lasso-r-cpp-code/index.html">EM Algorithm for Bayesian Lasso R Cpp Code</a>
						</li>
				</ul>
		</li>			<div class="squarebanner grid_2 cf">
	<h3 class="bothead"> Sponsors </h3>
<ul><li>
<a rel="nofollow" href="index.html" title=""><img src="index.html" alt="" style="vertical-align:bottom;" /></a>
</li>			

<li>
<a rel="nofollow" href="index.html" title=""><img src="index.html" alt="" style="vertical-align:bottom;" /></a>
</li>

<li>
<a rel="nofollow" href="index.html" title=""><img src="index.html" alt="" style="vertical-align:bottom;" /></a>
</li>

<li>
<a rel="nofollow" href="index.html" title=""><img src="index.html" alt="" style="vertical-align:bottom;" /></a>
</li></ul>
</div></div>
</div>


	<footer id="colophon" class="site-footer" role="contentinfo">
	<div class="container_6">
	<div class="site-info">
			<div class="fcred">
			Copyright &copy; 2016 <a href="https://michaellindon.github.io/" title="Ive Moved">Ive Moved</a> - .<br />
 | <a href="https://michaellindon.github.io/" >Ive Moved</a>
			</div>		
		</div><!-- .site-info -->	
		</footer><!-- #colophon .site-footer -->
	
</div><!-- #page .hfeed .site -->

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-40536457-1', 'lindonslog.com');
  ga('send', 'pageview');

</script><!-- MathJax Latex Plugin installed: Disabled as no shortcodes on this page -->	<div style="display:none">
	</div>
<script type="text/javascript">var elLogo = document.getElementById("ft_logo"); if (elLogo) {elLogo.style.maxHeight = elLogo.getAttribute("relHeight") ? elLogo.getAttribute("relHeight") + "px" : "100px";} if (elLogo) {elLogo.style.maxWidth = elLogo.getAttribute("relWidth") ? elLogo.getAttribute("relWidth") + "px" : "100px";}</script>
	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"http:\/\/www.lindonslog.com\/mathematics\/woodbury-matrix-inverse-multivariate-normal\/":663};
	</script>
		<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-facebook' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
				return false;
			});
		});
		</script>
				<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-twitter' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
				return false;
			});
		});
		</script>
				<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-google-plus-1' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomgoogle-plus-1', 'menubar=1,resizable=1,width=480,height=550' );
				return false;
			});
		});
		</script>
		<script type='text/javascript' src='http://s0.wp.com/wp-content/js/devicepx-jetpack.js?ver=201652'></script>
<script type='text/javascript' src='http://s.gravatar.com/js/gprofiles.js?ver=2016Decaa'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type='text/javascript' src='../../wp-content/plugins/jetpack/modules/wpgroho.js%3Fver=4.6.1'></script>
<script type='text/javascript' src='../../wp-content/themes/Winter/js/superfish.js%3Fver=20120206'></script>
<script type='text/javascript' src='../../wp-includes/js/comment-reply.min.js%3Fver=4.6.1'></script>
<script type='text/javascript' src='../../wp-includes/js/wp-embed.min.js%3Fver=4.6.1'></script>
<script type='text/javascript' src='../../wp-content/plugins/jetpack/_inc/postmessage.js%3Fver=3.9.7'></script>
<script type='text/javascript' src='../../wp-content/plugins/jetpack/_inc/jquery.jetpack-resize.js%3Fver=3.9.7'></script>
<script type='text/javascript' src='../../wp-content/plugins/jetpack/_inc/jquery.inview.js%3Fver=3.9.7'></script>
<script type='text/javascript' src='../../wp-content/plugins/jetpack/modules/likes/queuehandler.js%3Fver=3.9.7'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"platform":"wordpress@4.6.1","language":""},"disqusIdentifier":"663 http:\/\/www.lindonslog.com\/?p=663","disqusShortname":"michaellindon","disqusTitle":"Woodbury Matrix Inverse Identity","disqusUrl":"http:\/\/www.lindonslog.com\/mathematics\/woodbury-matrix-inverse-multivariate-normal\/","options":{"manualSync":false},"postId":"663"};
/* ]]> */
</script>
<script type='text/javascript' src='../../wp-content/plugins/disqus-comment-system/media/js/disqus.js%3Fver=4.6.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"michaellindon"};
/* ]]> */
</script>
<script type='text/javascript' src='../../wp-content/plugins/disqus-comment-system/media/js/count.js%3Fver=4.6.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1"};
/* ]]> */
</script>
<script type='text/javascript' src='../../wp-content/plugins/jetpack/modules/sharedaddy/sharing.js%3Fver=3.9.7'></script>
		<iframe src='http://widgets.wp.com/likes/master.html?ver=20151215#ver=20151215' scrolling='no' id='likes-master' name='likes-master' style='display:none;'></iframe>
		<div id='likes-other-gravatars'><div class="likes-text"><span>%d</span> bloggers like this:</div><ul class="wpl-avatars sd-like-gravatars"></ul></div>
		<script type='text/javascript' src='http://stats.wp.com/e-201652.js' async defer></script>
<script type='text/javascript'>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:3.9.7',blog:'27325203',post:'663',tz:'-4',srv:'www.lindonslog.com'} ]);
	_stq.push([ 'clickTrackerInit', '27325203', '663' ]);
</script>

</body>
</html>
