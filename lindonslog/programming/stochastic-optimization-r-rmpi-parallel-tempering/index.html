<!DOCTYPE html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width" />

<link rel="profile" href="http://gmpg.org/xfn/11" />
<link rel="pingback" href="http://www.lindonslog.com/xmlrpc.php" />
<link href='http://fonts.googleapis.com/css?family=Economica:400,400italic,700,700italic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=PT+Sans:400,700' rel='stylesheet' type='text/css'>
<!--[if lt IE 9]>
<script src="http://www.lindonslog.com/wp-content/themes/Winter/js/html5.js" type="text/javascript"></script>
<![endif]-->


<!-- This site is optimized with the Yoast SEO plugin v3.1.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Stochastic Optimization in R by Parallel Tempering - Lindons Log</title>
<meta name="description" content="A tutorial on using a parallel tempering algorithm for stochastic optimization. Code is written in R and made parallel using Rmpi."/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="index.html" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Stochastic Optimization in R by Parallel Tempering - Lindons Log" />
<meta property="og:description" content="A tutorial on using a parallel tempering algorithm for stochastic optimization. Code is written in R and made parallel using Rmpi." />
<meta property="og:url" content="http://www.lindonslog.com/programming/stochastic-optimization-r-rmpi-parallel-tempering/" />
<meta property="og:site_name" content="Lindons Log" />
<meta property="article:tag" content="optimization" />
<meta property="article:tag" content="parallel" />
<meta property="article:tag" content="stochastic" />
<meta property="article:tag" content="tempering" />
<meta property="article:section" content="Programming" />
<meta property="article:published_time" content="2013-10-12T17:24:04+00:00" />
<meta property="article:modified_time" content="2013-10-13T23:13:45+00:00" />
<meta property="og:updated_time" content="2013-10-13T23:13:45+00:00" />
<meta property="og:image" content="http://www.lindonslog.com/wp-content/uploads/2013/10/exphist-300x300.jpeg" />
<meta property="og:image" content="http://www.lindonslog.com/wp-content/uploads/2013/10/unioptim-300x300.jpeg" />
<meta property="og:image" content="http://www.lindonslog.com/wp-content/uploads/2013/10/optimtest-300x185.jpeg" />
<meta property="og:image" content="http://www.lindonslog.com/wp-content/uploads/2013/10/hardoptim-682x1024.jpeg" />
<meta property="og:image" content="http://www.lindonslog.com/wp-content/uploads/2013/10/wildfunction.jpeg" />
<meta property="og:image" content="http://www.lindonslog.com/wp-content/uploads/2013/10/goodwild-682x1024.jpeg" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="A tutorial on using a parallel tempering algorithm for stochastic optimization. Code is written in R and made parallel using Rmpi." />
<meta name="twitter:title" content="Stochastic Optimization in R by Parallel Tempering - Lindons Log" />
<meta name="twitter:site" content="@lindonslog" />
<meta name="twitter:image" content="http://www.lindonslog.com/wp-content/uploads/2013/10/exphist-300x300.jpeg" />
<meta name="twitter:creator" content="@lindonslog" />
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='http://s0.wp.com/' />
<link rel='dns-prefetch' href='http://s.gravatar.com/' />
<link rel='dns-prefetch' href='http://s.w.org/' />
<link rel="alternate" type="application/rss+xml" title="Lindons Log &raquo; Feed" href="../../feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="Lindons Log &raquo; Comments Feed" href="../../comments/feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="Lindons Log &raquo; Stochastic Optimization in R by Parallel Tempering Comments Feed" href="feed/index.html" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/www.lindonslog.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.1"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='papercite_css-css'  href='../../wp-content/plugins/papercite/papercite.css%3Fver=4.6.1.css' type='text/css' media='all' />
<link rel='stylesheet' id='style-css'  href='../../wp-content/themes/Winter/style.css%3Fver=4.6.1.css' type='text/css' media='all' />
<link rel='stylesheet' id='grid-css'  href='../../wp-content/themes/Winter/css/grid.css%3Fver=4.6.1.css' type='text/css' media='all' />
<link rel='stylesheet' id='wp-style-css'  href='../../wp-content/themes/Winter/css/wp-style.css%3Fver=4.6.1.css' type='text/css' media='all' />
<link rel='stylesheet' id='fontwaesome-css'  href='../../wp-content/themes/Winter/css/font-awesome.css%3Fver=4.6.1.css' type='text/css' media='all' />
<link rel='stylesheet' id='fontwaesome-ie-css'  href='../../wp-content/themes/Winter/css/font-awesome-ie7.css%3Fver=4.6.1.css' type='text/css' media='all' />
<link rel='stylesheet' id='flexslider-css'  href='../../wp-content/themes/Winter/css/flexslider.css%3Fver=4.6.1.css' type='text/css' media='all' />
<link rel='stylesheet' id='fancybox-css'  href='../../wp-content/themes/Winter/css/jquery.fancybox.css%3Fver=4.6.1.css' type='text/css' media='all' />
<link rel='stylesheet' id='genericons-css'  href='../../wp-content/plugins/jetpack/_inc/genericons/genericons/genericons.css%3Fver=3.1.css' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='../../wp-content/plugins/jetpack/css/jetpack.css%3Fver=3.9.7.css' type='text/css' media='all' />
<script type='text/javascript' src='../../wp-includes/js/jquery/jquery.js%3Fver=1.12.4'></script>
<script type='text/javascript' src='../../wp-includes/js/jquery/jquery-migrate.min.js%3Fver=1.4.1'></script>
<script type='text/javascript' src='../../wp-content/plugins/papercite/js/papercite.js%3Fver=4.6.1'></script>
<script type='text/javascript' src='../../wp-content/themes/Winter/js/jquery.flexslider-min.js%3Fver=1'></script>
<script type='text/javascript' src='../../wp-content/themes/Winter/js/jquery.fancybox.pack.js%3Fver=1'></script>
<script type='text/javascript' src='../../wp-content/themes/Winter/js/jwplayer.js%3Fver=1'></script>
<script type='text/javascript' src='../../wp-content/themes/Winter/js/custom.js%3Fver=1'></script>
<link rel='https://api.w.org/' href='../../wp-json/index.html' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../xmlrpc.php%3Frsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 4.6.1" />
<link rel='shortlink' href='http://wp.me/p1QEx5-eG' />
<link rel="alternate" type="application/json+oembed" href="../../wp-json/oembed/1.0/embed%3Furl=http%253A%252F%252Fwww.lindonslog.com%252Fprogramming%252Fstochastic-optimization-r-rmpi-parallel-tempering%252F" />
<link rel="alternate" type="text/xml+oembed" href="../../wp-json/oembed/1.0/embed%3Furl=http%253A%252F%252Fwww.lindonslog.com%252Fprogramming%252Fstochastic-optimization-r-rmpi-parallel-tempering%252F&amp;format=xml" />

<link rel='dns-prefetch' href='http://jetpack.wordpress.com/'>
<link rel='dns-prefetch' href='http://s0.wp.com/'>
<link rel='dns-prefetch' href='http://s1.wp.com/'>
<link rel='dns-prefetch' href='http://s2.wp.com/'>
<link rel='dns-prefetch' href='http://public-api.wordpress.com/'>
<link rel='dns-prefetch' href='http://0.gravatar.com/'>
<link rel='dns-prefetch' href='http://1.gravatar.com/'>
<link rel='dns-prefetch' href='http://2.gravatar.com/'>
<link rel='dns-prefetch' href='http://widgets.wp.com/'>
<style type="text/css" id="syntaxhighlighteranchor"></style>
<link rel="icon" href="../../wp-content/uploads/2015/09/cropped-L-32x32.png" sizes="32x32" />
<link rel="icon" href="../../wp-content/uploads/2015/09/cropped-L-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon-precomposed" href="../../wp-content/uploads/2015/09/cropped-L-180x180.png" />
<meta name="msapplication-TileImage" content="http://www.lindonslog.com/wp-content/uploads/2015/09/cropped-L-270x270.png" />

<style id="custom-css-css">.input_prompt{color:#06c}.output_prompt{color:#c00}.prompt{font-family:monospace;font-size:14px}.c,c1{color:#408080;font-style:italic}.k{color:#382;font-weight:700}.kn{color:#382;font-weight:700}.mi{color:#080}.mf{color:#080}.o{color:#96f}.ow{color:#BA22FF;font-weight:700}.nb{color:#382}.n{color:#000}.s,.s1{color:#c22}.se{color:#c22;font-weight:700}.si{color:#C06688;font-weight:700}.nn{color:#4D00FF;font-weight:700}.output_area pre{background-color:#FFF;padding-left:5%}.code_cell{padding-left:1%}.cell{margin-top:10px;margin-bottom:10px}br{line-height:2}.cell h1,h2,h3,h4{margin-top:30px;margin-bottom:10px}</style>
</head>

<body class="single single-post postid-910 single-format-standard">
<div id="page" class="hfeed site">

	<header id="masthead" class="site-header" role="banner">
		<div id="botmenu">
			<div class="container_6">
			<div id="submenu" class="menu-top-container"><ul id="web2feel" class="sfmenu"><li id="menu-item-434" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-434"><a href="../../index.html">About</a></li>
<li id="menu-item-405" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-has-children menu-item-405"><a href="../../category/mathematics/index.html">Mathematics</a>
<ul class="sub-menu">
	<li id="menu-item-814" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-814"><a href="../../category/mathematics/linear-algebra/index.html">Linear Algebra</a></li>
	<li id="menu-item-406" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-406"><a href="../../category/mathematics/statistics/index.html">Statistics</a></li>
</ul>
</li>
<li id="menu-item-404" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-404"><a href="../../category/linux-unix/index.html">Linux/Unix</a></li>
<li id="menu-item-407" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-has-children menu-item-407"><a href="../../category/programming/index.html">Programming</a>
<ul class="sub-menu">
	<li id="menu-item-408" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-408"><a href="../../category/programming/openmp/index.html">OpenMP</a></li>
	<li id="menu-item-487" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-487"><a href="../../category/programming/r/index.html">R</a></li>
</ul>
</li>
<li id="menu-item-842" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-842"><a href="../../links/index.html">Links</a></li>
</ul></div>			</div>
		</div>
		
		<div class="top cf ">
			<div class="head container_6 cf">
				<div class="logo grid_3">
					
					<h1 class="site-title logo"><a id="blogname" rel="home" href="../../index.html" title="Lindons Log">Lindons Log</a></h1>
	
					<h2 class="site-description"></h2>
				</div>
				<div class="topbar grid_3">
						<form method="get" id="searchform" action="../../index.html" role="search">
		<label for="s" class="assistive-text">Search</label>
		<input type="text" class="field" name="s" value="" id="s" placeholder="Search &hellip;" />
		<input type="submit" class="submit" name="submit" id="searchsubmit" value="Search" />
	</form>
				</div>
			</div>	
		</div>
	</header><!-- #masthead .site-header -->

	<div id="main" class="site-main container_6">
		<div id="primary" class="content-area">
			<div id="content" class="site-content cf" role="main">

			
				
<article id="post-910" class="grid_6 post-910 post type-post status-publish format-standard hentry category-programming category-r category-statistics tag-optimization tag-parallel tag-stochastic tag-tempering">

<div class="format-box">
<i class="icon-file"></i>
</div>

<div class="post-cover">

	<div class="entry-meta">
		<span class="clock"> <i class="icon-time"></i> 1175 days ago</span> 
		<span class="comments-link"> <i class="icon-comment"></i>  <a href="index.html#comments"><span class="dsq-postid" data-dsqidentifier="910 http://www.lindonslog.com/?p=910">7 Comments</span></a></span>
		<span class="perml"> <i class="icon-bolt"></i> <a href="index.html" rel="bookmark">Permalink</a></span>
	</div><!-- #entry-meta -->
	
	<header class="entry-header">
		<h2 class="entry-title">Stochastic Optimization in R by Parallel Tempering</h2>
	</header><!-- .entry-header -->

	<div class="entry-content">
								
								
				<p><br />
I&#8217;ve written a few posts now about using <a href="../openmp/parallel-tempering-algorithm-c/index.html" title="Parallel Tempering Algorithm with OpenMP / C++">parallel tempering</a> to sample from complicated multi-modal target distributions but there are also other benefits and uses to this algorithm. There is a nice post on Darren Wilkinson&#8217;s blog about using <a href="http://darrenjw.wordpress.com/2013/10/01/marginal-likelihood-from-tempered-bayesian-posteriors/">tempered posteriors for marginal likelihood</a> calculations. There is also another area where parallel tempering finds application, namely in stochastic optimization. I first encountered parallel tempering whilst doing my MPhys degree at the University of Warwick but at that time it was employed as a stochastic optimization algorithm to find the minimum energy configuration of a Lennard-Jones cluster as opposed to a sampling algorithm. All that is required is one observation to turn this sampling algorithm into a stochastic optimization algorithm. Lets break this observation down into a few steps.<br />
Consider sampling from a simple exponential distribution $$f(E)\propto e^{-\beta E}1_{(0,\infty )}(E),$$<br />
with rate parameter beta. For now lets fix beta=5. One could sample from this distribution using the same <a href="../../mathematics/parallel-tempering-r-rmpi/index.html" title="Parallel Tempering Code in R Rmpi">Rmpi parallel tempering code</a> given in my previous post by simply changing the target distribution to the exponential above. The histograms of mcmc draws from four tempered distribution would then look something like this:<br />
<a href="../../wp-content/uploads/2013/10/exphist.jpeg"><img src="../../wp-content/uploads/2013/10/exphist-300x300.jpeg" alt="Histogram of mcmc draws" width="300" height="300" class="aligncenter size-medium wp-image-920" srcset="http://www.lindonslog.com/wp-content/uploads/2013/10/exphist-300x300.jpeg 300w, http://www.lindonslog.com/wp-content/uploads/2013/10/exphist-150x150.jpeg 150w, http://www.lindonslog.com/wp-content/uploads/2013/10/exphist.jpeg 1000w" sizes="(max-width: 300px) 100vw, 300px" /></a><br />
Note the scale on the x-axis. The two important observations mentioned earlier are
<li> The minimum value of E occurs most frequently as it the mode of the target distribution </li>
<li> The greater the rate parameter, the more concentrated the distribution is around E-min</li>
<p> The second point is important because although the sampling algorithm is creating draws that are not the minimum value of E, by increasing the rate parameter one can force these draws to be arbitrarily close to E-min.</p>
<h2>A Uni-modal Optimization Function</h2>
<p>How does this relate to optimization? Consider setting $$E(\theta)=(\theta-40)^2$$ Whereas before where using the Metropolis algorithm one would propose a new value of E, say E&#8217;, now the proposal is made in θ, and θ&#8217; is accepted based on u < f(E(θ')) / f(E(θ)). By construction the algorithm gives draws close to E-min, which occurs when θ=40. The traceplot of θ is shown below:
<a href="../../wp-content/uploads/2013/10/unioptim.jpeg"><img src="../../wp-content/uploads/2013/10/unioptim-300x300.jpeg" alt="Stochastic Optimization mcmc traceplot" width="350" height="350" class="aligncenter size-medium wp-image-929" srcset="http://www.lindonslog.com/wp-content/uploads/2013/10/unioptim-300x300.jpeg 300w, http://www.lindonslog.com/wp-content/uploads/2013/10/unioptim-150x150.jpeg 150w, http://www.lindonslog.com/wp-content/uploads/2013/10/unioptim.jpeg 600w" sizes="(max-width: 350px) 100vw, 350px" /></a><br />
Click here for the <a href="../../example_code/unioptim.R">code</a>.</p>
<h2>A Harder Optimization Function</h2>
<p>The above quadratic was an easy uni-modal example. Let&#8217;s try a harder function. Consider the minimum of $$ E(\theta)=3sin(\theta)+(0.1\theta-3)^2,$$ which looks like this:<br />
<a href="../../wp-content/uploads/2013/10/optimtest.jpeg"><img src="../../wp-content/uploads/2013/10/optimtest-300x185.jpeg" alt="Optimization Function" width="300" height="185" class="aligncenter size-medium wp-image-932" srcset="http://www.lindonslog.com/wp-content/uploads/2013/10/optimtest-300x185.jpeg 300w, http://www.lindonslog.com/wp-content/uploads/2013/10/optimtest.jpeg 894w" sizes="(max-width: 300px) 100vw, 300px" /></a><br />
This function has infinitely many local minima but one global minimum around 30. Local minima make optimization challenging and many optimization algorithms get stuck in these regions as locally it appears the minimum has been reached. This is where the parallel tempering really helps. The traceplots of theta are shown for six tempered distributions below:<br />
<a href="../../wp-content/uploads/2013/10/hardoptim.jpeg"><img src="../../wp-content/uploads/2013/10/hardoptim-682x1024.jpeg" alt="optimization traceplots mcmc" width="640" height="960" class="aligncenter size-large wp-image-938" srcset="http://www.lindonslog.com/wp-content/uploads/2013/10/hardoptim-682x1024.jpeg 682w, http://www.lindonslog.com/wp-content/uploads/2013/10/hardoptim-200x300.jpeg 200w, http://www.lindonslog.com/wp-content/uploads/2013/10/hardoptim.jpeg 1000w" sizes="(max-width: 640px) 100vw, 640px" /></a><br />
Click here for the <a href="../../example_code/multioptim.R">code</a>.</p>
<p>I&#8217;m currently working on another example just for fun, namely finding the lowest energy configuration of an n-particle Lennard-Jones cluster. This is a nice example because one can visualize the process using <a href="http://www.ks.uiuc.edu/Research/vmd/" rel="external nofollow">vmd</a> and it also provides some insight into the origins of such terminology as &#8220;tempering&#8221;, &#8220;annealing&#8221; and &#8220;temperature&#8221; which always look somewhat out of place in the statistics literature. </p>
<h2>An Even Harder Function</h2>
<p>Consider the function<br />
$$ E(\theta)=10\sin(0.3\theta)\sin(1.3\theta^2) + 0.00001\theta^4 + 0.2\theta+80, $$<br />
which is shown below.<br />
<a href="../../wp-content/uploads/2013/10/wildfunction.jpeg"><img src="../../wp-content/uploads/2013/10/wildfunction.jpeg" alt="Optimization Function" width="600" height="500" class="aligncenter size-full wp-image-945" srcset="http://www.lindonslog.com/wp-content/uploads/2013/10/wildfunction.jpeg 600w, http://www.lindonslog.com/wp-content/uploads/2013/10/wildfunction-300x250.jpeg 300w" sizes="(max-width: 600px) 100vw, 600px" /></a></p>
<p>The trace-plots for the parallel tempering optimization are shown below<br />
<a href="../../wp-content/uploads/2013/10/goodwild.jpeg"><img src="../../wp-content/uploads/2013/10/goodwild-682x1024.jpeg" alt="Parallel Tempering Optimization" width="640" height="960" class="aligncenter size-large wp-image-946" srcset="http://www.lindonslog.com/wp-content/uploads/2013/10/goodwild-682x1024.jpeg 682w, http://www.lindonslog.com/wp-content/uploads/2013/10/goodwild-200x300.jpeg 200w, http://www.lindonslog.com/wp-content/uploads/2013/10/goodwild.jpeg 1000w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>Examining the mcmc draws the minimum is obtained at theta=-15.81515.</p>
<p><span class="Z3988" title="ctx_ver=Z39.88-2004&#038;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Ajournal&#038;rft_id=info%3Adoi%2F10.1016%2Fj.amc.2009.02.023&#038;rft.atitle=Hybrid+parallel+tempering+and+simulated+annealing+method&#038;rft.jtitle=Applied+Mathematics+and+Computation&#038;rft.artnum=http%3A%2F%2Flinkinghub.elsevier.com%2Fretrieve%2Fpii%2FS0096300309001362&#038;rft.volume=212&#038;rft.issue=1&#038;rft.issn=00963003&#038;rft.spage=216&#038;rft.epage=228&#038;rft.date=2009&#038;rfr_id=info%3Asid%2Fscienceseeker.org&#038;rft.au=Li+Yaohang&#038;rft.aulast=Li&#038;rft.aufirst=Yaohang&#038;rft.au=Protopopescu+Vladimir+A.&#038;rft.aulast=Protopopescu&#038;rft.aufirst=Vladimir+A.&#038;rft.au=Arnold+Nikita&#038;rft.aulast=Arnold&#038;rft.aufirst=Nikita&#038;rft.au=Zhang+Xinyu&#038;rft.aulast=Zhang&#038;rft.aufirst=Xinyu&#038;rft.au=Gorin+Andrey&#038;rft.aulast=Gorin&#038;rft.aufirst=Andrey&#038;rfs_dat=ss.included=1&#038;rfe_dat=bpr3.included=1;bpr3.tags=Chemistry%2CComputer+Science+%2F+Engineering%2CMathematics%2CPhysics">Li Y., Protopopescu V.A., Arnold N., Zhang X. &#038; Gorin A. (2009). Hybrid parallel tempering and simulated annealing method, <span style="font-style:italic;">Applied Mathematics and Computation, 212</span> (1) 216-228. DOI: <a rel="author" href="http://dx.doi.org/10.1016%2Fj.amc.2009.02.023">10.1016/j.amc.2009.02.023</a></span></p>
<div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-facebook"><a rel="nofollow" data-shared="sharing-facebook-910" class="share-facebook sd-button share-icon" href="index.html%3Fshare=facebook.html" target="_blank" title="Click to share on Facebook"><span>Facebook</span></a></li><li class="share-twitter"><a rel="nofollow" data-shared="sharing-twitter-910" class="share-twitter sd-button share-icon" href="index.html%3Fshare=twitter.html" target="_blank" title="Click to share on Twitter"><span>Twitter</span></a></li><li class="share-google-plus-1"><a rel="nofollow" data-shared="sharing-google-910" class="share-google-plus-1 sd-button share-icon" href="index.html%3Fshare=google-plus-1.html" target="_blank" title="Click to share on Google+"><span>Google</span></a></li><li class="share-end"></li></ul></div></div></div><div class='sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-unloaded' id='like-post-wrapper-27325203-910-5866bc28b3b7b' data-src='//widgets.wp.com/likes/#blog_id=27325203&amp;post_id=910&amp;origin=www.lindonslog.com&amp;obj_id=27325203-910-5866bc28b3b7b' data-name='like-post-frame-27325203-910-5866bc28b3b7b'><h3 class='sd-title'>Like this:</h3><div class='likes-widget-placeholder post-likes-widget-placeholder' style='height:55px'><span class='button'><span>Like</span></span> <span class="loading">Loading...</span></div><span class='sd-text-color'></span><a class='sd-link-color'></a></div>					</div><!-- .entry-content -->

</div>	

</article><!-- #post-910 -->
				<div class="clear"></div>
				

				
<div id="disqus_thread">
            <div id="dsq-content">


            <ul id="dsq-comments">
                    <li class="comment even thread-even depth-1" id="dsq-comment-84">
        <div id="dsq-comment-header-84" class="dsq-comment-header">
            <cite id="dsq-cite-84">
                <a id="dsq-author-user-84" href="http://www.random-miner.blogspot.com.br/" target="_blank" rel="nofollow">fndtenorio</a>
            </cite>
        </div>
        <div id="dsq-comment-body-84" class="dsq-comment-body">
            <div id="dsq-comment-message-84" class="dsq-comment-message"><p>Genetic algorithms  cracks this very fast:  </p>
<p>require(gaoptim)<br />
energy.inv = function(theta){-energy(theta)}<br />
ga = GAReal(energy.inv, -100, 100, selection = &#8216;uniform&#8217;)<br />
ga$evolve(100)<br />
print(ga$bestIndividual())</p>
<p>Nice job anyway!</p>
</div>
        </div>

    <ul class="children">
    <li class="comment byuser comment-author-admin bypostauthor odd alt depth-2" id="dsq-comment-86">
        <div id="dsq-comment-header-86" class="dsq-comment-header">
            <cite id="dsq-cite-86">
                <span id="dsq-author-user-86">admin</span>
            </cite>
        </div>
        <div id="dsq-comment-body-86" class="dsq-comment-body">
            <div id="dsq-comment-message-86" class="dsq-comment-message"><p>I gave your package a try and I have also uploaded the parallel tempering optimization results for your test (&#8220;Wild&#8221;) function. I don&#8217;t have much experience with genetic algorithms, how well do these genetic algorithms perform in higher dimensional spaces? Do they have any shortcomings?</p>
</div>
        </div>

    <ul class="children">
    <li class="comment even depth-3" id="dsq-comment-88">
        <div id="dsq-comment-header-88" class="dsq-comment-header">
            <cite id="dsq-cite-88">
                <a id="dsq-author-user-88" href="http://random-miner.blogspot.com.br" target="_blank" rel="nofollow">fndtenorio</a>
            </cite>
        </div>
        <div id="dsq-comment-body-88" class="dsq-comment-body">
            <div id="dsq-comment-message-88" class="dsq-comment-message"><p>I&#8217;m not a expert either, stochastic optimization is natural to understand but very hard to describe the math behind. Sometimes is very hard to design a fitness function, and there&#8217;s no guarantee of convergence, limiting the use in real time applications. If the search space is very very large, then it get&#8217;s worse. For example, the GA technique is probably fail to solve the  Runge function polynomial approximation:</p>
<p># ga fail (answer  is a minimum maximal abs deviation of around 0.06)<br />
require(pracma)<br />
n = 10<br />
m = 101<br />
xi = seq(-1, 1, length = m)<br />
yi &lt;- 1 / (1 + (5*xi)^2)<br />
pfn &lt;- function(p) max(abs(polyval(c(p), xi) &#8211; yi))</p>
<p>But there&#039;s always a better choice i guess!</p>
</div>
        </div>

    <ul class="children">
    <li class="comment byuser comment-author-admin bypostauthor odd alt depth-4" id="dsq-comment-89">
        <div id="dsq-comment-header-89" class="dsq-comment-header">
            <cite id="dsq-cite-89">
                <span id="dsq-author-user-89">admin</span>
            </cite>
        </div>
        <div id="dsq-comment-body-89" class="dsq-comment-body">
            <div id="dsq-comment-message-89" class="dsq-comment-message"><p>Hi Fernando, I can&#8217;t get this piece of code as it is here to run &#8211; is it missing something? Would you mind posting it again? Parallel tempering does have some issues, specifically the devil is in the details with tuning parameters such as the choice of temperature set and also how large the proposed moves are within each tempered distribution. That being said there are adaptive ideas out there which adjust the proposal size so that you get an acceptance rate of around 40% within each distribution and also rules of thumb about how to choose the temperatures (i.e. geometric). I&#8217;m keen to learn about other methods though, so if these genetic algorithms perform well I&#8217;ll take a look at them 🙂</p>
</div>
        </div>

    </li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
    <li class="comment even thread-odd thread-alt depth-1" id="dsq-comment-90">
        <div id="dsq-comment-header-90" class="dsq-comment-header">
            <cite id="dsq-cite-90">
                <a id="dsq-author-user-90" href="http://random-miner.blogspot.com.br" target="_blank" rel="nofollow">fndtenorio</a>
            </cite>
        </div>
        <div id="dsq-comment-body-90" class="dsq-comment-body">
            <div id="dsq-comment-message-90" class="dsq-comment-message"><p>Sure. The problem above is to approximate the function y = 1 / (1 + (5*xi)^2) using a polynomial of degree n. Using n = 10:</p>
<p>  require(gaoptim)<br />
  require(pracma)</p>
<p>  n &lt;- 10  # polynomial of degree 10<br />
  m &lt;- 101 # no. of data points<br />
  xi &lt;- seq(-1, 1, length = m)<br />
  yi &lt;- 1 / (1 + (5*xi)^2)</p>
<p>  pfn &lt;- function(p) max(abs(polyval(c(p), xi) &#8211; yi))<br />
  pfninv &lt;- function(p){ 1/pfn(p) }</p>
<p>  ## set up a matrix for the polynomial data<br />
  ndeg &lt;- 10<br />
  ndim &lt;- ndeg + 1<br />
  ga = GAReal(pfninv, lb = rep(-1000, ndim), ub = rep(1000, ndim), selection = &#039;uniform&#039;)</p>
<p>  ga$evolve(200)<br />
  print(ga)</p>
<p>You can use least squares and compare with a GA solution. I received a paper on this, i can send you, just need the email.</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment odd alt thread-even depth-1" id="dsq-comment-92">
        <div id="dsq-comment-header-92" class="dsq-comment-header">
            <cite id="dsq-cite-92">
                <a id="dsq-author-user-92" href="http://random-miner.blogspot.com.br" target="_blank" rel="nofollow">fndtenorio</a>
            </cite>
        </div>
        <div id="dsq-comment-body-92" class="dsq-comment-body">
            <div id="dsq-comment-message-92" class="dsq-comment-message"><p>You can ask for the paper here:<br />
nashjc( at )uottawa( dot)ca</p>
</div>
        </div>

    </li><!-- #comment-## -->
    <li class="comment even thread-odd thread-alt depth-1" id="dsq-comment-366">
        <div id="dsq-comment-header-366" class="dsq-comment-header">
            <cite id="dsq-cite-366">
                <span id="dsq-author-user-366">Raymond</span>
            </cite>
        </div>
        <div id="dsq-comment-body-366" class="dsq-comment-body">
            <div id="dsq-comment-message-366" class="dsq-comment-message"><p>I read thro this and gone back to your earlier R mpi post,<br />
Sorry, still not sure how to &#8216;spread&#8217; R process 2 PC (you got cabbage and lettuce).<br />
Shall I just run mpi.bcast&#8230;something, it will automatically bcast to all nodes but when did you define the nodes that are avaliable?</p>
</div>
        </div>

    </li><!-- #comment-## -->
            </ul>


        </div>

    </div>


			
			</div><!-- #content .site-content -->
		</div><!-- #primary .content-area -->



	</div><!-- #main .site-main -->

<div id="bottom">
<div class="container_6 cf">

<li class="botwid grid_2 widget_categories"><h3 class="bothead">Categories</h3>		<ul>
	<li class="cat-item cat-item-3"><a href="../../category/linux-unix/index.html" >Linux/Unix</a> (16)
</li>
	<li class="cat-item cat-item-5"><a href="../../category/mathematics/index.html" >Mathematics</a> (22)
<ul class='children'>
	<li class="cat-item cat-item-10"><a href="../../category/mathematics/linear-algebra/index.html" >Linear Algebra</a> (5)
</li>
	<li class="cat-item cat-item-7"><a href="../../category/mathematics/statistics/index.html" >Statistics</a> (17)
</li>
</ul>
</li>
	<li class="cat-item cat-item-6"><a href="../../category/programming/index.html" >Programming</a> (24)
<ul class='children'>
	<li class="cat-item cat-item-48"><a href="../../category/programming/clojure/index.html" >clojure</a> (1)
</li>
	<li class="cat-item cat-item-51"><a href="../../category/programming/functional-programming/index.html" >functional programming</a> (1)
</li>
	<li class="cat-item cat-item-50"><a href="../../category/programming/haskell-programming/index.html" >haskell</a> (1)
</li>
	<li class="cat-item cat-item-40"><a href="../../category/programming/julia/index.html" >julia</a> (2)
</li>
	<li class="cat-item cat-item-4"><a href="../../category/programming/openmp/index.html" >OpenMP</a> (6)
</li>
	<li class="cat-item cat-item-11"><a href="../../category/programming/r/index.html" >R</a> (12)
</li>
	<li class="cat-item cat-item-43"><a href="../../category/programming/scala/index.html" >scala</a> (1)
</li>
</ul>
</li>
		</ul>
</li>		<li class="botwid grid_2 widget_recent_entries">		<h3 class="bothead">Recent Posts</h3>		<ul>
					<li>
				<a href="../partial-application-functions-julia/index.html">Partial Application for Functions in Julia</a>
						</li>
					<li>
				<a href="../newtons-iteration-scala-clojure-haskell/index.html">Newtons Iteration in Scala, Clojure and Haskell Comparison</a>
						</li>
					<li>
				<a href="../../mathematics/statistics/mala-metropolis-adjusted-langevin-algorithm-julia/index.html">MALA &#8211; Metropolis Adjusted Langevin Algorithm in Julia</a>
						</li>
					<li>
				<a href="../passing-julia-type-to-c-function-as-struct/index.html">Passing Julia Type to C Function as Struct</a>
						</li>
					<li>
				<a href="../../linux-unix/send-lines-code-vim-r-julia-python-repl-slime/index.html">Send Lines of Code from Vim to R/Julia/Python REPL</a>
						</li>
					<li>
				<a href="../../linux-unix/c-merge-sort-algorithm/index.html">C++ Merge Sort Algorithm</a>
						</li>
					<li>
				<a href="../generate-random-inverse-gaussian-r/index.html">Generate Random Inverse Gaussian in R</a>
						</li>
					<li>
				<a href="../../mathematics/statistics/generalized-double-pareto-shrinkage-priors-sparse-estimation-regression/index.html">Generalized Double Pareto Priors for Regression</a>
						</li>
					<li>
				<a href="../../mathematics/em-algorithm-bayesian-lasso-r-cpp-code/index.html">EM Algorithm for Bayesian Lasso R Cpp Code</a>
						</li>
				</ul>
		</li>			<div class="squarebanner grid_2 cf">
	<h3 class="bothead"> Sponsors </h3>
<ul><li>
<a rel="nofollow" href="index.html" title=""><img src="index.html" alt="" style="vertical-align:bottom;" /></a>
</li>			

<li>
<a rel="nofollow" href="index.html" title=""><img src="index.html" alt="" style="vertical-align:bottom;" /></a>
</li>

<li>
<a rel="nofollow" href="index.html" title=""><img src="index.html" alt="" style="vertical-align:bottom;" /></a>
</li>

<li>
<a rel="nofollow" href="index.html" title=""><img src="index.html" alt="" style="vertical-align:bottom;" /></a>
</li></ul>
</div></div>
</div>


	<footer id="colophon" class="site-footer" role="contentinfo">
	<div class="container_6">
	<div class="site-info">
			<div class="fcred">
			Copyright &copy; 2016 <a href="../../index.html" title="Lindons Log">Lindons Log</a> - .<br />
 | <a href="http://fabthemes.com/Winter/" >Winter WordPress Theme</a>
			</div>		
		</div><!-- .site-info -->	
		</footer><!-- #colophon .site-footer -->
	
</div><!-- #page .hfeed .site -->

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-40536457-1', 'lindonslog.com');
  ga('send', 'pageview');

</script><!-- MathJax Latex Plugin installed -->	<div style="display:none">
	</div>
<script type="text/javascript">var elLogo = document.getElementById("ft_logo"); if (elLogo) {elLogo.style.maxHeight = elLogo.getAttribute("relHeight") ? elLogo.getAttribute("relHeight") + "px" : "100px";} if (elLogo) {elLogo.style.maxWidth = elLogo.getAttribute("relWidth") ? elLogo.getAttribute("relWidth") + "px" : "100px";}</script>
	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"http:\/\/www.lindonslog.com\/programming\/stochastic-optimization-r-rmpi-parallel-tempering\/":910};
	</script>
		<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-facebook' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
				return false;
			});
		});
		</script>
				<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-twitter' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
				return false;
			});
		});
		</script>
				<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-google-plus-1' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomgoogle-plus-1', 'menubar=1,resizable=1,width=480,height=550' );
				return false;
			});
		});
		</script>
		<script type='text/javascript' src='http://s0.wp.com/wp-content/js/devicepx-jetpack.js?ver=201652'></script>
<script type='text/javascript' src='http://s.gravatar.com/js/gprofiles.js?ver=2016Decaa'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type='text/javascript' src='../../wp-content/plugins/jetpack/modules/wpgroho.js%3Fver=4.6.1'></script>
<script type='text/javascript' src='../../wp-content/themes/Winter/js/superfish.js%3Fver=20120206'></script>
<script type='text/javascript' src='../../wp-includes/js/comment-reply.min.js%3Fver=4.6.1'></script>
<script type='text/javascript' src='../../wp-includes/js/wp-embed.min.js%3Fver=4.6.1'></script>
<script type='text/javascript' src='../../wp-content/plugins/jetpack/_inc/postmessage.js%3Fver=3.9.7'></script>
<script type='text/javascript' src='../../wp-content/plugins/jetpack/_inc/jquery.jetpack-resize.js%3Fver=3.9.7'></script>
<script type='text/javascript' src='../../wp-content/plugins/jetpack/_inc/jquery.inview.js%3Fver=3.9.7'></script>
<script type='text/javascript' src='../../wp-content/plugins/jetpack/modules/likes/queuehandler.js%3Fver=3.9.7'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"platform":"wordpress@4.6.1","language":""},"disqusIdentifier":"910 http:\/\/www.lindonslog.com\/?p=910","disqusShortname":"michaellindon","disqusTitle":"Stochastic Optimization in R by Parallel Tempering","disqusUrl":"http:\/\/www.lindonslog.com\/programming\/stochastic-optimization-r-rmpi-parallel-tempering\/","options":{"manualSync":false},"postId":"910"};
/* ]]> */
</script>
<script type='text/javascript' src='../../wp-content/plugins/disqus-comment-system/media/js/disqus.js%3Fver=4.6.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"michaellindon"};
/* ]]> */
</script>
<script type='text/javascript' src='../../wp-content/plugins/disqus-comment-system/media/js/count.js%3Fver=4.6.1'></script>
<script type='text/javascript' src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default&#038;ver=1.2.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1"};
/* ]]> */
</script>
<script type='text/javascript' src='../../wp-content/plugins/jetpack/modules/sharedaddy/sharing.js%3Fver=3.9.7'></script>
		<iframe src='http://widgets.wp.com/likes/master.html?ver=20151215#ver=20151215' scrolling='no' id='likes-master' name='likes-master' style='display:none;'></iframe>
		<div id='likes-other-gravatars'><div class="likes-text"><span>%d</span> bloggers like this:</div><ul class="wpl-avatars sd-like-gravatars"></ul></div>
		<script type='text/javascript' src='http://stats.wp.com/e-201652.js' async defer></script>
<script type='text/javascript'>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:3.9.7',blog:'27325203',post:'910',tz:'-4',srv:'www.lindonslog.com'} ]);
	_stq.push([ 'clickTrackerInit', '27325203', '910' ]);
</script>

</body>
</html>
