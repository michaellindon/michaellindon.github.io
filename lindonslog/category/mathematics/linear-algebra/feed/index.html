<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>Linear Algebra &#8211; Ive Moved</title>
	<atom:link href="http://www.lindonslog.com/category/mathematics/linear-algebra/feed/" rel="self" type="application/rss+xml" />
	<link>http://www.lindonslog.com</link>
	<description></description>
	<lastBuildDate>Thu, 03 Nov 2016 17:07:09 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>https://wordpress.org/?v=4.6.1</generator>

<image>
	<url>http://www.lindonslog.com/wp-content/uploads/2015/09/cropped-L-32x32.png</url>
	<title>Linear Algebra &#8211; Ive Moved</title>
	<link>http://www.lindonslog.com</link>
	<width>32</width>
	<height>32</height>
</image> 
	<item>
		<title>Compile R and OpenBLAS from Source Guide</title>
		<link>http://www.lindonslog.com/linux-unix/compile-r-openblas-source-guide/</link>
		<comments>http://www.lindonslog.com/linux-unix/compile-r-openblas-source-guide/#comments</comments>
		<pubDate>Wed, 16 Jul 2014 20:54:15 +0000</pubDate>
		<dc:creator><![CDATA[admin]]></dc:creator>
				<category><![CDATA[Linear Algebra]]></category>
		<category><![CDATA[Linux/Unix]]></category>
		<category><![CDATA[OpenMP]]></category>
		<category><![CDATA[Programming]]></category>
		<category><![CDATA[R]]></category>
		<category><![CDATA[Statistics]]></category>

		<guid isPermaLink="false">http://www.lindonslog.com/?p=995</guid>
		<description><![CDATA[<p>1. Get OpenBLAS 2.1 Get R 2.2 Specific Instructions for DSS Users 3. Validation 4. Benchmark This guide is intended to aid any R and Linux user who desires a threaded version of BLAS. In particular I hope this will allow other grad students, who like me do not have many user privileges on their [&#8230;]</p>
<p>The post <a rel="nofollow" href="http://www.lindonslog.com/linux-unix/compile-r-openblas-source-guide/">Compile R and OpenBLAS from Source Guide</a> appeared first on <a rel="nofollow" href="http://www.lindonslog.com">Ive Moved</a>.</p>
]]></description>
				<content:encoded><![CDATA[<p><a href="#openblas">1. Get OpenBLAS</a><br />
<a href="#R">2.1 Get R</a><br />
<a href="#duke">2.2 Specific Instructions for DSS Users</a><br />
<a href="#validation">3. Validation</a><br />
<a href="#benchmark">4. Benchmark</a></p>
<p>This guide is intended to aid any R and Linux user who desires a threaded version of BLAS. In particular I hope this will allow other grad students, who like me do not have many user privileges on their office computer, to follow suit and exploit multiple cores to speed up their linear algebra computations within R. The following will be performed on <strong>Scientific Linux 6.4</strong> but has should be completely general. If you are a <strong>Ubuntu</strong> user, then there is an elegant and streamlined process for changing BLAS libraries and a recommended post about it <a href="http://www.stat.cmu.edu/~nmv/2013/07/09/for-faster-r-use-openblas-instead-better-than-atlas-trivial-to-switch-to-on-ubuntu/" title="ubuntu blas">here</a>. I use <strong>Fedora</strong> on my laptop, and the following has also been tested thereupon. </p>
<p>My office computer has a quadcore processor with two threads per core but I also have access to a departmental computer with 4 sockets and 12 cores per socket (1 thread per core), so it really makes sense to use a threaded version of BLAS. If you are curious about the hardware on your own computer you can run the command &#8220;cat /proc/cpuinfo&#8221; or &#8220;lscpu&#8221;.</p>
<p>Unfortunately my office computer is part of a network upon which I do not have permissions to change &#8216;/usr/lib64/R/lib/libRblas.so&#8217;. Moreover R appears to be running serially: if you start up R and get the PID (process ID) from &#8216;top&#8217; or &#8216;ps aux | grep R&#8217; or something and then execute &#8216;cat /proc/PID/status | grep Threads&#8217; you can see there is only one thread available.</p>
<pre class="brush: bash; title: ; notranslate">
[msl33@cabbage ~]$ cat /proc/13605/status | grep Threads
Threads:	1

</pre>
<p>(where 13605 was the process ID of my R process. That is using the default R on the network. One could appeal to the network administrator to change things for you but they probably won&#8217;t because a parallel BLAS implementation may cause problems for other users who require a serial BLAS, such as those that use the multicore environment to perform inherently parallel algorithms such as parallel tempering instead of using idle cores to speed up the linear algebra. There are also some known conflicts with the multicore package in R. There is, however, nothing stopping the user from compiling one&#8217;s own custom R build in one&#8217;s home directory and just changing the executable path thereto. In addition, you then have the power and freedom customize R to your needs &#8211; at the moment I have some very large matrices which would benefit from a threaded BLAS but at some point I may want to revert to a tuned serial BLAS such at ATLAS for certain parallel algorithms. </p>
<p>Firstly, go ahead and create a directory in which to keep all your custom software.</p>
<pre class="brush: bash; title: ; notranslate">
[msl33@cabbage ~]$ pwd
/home/grad/msl33
[msl33@cabbage ~]$ mkdir software

</pre>
<p><a name="openblas"></a><br />
<h1>Download OpenBLAS</h1>
<p>Make a directory &#8220;openblas&#8221; in the &#8220;software directory.</p>
<pre class="brush: bash; title: ; notranslate">
[msl33@cabbage ~]$ cd software/
[msl33@cabbage software]$ mkdir openblas

</pre>
<p>Next, grab the tarball from the <a href="http://www.openblas.net/" title="openblas homepage">OpenBLAS homepage</a>. Change directory into where you downloaded the tarball and extract the files from it.</p>
<pre class="brush: bash; title: ; notranslate">
[msl33@cabbage ~]$ cd Downloads/
[msl33@cabbage Downloads]$ tar -xvf xianyi-OpenBLAS-v0.2.9-0-gf773f49.tar.gz 

</pre>
<p>While this is running, fill a kettle with some water and turn it on, this stage is very important.</p>
<p>Change directory into where you extracted the files and verify that NO_AFFINITY=1 is uncommented in the Makefile.rule. If so proceed and run make.</p>
<pre class="brush: bash; title: ; notranslate">
[msl33@cabbage ~/Downloads]$ cd xianyi-OpenBLAS-347dded/
[msl33@cabbage xianyi-OpenBLAS-347dded]$ cat Makefile.rule | grep NO_AFFINITY
NO_AFFINITY = 1
[msl33@cabbage xianyi-OpenBLAS-347dded]$ make

</pre>
<p>Now is a good time to &#8220;make&#8221; some tea with the water prepared earlier. When done successfully one will see<br />
<a href="http://www.lindonslog.com/wp-content/uploads/2014/07/openblas_complete.png"><img src="http://www.lindonslog.com/wp-content/uploads/2014/07/openblas_complete.png" alt="openblas confirmation" width="656" height="255" class="size-full wp-image-1002" srcset="http://www.lindonslog.com/wp-content/uploads/2014/07/openblas_complete.png 656w, http://www.lindonslog.com/wp-content/uploads/2014/07/openblas_complete-300x116.png 300w" sizes="(max-width: 656px) 100vw, 656px" /></a><br />
Now, as instructed above, install to the &#8220;software&#8221; directory made earlier.</p>
<pre class="brush: bash; title: ; notranslate">
[msl33@cabbage xianyi-OpenBLAS-347dded]$ make PREFIX=/home/grad/msl33/software/openblas install
...
Install OK!
</pre>
<p>In  openblas/lib there will be a file &#8220;libopenblas.so&#8221;, needed for later. That&#8217;s it for openblas, next we will do R.</p>
<p><a name="R"></a><br />
<h1>Download R</h1>
<p>Let&#8217;s create an R directory in software. Go onto the R homepage, then download, then choose a <a href="http://mirrors.ebi.ac.uk/CRAN/">mirror</a> and grab the tarball of the latest version. Download it to your &#8220;software&#8221; directory and extract it as before with &#8220;tar -xvf R-3.1.1.tar.gz&#8221;. Once extracted, remove the tarball and change directory into R-3.1.1. Before running the configure script one might bring some customizations into consideration in the name of efficiency. One might consider upping the optimization level from 2 to 3 and adding march or mtune by editing &#8220;config.site&#8221; and changing &#8220;## CFLAGS=&#8221; on line 53 to &#8220;CFLAGS=&#8217;-O3 -march=native'&#8221; and making similar changes for FFLAGS and CXXFLAGS. It is noted in the <a href="http://cran.r-project.org/doc/manuals/r-release/R-admin.html#Compilation-flags">R Installation and Administration</a> documentation that these can produce worthwhile speedups but come with a warning that the build will be less reliable, with segfaults and numerical errors creeping in. It is safest to leave things <a href="http://www.youtube.com/watch?v=aYBkDxao3wg&#038;t=2m28s">regular</a> (reccommended link) but I&#8217;ll take the risk. Now, if you are not using a computer on the duke statistical science network, run the configure script, otherwise see the additional instructions before running configure.</p>
<pre class="brush: bash; title: ; notranslate">
[msl33@cabbage R-3.1.1]$ ./configure --prefix=/home/grad/msl33/software/R --enable-R-shlib --enable-BLAS-shlib --enable-memory-profiling --with-tcltk=no

</pre>
<p><a name="duke"></a><br />
<h3>BEGIN ADDITIONAL INSTRUCTIONS FOR DUKE STATISTICAL SCIENCE STUDENTS</h3>
<p>[On the DSS computers some further instructions are required to locate headers and libraries. The first time I tried to make on my office computer I encountered this <a href="http://stackoverflow.com/questions/17570586/unable-to-compile-jni-program-rjava">error</a>. &#8220;jni.h&#8221; could not be found. The error was resolved by locating it and then export the environment variable JAVA_HOME.</p>
<pre class="brush: bash; title: ; notranslate">
[msl33@cabbage software]$ locate jni.h
/usr/lib/jvm/java-1.7.0-sun-1.7.0.11/include/jni.h
[msl33@cabbage software]$ export JAVA_HOME=/usr/lib/jvm/java-1.7.0-sun-1.7.0.11/

</pre>
<p>In addition, when running the configure script the readline headers/libs could not be found. We&#8217;ll just borrow them from some other software. Add to CFLAGS, FFLAGS, CXXFLAGS &#8220;-I/opt/EPD_Free/include -L/opt/EPD_Free/lib&#8221; in addition to any other flags that you have set. Also make a lib directory and copy them in.</p>
<pre class="brush: bash; title: ; notranslate">
[msl33@cabbage R-3.1.1]$ mkdir lib
[msl33@cabbage R-3.1.1]$ cp /opt/EPD_Free/lib/libreadline.* lib/
[msl33@cabbage R-3.1.1]$ cp /opt/EPD_Free/lib/libncurses* lib/
</pre>
<p> Now run the configure line above.]</p>
<h3>END ADDITIONAL INSTRUCTIONS FOR DUKE STATISTICAL SCIENCE STUDENTS</h3>
<p>Once the configure has completed, you&#8217;ll see a summary below like<br />
<a href="http://www.lindonslog.com/wp-content/uploads/2014/07/configure.png"><img src="http://www.lindonslog.com/wp-content/uploads/2014/07/configure-1024x383.png" alt="openblas configure" width="640" height="239" class="aligncenter size-large wp-image-1013" srcset="http://www.lindonslog.com/wp-content/uploads/2014/07/configure-1024x383.png 1024w, http://www.lindonslog.com/wp-content/uploads/2014/07/configure-300x112.png 300w, http://www.lindonslog.com/wp-content/uploads/2014/07/configure.png 1026w" sizes="(max-width: 640px) 100vw, 640px" /></a><br />
Now issue the command &#8220;make&#8221;, it will take some time. Once make has finished, you can execute &#8220;make install&#8221; to populate the software/R directory created earlier but you don&#8217;t need to. Change directories to lib and make a backup of libRblas.so and create a symbolic link to the openblas library that was made earlier.</p>
<pre class="brush: bash; title: ; notranslate">
[msl33@cabbage ~]$ cd software/R-3.1.1/lib
[msl33@cabbage lib]$ pwd
/home/grad/msl33/software/R-3.1.1/lib
[msl33@cabbage lib]$ mv libRblas.so libRblas.so.keep
[msl33@cabbage lib]$ ln -s /home/grad/msl33/software/openblas/lib/libopenblas.so libRblas.so

</pre>
<p>That was the last step. </p>
<p><a name="validation"></a><br />
<h2>Setup Validation</h2>
<p>The R executable in the bin directory should now use openblas. Note this is the R executable you now need to run in order to use the custom built R with openblas. Just typing R in terminal will load the old /usr/lib64&#8230; which we students didn&#8217;t have the permissions to alter. You can, however, create an alias in your .bashrc file by inserting the line &#8216;alias R=&#8221;/home/grad/msl33/software/R-3.1.1/bin/./R&#8221;&#8216;. Now when you type R in a terminal it will load the new R and not the old one.  One can check that R executable depends on the correct linked shared blas library with the &#8220;ldd&#8221; command.</p>
<pre class="brush: bash; title: ; notranslate">
[msl33@cabbage bin]$ pwd
/home/grad/msl33/software/R-3.1.1/bin
[msl33@cabbage bin]$ ./R CMD ldd exec/./R | grep blas
	libRblas.so =&gt; /home/grad/msl33/software/R-3.1.1/lib/libRblas.so (0x00007f62e3fb7000)
[msl33@cabbage bin]$ ls -lt ../lib | grep openblas
lrwxrwxrwx  1 msl33 grad      53 Jul 16 15:35 libRblas.so -&gt; /home/grad/msl33/software/openblas/lib/libopenblas.so

</pre>
<p>In addition, execute &#8220;./R&#8221; from the &#8220;bin&#8221; directory  (or just R if you set up the alias) and grab the process id. </p>
<pre class="brush: bash; title: ; notranslate">
[msl33@cabbage bin]$ ps aux | grep R | grep software | awk '{print $2}'
2412
[msl33@cabbage bin]$ cat /proc/`ps aux | grep R | grep software | awk '{print $2}'`/status | grep Threads
Threads:	8
[msl33@cabbage bin]$ 

</pre>
<p>Evidently the R session now has 8 threads available. Finally, lets perform an eigen-decomposition and look at the cpu usage using top. You&#8217;ll see it light up all of your cores.<br />
<a href="http://www.lindonslog.com/wp-content/uploads/2014/07/openblas_cpu.png"><img src="http://www.lindonslog.com/wp-content/uploads/2014/07/openblas_cpu-1024x358.png" alt="openblas cpu usage" width="640" height="223" class="aligncenter size-large wp-image-1012" srcset="http://www.lindonslog.com/wp-content/uploads/2014/07/openblas_cpu-1024x358.png 1024w, http://www.lindonslog.com/wp-content/uploads/2014/07/openblas_cpu-300x105.png 300w, http://www.lindonslog.com/wp-content/uploads/2014/07/openblas_cpu.png 1321w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p><a name="benchmark"></a><br />
<h2>Benchmark</h2>
<p>Using this <a href="http://r.research.att.com/benchmarks/R-benchmark-25.R">benchmark</a> the reference BLAS took 32.1 seconds whilst openBLAS took 7.1 seconds.</p>
<p>The post <a rel="nofollow" href="http://www.lindonslog.com/linux-unix/compile-r-openblas-source-guide/">Compile R and OpenBLAS from Source Guide</a> appeared first on <a rel="nofollow" href="http://www.lindonslog.com">Ive Moved</a>.</p>
]]></content:encoded>
			<wfw:commentRss>http://www.lindonslog.com/linux-unix/compile-r-openblas-source-guide/feed/</wfw:commentRss>
		<slash:comments>3</slash:comments>
		</item>
		<item>
		<title>Woodbury Matrix Inverse Identity</title>
		<link>http://www.lindonslog.com/mathematics/woodbury-matrix-inverse-multivariate-normal/</link>
		<comments>http://www.lindonslog.com/mathematics/woodbury-matrix-inverse-multivariate-normal/#comments</comments>
		<pubDate>Wed, 31 Jul 2013 19:10:37 +0000</pubDate>
		<dc:creator><![CDATA[admin]]></dc:creator>
				<category><![CDATA[Linear Algebra]]></category>
		<category><![CDATA[Mathematics]]></category>
		<category><![CDATA[Statistics]]></category>

		<guid isPermaLink="false">http://www.lindonslog.com/?p=663</guid>
		<description><![CDATA[<p>Application in Conditional Distribution of Multivariate Normal The Sherman-Woodbury-Morrison matrix inverse identity can be regarded as a transform between Schur complements. That is, given one can obtain by using the Woodbury matrix identity and vice versa. Recall the Woodbury Identity: and I recently stumbled across a neat application of this whilst deriving full conditionals for [&#8230;]</p>
<p>The post <a rel="nofollow" href="http://www.lindonslog.com/mathematics/woodbury-matrix-inverse-multivariate-normal/">Woodbury Matrix Inverse Identity</a> appeared first on <a rel="nofollow" href="http://www.lindonslog.com">Ive Moved</a>.</p>
]]></description>
				<content:encoded><![CDATA[<h1>Application in Conditional Distribution of Multivariate Normal</h1>
<p>The Sherman-Woodbury-Morrison matrix inverse identity can be regarded as a transform between Schur complements. That is, given <img src="//s0.wp.com/latex.php?latex=V_%7B22.1%7D%5E%7B-1%7D&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="V_{22.1}^{-1}" title="V_{22.1}^{-1}" class="latex" /> one can obtain <img src="//s0.wp.com/latex.php?latex=V_%7B11.2%7D%5E%7B-1%7D&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="V_{11.2}^{-1}" title="V_{11.2}^{-1}" class="latex" /> by using the Woodbury matrix identity and vice versa. Recall the <a title="Invert Matrix Woodbury Matrix Inverse Formula Identity" href="http://www.lindonslog.com/mathematics/invert-a-matrix-using-the-woodbury-matrix-inverse-formula-identity/" target="_blank">Woodbury Identity</a>:</p>
<p align="center"><img src="//s0.wp.com/latex.php?latex=V_%7B11.2%7D%5E%7B-1%7D%3DV_%7B11%7D%5E%7B-1%7D%2BV_%7B11%7D%5E%7B-1%7DV_%7B12%7DV_%7B22.1%7D%5E%7B-1%7DV_%7B21%7DV_%7B11%7D%5E%7B-1%7D+&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="V_{11.2}^{-1}=V_{11}^{-1}+V_{11}^{-1}V_{12}V_{22.1}^{-1}V_{21}V_{11}^{-1} " title="V_{11.2}^{-1}=V_{11}^{-1}+V_{11}^{-1}V_{12}V_{22.1}^{-1}V_{21}V_{11}^{-1} " class="latex" /></p>
<p>and</p>
<p align="center"><img src="//s0.wp.com/latex.php?latex=V_%7B22.1%7D%5E%7B-1%7D%3DV_%7B22%7D%5E%7B-1%7D%2BV_%7B22%7D%5E%7B-1%7DV_%7B21%7DV_%7B11.2%7D%5E%7B-1%7DV_%7B12%7DV_%7B22%7D%5E%7B-1%7D+&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="V_{22.1}^{-1}=V_{22}^{-1}+V_{22}^{-1}V_{21}V_{11.2}^{-1}V_{12}V_{22}^{-1} " title="V_{22.1}^{-1}=V_{22}^{-1}+V_{22}^{-1}V_{21}V_{11.2}^{-1}V_{12}V_{22}^{-1} " class="latex" /></p>
<p>I recently stumbled across a neat application of this whilst deriving full conditionals for a multivariate normal. Recall that if the data are partitioned into two blocks, <img src="//s0.wp.com/latex.php?latex=Y_%7B1%7D%2CY_%7B2%7D&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="Y_{1},Y_{2}" title="Y_{1},Y_{2}" class="latex" />, then the variance of the conditional distribution <img src="//s0.wp.com/latex.php?latex=Y_%7B1%7D%7CY_%7B2%7D%2C-&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="Y_{1}|Y_{2},-" title="Y_{1}|Y_{2},-" class="latex" /> is the Schur complement of the block <img src="//s0.wp.com/latex.php?latex=V_%7B22%7D&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="V_{22}" title="V_{22}" class="latex" /> of total variance matrix <img src="//s0.wp.com/latex.php?latex=V&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="V" title="V" class="latex" />, that is, the variance of the conditional distribution is <img src="//s0.wp.com/latex.php?latex=V_%7B11.2%7D%3DV_%7B11%7D-V_%7B12%7DV_%7B22%7D%5E%7B-1%7DV_%7B21%7D&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="V_{11.2}=V_{11}-V_{12}V_{22}^{-1}V_{21}" title="V_{11.2}=V_{11}-V_{12}V_{22}^{-1}V_{21}" class="latex" /> which is the variance of <img src="//s0.wp.com/latex.php?latex=Y_%7B1%7D&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="Y_{1}" title="Y_{1}" class="latex" /> subtracted by something corresponding to the reduction in uncertainty about <img src="//s0.wp.com/latex.php?latex=Y_%7B1%7D&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="Y_{1}" title="Y_{1}" class="latex" /> gained from the knowledge about <img src="//s0.wp.com/latex.php?latex=Y_%7B2%7D&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="Y_{2}" title="Y_{2}" class="latex" />. If, however, <img src="//s0.wp.com/latex.php?latex=V_%7B22%7D&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="V_{22}" title="V_{22}" class="latex" /> has the form of a Schur complement itself, then it may be possible to exploit the Woodbury identity above to considerably simplify the variance term. I came across this when I derived two very different-looking expressions for the conditional distribution and found them equivalent by the Woodbury identity. Consider the model</p>
<p align="center"><img src="//s0.wp.com/latex.php?latex=%5Cbegin%7Bbmatrix%7D+++Y_%7B1%7D%5C%5C+++Y_%7B2%7D++%5Cend%7Bbmatrix%7D++%3D++%5Cbegin%7Bbmatrix%7D+++X_%7B1%7D%5C%5C+++X_%7B2%7D++%5Cend%7Bbmatrix%7D%5Cbeta_%7B+%7D+%2B+%5Cvarepsilon++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;begin{bmatrix}   Y_{1}&#92;&#92;   Y_{2}  &#92;end{bmatrix}  =  &#92;begin{bmatrix}   X_{1}&#92;&#92;   X_{2}  &#92;end{bmatrix}&#92;beta_{ } + &#92;varepsilon  " title="&#92;begin{bmatrix}   Y_{1}&#92;&#92;   Y_{2}  &#92;end{bmatrix}  =  &#92;begin{bmatrix}   X_{1}&#92;&#92;   X_{2}  &#92;end{bmatrix}&#92;beta_{ } + &#92;varepsilon  " class="latex" /></p>
<p>where</p>
<p align="center"><img src="//s0.wp.com/latex.php?latex=%5Cvarepsilon+%5Csim+N%5Cleft%28+%5Cbegin%7Bbmatrix%7D0%5C%5C+0%5Cend%7Bbmatrix%7D%2C+%5Csigma%5E%7B2%7D+%5Cbegin%7Bbmatrix%7DI_%7B1%7D+%26+0+%5C%5C+0+%26+I_%7B2%7D%5Cend%7Bbmatrix%7D+%5Cright%29+&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;varepsilon &#92;sim N&#92;left( &#92;begin{bmatrix}0&#92;&#92; 0&#92;end{bmatrix}, &#92;sigma^{2} &#92;begin{bmatrix}I_{1} &amp; 0 &#92;&#92; 0 &amp; I_{2}&#92;end{bmatrix} &#92;right) " title="&#92;varepsilon &#92;sim N&#92;left( &#92;begin{bmatrix}0&#92;&#92; 0&#92;end{bmatrix}, &#92;sigma^{2} &#92;begin{bmatrix}I_{1} &amp; 0 &#92;&#92; 0 &amp; I_{2}&#92;end{bmatrix} &#92;right) " class="latex" /></p>
<p align="center"><img src="//s0.wp.com/latex.php?latex=%5Cbeta_%7B+%7D%7C+%2C%5Csigma%5E%7B2%7D+%5Csim+N%280%2C+%5Csigma%5E%7B2%7D%5CLambda%5E%7B-1%7D%29&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;beta_{ }| ,&#92;sigma^{2} &#92;sim N(0, &#92;sigma^{2}&#92;Lambda^{-1})" title="&#92;beta_{ }| ,&#92;sigma^{2} &#92;sim N(0, &#92;sigma^{2}&#92;Lambda^{-1})" class="latex" /></p>
<p>.<br />
I was seeking the distribution <img src="//s0.wp.com/latex.php?latex=Y_%7B1%7D%7C+Y_%7B2%7D%2C%5Csigma%5E%7B2%7D+&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="Y_{1}| Y_{2},&#92;sigma^{2} " title="Y_{1}| Y_{2},&#92;sigma^{2} " class="latex" /> and arrived there through two different paths. The distributions derived looked very different, but they turned out to be equivalent upon considering the Woodbury identity.</p>
<h2>Method 1</h2>
<p>This simply manipulates properties of the multivariate normal. Marginalizing over <img src="//s0.wp.com/latex.php?latex=%5Cbeta&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;beta" title="&#92;beta" class="latex" /> one gets</p>
<p align="center"><img src="//s0.wp.com/latex.php?latex=Cov+%5Cbegin%7Bbmatrix%7D+++Y_%7B1%7D+%5C%5C++Y_%7B2%7D++%5Cend%7Bbmatrix%7D+%3D+%5Cbegin%7Bbmatrix%7D+++X_%7B1%7D+%5C%5C++X_%7B2%7D++%5Cend%7Bbmatrix%7D+Cov+%28%5Cbeta_%7B+%7D%29++%5Cbegin%7Bbmatrix%7D+++X_%7B1%7D%5E%7BT%7D+%26++X_%7B2%7D%5E%7BT%7D++%5Cend%7Bbmatrix%7D+%2B+Cov%28%5Cvarepsilon%29++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="Cov &#92;begin{bmatrix}   Y_{1} &#92;&#92;  Y_{2}  &#92;end{bmatrix} = &#92;begin{bmatrix}   X_{1} &#92;&#92;  X_{2}  &#92;end{bmatrix} Cov (&#92;beta_{ })  &#92;begin{bmatrix}   X_{1}^{T} &amp;  X_{2}^{T}  &#92;end{bmatrix} + Cov(&#92;varepsilon)  " title="Cov &#92;begin{bmatrix}   Y_{1} &#92;&#92;  Y_{2}  &#92;end{bmatrix} = &#92;begin{bmatrix}   X_{1} &#92;&#92;  X_{2}  &#92;end{bmatrix} Cov (&#92;beta_{ })  &#92;begin{bmatrix}   X_{1}^{T} &amp;  X_{2}^{T}  &#92;end{bmatrix} + Cov(&#92;varepsilon)  " class="latex" /></p>
<p align="center"><img src="//s0.wp.com/latex.php?latex=Cov+%5Cbegin%7Bbmatrix%7D+++Y_%7B1%7D+%5C%5C++Y_%7B2%7D++%5Cend%7Bbmatrix%7D+%3D+%5Csigma%5E%7B2%7D%5Cbegin%7Bbmatrix%7D+++X_%7B1%7D%5CLambda%5E%7B-1%7D+X_%7B1%7D%5E%7BT%7D+%26++X_%7B1%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5E%7BT%7D+%5C%5C++X_%7B2%7D%5CLambda%5E%7B-1%7D+X_%7B1%7D%5E%7BT%7D+%26++X_%7B2%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5E%7BT%7D++%5Cend%7Bbmatrix%7D++%2B+%5Csigma%5E%7B2%7D++%5Cbegin%7Bbmatrix%7D++I_%7B1%7D+%26+0+%5C%5C+0+%26+I_%7B2%7D++%5Cend%7Bbmatrix%7D++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="Cov &#92;begin{bmatrix}   Y_{1} &#92;&#92;  Y_{2}  &#92;end{bmatrix} = &#92;sigma^{2}&#92;begin{bmatrix}   X_{1}&#92;Lambda^{-1} X_{1}^{T} &amp;  X_{1}&#92;Lambda^{-1} X_{2}^{T} &#92;&#92;  X_{2}&#92;Lambda^{-1} X_{1}^{T} &amp;  X_{2}&#92;Lambda^{-1} X_{2}^{T}  &#92;end{bmatrix}  + &#92;sigma^{2}  &#92;begin{bmatrix}  I_{1} &amp; 0 &#92;&#92; 0 &amp; I_{2}  &#92;end{bmatrix}  " title="Cov &#92;begin{bmatrix}   Y_{1} &#92;&#92;  Y_{2}  &#92;end{bmatrix} = &#92;sigma^{2}&#92;begin{bmatrix}   X_{1}&#92;Lambda^{-1} X_{1}^{T} &amp;  X_{1}&#92;Lambda^{-1} X_{2}^{T} &#92;&#92;  X_{2}&#92;Lambda^{-1} X_{1}^{T} &amp;  X_{2}&#92;Lambda^{-1} X_{2}^{T}  &#92;end{bmatrix}  + &#92;sigma^{2}  &#92;begin{bmatrix}  I_{1} &amp; 0 &#92;&#92; 0 &amp; I_{2}  &#92;end{bmatrix}  " class="latex" /></p>
<p>.<br />
Such that the distribution</p>
<p align="center"><img src="//s0.wp.com/latex.php?latex=%5Cbegin%7Bbmatrix%7D+++Y_%7B1%7D%5C%5C+++Y_%7B2%7D++%5Cend%7Bbmatrix%7D%7C+%2C%5Csigma%5E%7B2%7D+%5Csim+N+%5Cleft%28++%5Cbegin%7Bbmatrix%7D++0%5C%5C++0++%5Cend%7Bbmatrix%7D%2C++%5Csigma%5E%7B2%7D+%5Cleft%28+%5Cbegin%7Bbmatrix%7D++I_%7B1%7D%2B++X_%7B1%7D%5CLambda%5E%7B-1%7D+X_%7B1%7D%5E%7BT%7D+%26++X_%7B1%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5E%7BT%7D+%5C%5C++X_%7B2%7D%5CLambda%5E%7B-1%7D+X_%7B1%7D%5E%7BT%7D+%26+I_%7B2%7D%2B+X_%7B2%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5E%7BT%7D++%5Cend%7Bbmatrix%7D++%5Cright%29+%5Cright%29++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;begin{bmatrix}   Y_{1}&#92;&#92;   Y_{2}  &#92;end{bmatrix}| ,&#92;sigma^{2} &#92;sim N &#92;left(  &#92;begin{bmatrix}  0&#92;&#92;  0  &#92;end{bmatrix},  &#92;sigma^{2} &#92;left( &#92;begin{bmatrix}  I_{1}+  X_{1}&#92;Lambda^{-1} X_{1}^{T} &amp;  X_{1}&#92;Lambda^{-1} X_{2}^{T} &#92;&#92;  X_{2}&#92;Lambda^{-1} X_{1}^{T} &amp; I_{2}+ X_{2}&#92;Lambda^{-1} X_{2}^{T}  &#92;end{bmatrix}  &#92;right) &#92;right)  " title="&#92;begin{bmatrix}   Y_{1}&#92;&#92;   Y_{2}  &#92;end{bmatrix}| ,&#92;sigma^{2} &#92;sim N &#92;left(  &#92;begin{bmatrix}  0&#92;&#92;  0  &#92;end{bmatrix},  &#92;sigma^{2} &#92;left( &#92;begin{bmatrix}  I_{1}+  X_{1}&#92;Lambda^{-1} X_{1}^{T} &amp;  X_{1}&#92;Lambda^{-1} X_{2}^{T} &#92;&#92;  X_{2}&#92;Lambda^{-1} X_{1}^{T} &amp; I_{2}+ X_{2}&#92;Lambda^{-1} X_{2}^{T}  &#92;end{bmatrix}  &#92;right) &#92;right)  " class="latex" /></p>
<p>It follows that the conditional distribution is<br />
<img src="//s0.wp.com/latex.php?latex=Y_%7B1%7D%7C+Y_%7B2%7D+%2C%5Csigma%5E%7B2%7D+%5Csim+N+%5Cleft%28++X_%7B1%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5E%7BT%7D+%5Cleft%5B++X_%7B2%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5E%7BT%7D+%2B+I_%7B2%7D%5Cright%5D%5E%7B-1%7D+Y_%7B2%7D%2C+I_%7B1%7D+%2B++X_%7B1%7D%5CLambda%5E%7B-1%7D+X_%7B1%7D%5E%7BT%7D+-++X_%7B1%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5E%7BT%7D+%5Cleft%5B+I_%7B2%7D+%2B++X_%7B2%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5E%7BT%7D+%5Cright%5D%5E%7B-1%7D++X_%7B2%7D%5CLambda%5E%7B-1%7D+X_%7B1%7D%5E%7BT%7D%5Cright%29.++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="Y_{1}| Y_{2} ,&#92;sigma^{2} &#92;sim N &#92;left(  X_{1}&#92;Lambda^{-1} X_{2}^{T} &#92;left[  X_{2}&#92;Lambda^{-1} X_{2}^{T} + I_{2}&#92;right]^{-1} Y_{2}, I_{1} +  X_{1}&#92;Lambda^{-1} X_{1}^{T} -  X_{1}&#92;Lambda^{-1} X_{2}^{T} &#92;left[ I_{2} +  X_{2}&#92;Lambda^{-1} X_{2}^{T} &#92;right]^{-1}  X_{2}&#92;Lambda^{-1} X_{1}^{T}&#92;right).  " title="Y_{1}| Y_{2} ,&#92;sigma^{2} &#92;sim N &#92;left(  X_{1}&#92;Lambda^{-1} X_{2}^{T} &#92;left[  X_{2}&#92;Lambda^{-1} X_{2}^{T} + I_{2}&#92;right]^{-1} Y_{2}, I_{1} +  X_{1}&#92;Lambda^{-1} X_{1}^{T} -  X_{1}&#92;Lambda^{-1} X_{2}^{T} &#92;left[ I_{2} +  X_{2}&#92;Lambda^{-1} X_{2}^{T} &#92;right]^{-1}  X_{2}&#92;Lambda^{-1} X_{1}^{T}&#92;right).  " class="latex" /><br />
This looks a bit nasty, but notice that <img src="//s0.wp.com/latex.php?latex=V_%7B22%7D%5E%7B-1%7D&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="V_{22}^{-1}" title="V_{22}^{-1}" class="latex" /> looks like it too could be a Schur complement of some matrix.</p>
<h2>Method 2</h2>
<p>An alternative route to this distribution is</p>
<p align="center"><img src="//s0.wp.com/latex.php?latex=f%28+Y_%7B1%7D%7C+Y_%7B2%7D%2C%5Csigma%5E%7B2%7D+%29%3D%5Cint+f%28+Y_%7B1%7D%7C%5Csigma%5E%7B2%7D+%2C%5Cbeta_%7B+%7D%29%5Cpi%28%5Cbeta_%7B+%7D%7C+Y_%7B2%7D%2C%5Csigma%5E%7B2%7D+%29d%5Cbeta_%7B+%7D++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="f( Y_{1}| Y_{2},&#92;sigma^{2} )=&#92;int f( Y_{1}|&#92;sigma^{2} ,&#92;beta_{ })&#92;pi(&#92;beta_{ }| Y_{2},&#92;sigma^{2} )d&#92;beta_{ }  " title="f( Y_{1}| Y_{2},&#92;sigma^{2} )=&#92;int f( Y_{1}|&#92;sigma^{2} ,&#92;beta_{ })&#92;pi(&#92;beta_{ }| Y_{2},&#92;sigma^{2} )d&#92;beta_{ }  " class="latex" /></p>
<p>where</p>
<p align="center"><img src="//s0.wp.com/latex.php?latex=%5Cbeta_%7B+%7D%7C+Y_%7B2%7D+%2C%5Csigma%5E%7B2%7D%5Csim+N+%5Cleft%28+%28+X_%7B2%7D%5E%7BT%7D+X_%7B2%7D%2B%5CLambda%29%5E%7B-1%7D+X_%7B2%7D%5E%7BT%7D+Y_%7B2%7D%2C+%5Csigma%5E%7B2%7D%28+X_%7B2%7D%5E%7BT%7D+X_%7B2%7D%2B%5CLambda%29%5E%7B-1%7D+%5Cright%29.++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;beta_{ }| Y_{2} ,&#92;sigma^{2}&#92;sim N &#92;left( ( X_{2}^{T} X_{2}+&#92;Lambda)^{-1} X_{2}^{T} Y_{2}, &#92;sigma^{2}( X_{2}^{T} X_{2}+&#92;Lambda)^{-1} &#92;right).  " title="&#92;beta_{ }| Y_{2} ,&#92;sigma^{2}&#92;sim N &#92;left( ( X_{2}^{T} X_{2}+&#92;Lambda)^{-1} X_{2}^{T} Y_{2}, &#92;sigma^{2}( X_{2}^{T} X_{2}+&#92;Lambda)^{-1} &#92;right).  " class="latex" /></p>
<p>It follows that</p>
<p align="center"><img src="//s0.wp.com/latex.php?latex=Y_%7B1%7D%7C+Y_%7B2%7D+%2C%5Csigma%5E%7B2%7D+%5Csim+N%5Cleft%28++X_%7B1%7D%28+X_%7B2%7D%5E%7BT%7D+X_%7B2%7D%2B%5CLambda%29%5E%7B-1%7D+X_%7B2%7D%5E%7BT%7D+Y_%7B2%7D%2C+%5Csigma%5E%7B2%7D+%28I_%7B1%7D+%2B++X_%7B1%7D+%28+X_%7B2%7D%5E%7BT%7D+X_%7B2%7D%2B%5CLambda%29%5E%7B-1%7D+X_%7B1%7D%5E%7BT%7D%29+%5Cright%29++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="Y_{1}| Y_{2} ,&#92;sigma^{2} &#92;sim N&#92;left(  X_{1}( X_{2}^{T} X_{2}+&#92;Lambda)^{-1} X_{2}^{T} Y_{2}, &#92;sigma^{2} (I_{1} +  X_{1} ( X_{2}^{T} X_{2}+&#92;Lambda)^{-1} X_{1}^{T}) &#92;right)  " title="Y_{1}| Y_{2} ,&#92;sigma^{2} &#92;sim N&#92;left(  X_{1}( X_{2}^{T} X_{2}+&#92;Lambda)^{-1} X_{2}^{T} Y_{2}, &#92;sigma^{2} (I_{1} +  X_{1} ( X_{2}^{T} X_{2}+&#92;Lambda)^{-1} X_{1}^{T}) &#92;right)  " class="latex" /></p>
<p>which looks different from the distribution obtained through method 1. The expression for the variance is a lot neater. They are in fact identical by the Woodbury identity.</p>
<h2>Comparison</h2>
<h3>Mean (Submitted by Michelle Leigh)</h3>
<p align="center"><img src="//s0.wp.com/latex.php?latex=%5Cleft%5B%5CLambda%2B++X_%7B2%7D%5ETI_%7B2%7D+X_%7B2%7D%5Cright%5D%5E%7B-1%7D+X_%7B2%7D%5ET%5C%5C++%3D%5C%7B%5CLambda%5E%7B-1%7D-%5CLambda%5E%7B-1%7D+X_%7B2%7D%5ET%5Cleft%5BI_%7B2%7D%2B++X_%7B2%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5ET%5Cright%5D%5E%7B-1%7D+X_%7B2%7D%5CLambda%5E%7B-1%7D%5C%7D+X_%7B2%7D%5ET%5C%5C++%3D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5ET%5Cleft%5BI_%7B2%7D%2B++X_%7B2%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5ET%5Cright%5D%5E%7B-1%7D%5Cleft%5BI_%7B2%7D%2B++X_%7B2%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5ET%5Cright%5D-%5CLambda%5E%7B-1%7D+X_%7B2%7D%5ET%5Cleft%5BI_%7B2%7D%2B++X_%7B2%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5ET%5Cright%5D%5E%7B-1%7D+X_%7B2%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5ET%5C%5C++%3D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5ET%5Cleft%5BI_%7B2%7D%2B++X_%7B2%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5ET%5Cright%5D%5E%7B-1%7DI_%7B2%7D&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;left[&#92;Lambda+  X_{2}^TI_{2} X_{2}&#92;right]^{-1} X_{2}^T&#92;&#92;  =&#92;{&#92;Lambda^{-1}-&#92;Lambda^{-1} X_{2}^T&#92;left[I_{2}+  X_{2}&#92;Lambda^{-1} X_{2}^T&#92;right]^{-1} X_{2}&#92;Lambda^{-1}&#92;} X_{2}^T&#92;&#92;  =&#92;Lambda^{-1} X_{2}^T&#92;left[I_{2}+  X_{2}&#92;Lambda^{-1} X_{2}^T&#92;right]^{-1}&#92;left[I_{2}+  X_{2}&#92;Lambda^{-1} X_{2}^T&#92;right]-&#92;Lambda^{-1} X_{2}^T&#92;left[I_{2}+  X_{2}&#92;Lambda^{-1} X_{2}^T&#92;right]^{-1} X_{2}&#92;Lambda^{-1} X_{2}^T&#92;&#92;  =&#92;Lambda^{-1} X_{2}^T&#92;left[I_{2}+  X_{2}&#92;Lambda^{-1} X_{2}^T&#92;right]^{-1}I_{2}" title="&#92;left[&#92;Lambda+  X_{2}^TI_{2} X_{2}&#92;right]^{-1} X_{2}^T&#92;&#92;  =&#92;{&#92;Lambda^{-1}-&#92;Lambda^{-1} X_{2}^T&#92;left[I_{2}+  X_{2}&#92;Lambda^{-1} X_{2}^T&#92;right]^{-1} X_{2}&#92;Lambda^{-1}&#92;} X_{2}^T&#92;&#92;  =&#92;Lambda^{-1} X_{2}^T&#92;left[I_{2}+  X_{2}&#92;Lambda^{-1} X_{2}^T&#92;right]^{-1}&#92;left[I_{2}+  X_{2}&#92;Lambda^{-1} X_{2}^T&#92;right]-&#92;Lambda^{-1} X_{2}^T&#92;left[I_{2}+  X_{2}&#92;Lambda^{-1} X_{2}^T&#92;right]^{-1} X_{2}&#92;Lambda^{-1} X_{2}^T&#92;&#92;  =&#92;Lambda^{-1} X_{2}^T&#92;left[I_{2}+  X_{2}&#92;Lambda^{-1} X_{2}^T&#92;right]^{-1}I_{2}" class="latex" /></p>
<p>So mean1=mean2.</p>
<h3>Variance</h3>
<p>By the Woodbury Identity it follows that</p>
<p align="center"><img src="//s0.wp.com/latex.php?latex=%5CLambda%5E%7B-1%7D+-+%5CLambda%5E%7B-1%7D+X_%7B2%7D%5E%7BT%7D+%5Cleft%5B+I_%7B2%7D+%2B++X_%7B2%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5E%7BT%7D+%5Cright%5D%5E%7B-1%7D++X_%7B2%7D%5CLambda%5E%7B-1%7D+%3D+%28+X_%7B2%7D%5E%7BT%7DI_%7B2%7D+X_%7B2%7D%2B%5CLambda%29%5E%7B-1%7D.++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;Lambda^{-1} - &#92;Lambda^{-1} X_{2}^{T} &#92;left[ I_{2} +  X_{2}&#92;Lambda^{-1} X_{2}^{T} &#92;right]^{-1}  X_{2}&#92;Lambda^{-1} = ( X_{2}^{T}I_{2} X_{2}+&#92;Lambda)^{-1}.  " title="&#92;Lambda^{-1} - &#92;Lambda^{-1} X_{2}^{T} &#92;left[ I_{2} +  X_{2}&#92;Lambda^{-1} X_{2}^{T} &#92;right]^{-1}  X_{2}&#92;Lambda^{-1} = ( X_{2}^{T}I_{2} X_{2}+&#92;Lambda)^{-1}.  " class="latex" /></p>
<p>Therefore</p>
<p align="center"><img src="//s0.wp.com/latex.php?latex=X_%7B1%7D%5CLambda%5E%7B-1%7D+X_%7B1%7D%5E%7BT%7D-+X_%7B1%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5E%7BT%7D+%5Cleft%5B+I_%7B2%7D%2B+X_%7B2%7D%5CLambda%5E%7B-1%7D+X_%7B2%7D%5E%7BT%7D+%5Cright%5D%5E%7B-1%7D++X_%7B2%7D%5CLambda%5E%7B-1%7D+X_%7B1%7D%5E%7BT%7D%3D%7B+X_%7B1%7D+%28+X_%7B2%7D%5E%7BT%7D+X_%7B2%7D%2B%5CLambda%29%5E%7B-1%7D+X_%7B1%7D%5E%7BT%7D%7D%5C%5C++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="X_{1}&#92;Lambda^{-1} X_{1}^{T}- X_{1}&#92;Lambda^{-1} X_{2}^{T} &#92;left[ I_{2}+ X_{2}&#92;Lambda^{-1} X_{2}^{T} &#92;right]^{-1}  X_{2}&#92;Lambda^{-1} X_{1}^{T}={ X_{1} ( X_{2}^{T} X_{2}+&#92;Lambda)^{-1} X_{1}^{T}}&#92;&#92;  " title="X_{1}&#92;Lambda^{-1} X_{1}^{T}- X_{1}&#92;Lambda^{-1} X_{2}^{T} &#92;left[ I_{2}+ X_{2}&#92;Lambda^{-1} X_{2}^{T} &#92;right]^{-1}  X_{2}&#92;Lambda^{-1} X_{1}^{T}={ X_{1} ( X_{2}^{T} X_{2}+&#92;Lambda)^{-1} X_{1}^{T}}&#92;&#92;  " class="latex" /></p>
<p>and so variance1=variance2. The trick is recognizing the form of the formulas at the top of the page, then one can write the variance as a much neater expression.</p>
<p>The post <a rel="nofollow" href="http://www.lindonslog.com/mathematics/woodbury-matrix-inverse-multivariate-normal/">Woodbury Matrix Inverse Identity</a> appeared first on <a rel="nofollow" href="http://www.lindonslog.com">Ive Moved</a>.</p>
]]></content:encoded>
			<wfw:commentRss>http://www.lindonslog.com/mathematics/woodbury-matrix-inverse-multivariate-normal/feed/</wfw:commentRss>
		<slash:comments>3</slash:comments>
		</item>
		<item>
		<title>Block Matrix Inverse</title>
		<link>http://www.lindonslog.com/mathematics/block-matrix-inverse/</link>
		<comments>http://www.lindonslog.com/mathematics/block-matrix-inverse/#respond</comments>
		<pubDate>Wed, 15 May 2013 22:40:33 +0000</pubDate>
		<dc:creator><![CDATA[admin]]></dc:creator>
				<category><![CDATA[Linear Algebra]]></category>
		<category><![CDATA[Mathematics]]></category>

		<guid isPermaLink="false">http://www.lindonslog.com/?p=205</guid>
		<description><![CDATA[<p>Previously I wrote a post on the Woodbury matrix inverse formula. One of the results derived was Hence the inverse of a block matrix can be written neatly in one of two ways:</p>
<p>The post <a rel="nofollow" href="http://www.lindonslog.com/mathematics/block-matrix-inverse/">Block Matrix Inverse</a> appeared first on <a rel="nofollow" href="http://www.lindonslog.com">Ive Moved</a>.</p>
]]></description>
				<content:encoded><![CDATA[<p>Previously I wrote a post on the<a href="http://www.lindonslog.com/mathematics/invert-a-matrix-using-the-woodbury-matrix-inverse-formula-identity/"> Woodbury matrix inverse formula</a>. One of the results derived was<br />
<img src="//s0.wp.com/latex.php?latex=%5Cbegin%7Bpmatrix%7D++++++++++V_%7B11%7D+%26+V_%7B12%7D%5C%5C++++++++++V_%7B21%7D+%26+V_%7B22%7D%5C%5C++%5Cend%7Bpmatrix%7D%5E%7B-1%7D++%3D++%5Cbegin%7Bpmatrix%7D++V_%7B11.2%7D%5E%7B-1%7D+%26+-V_%7B11.2%7D%5E%7B-1%7DV_%7B12%7DV_%7B22%7D%5E%7B-1%7D%5C%5C++-V_%7B22%7D%5E%7B-1%7DV_%7B21%7DV_%7B11.2%7D%5E%7B-1%7D+%26+V_%7B22%7D%5E%7B-1%7D%2BV_%7B22%7D%5E%7B-1%7DV_%7B21%7DV_%7B11.2%7D%5E%7B-1%7DV_%7B12%7DV_%7B22%7D%5E%7B-1%7D++%5Cend%7Bpmatrix%7D++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;begin{pmatrix}          V_{11} &amp; V_{12}&#92;&#92;          V_{21} &amp; V_{22}&#92;&#92;  &#92;end{pmatrix}^{-1}  =  &#92;begin{pmatrix}  V_{11.2}^{-1} &amp; -V_{11.2}^{-1}V_{12}V_{22}^{-1}&#92;&#92;  -V_{22}^{-1}V_{21}V_{11.2}^{-1} &amp; V_{22}^{-1}+V_{22}^{-1}V_{21}V_{11.2}^{-1}V_{12}V_{22}^{-1}  &#92;end{pmatrix}  " title="&#92;begin{pmatrix}          V_{11} &amp; V_{12}&#92;&#92;          V_{21} &amp; V_{22}&#92;&#92;  &#92;end{pmatrix}^{-1}  =  &#92;begin{pmatrix}  V_{11.2}^{-1} &amp; -V_{11.2}^{-1}V_{12}V_{22}^{-1}&#92;&#92;  -V_{22}^{-1}V_{21}V_{11.2}^{-1} &amp; V_{22}^{-1}+V_{22}^{-1}V_{21}V_{11.2}^{-1}V_{12}V_{22}^{-1}  &#92;end{pmatrix}  " class="latex" /></p>
<p><img src="//s0.wp.com/latex.php?latex=%5Cbegin%7Bpmatrix%7D++++++++++V_%7B11%7D+%26+V_%7B12%7D%5C%5C++++++++++V_%7B21%7D+%26+V_%7B22%7D%5C%5C++%5Cend%7Bpmatrix%7D%5E%7B-1%7D++%3D%5Cbegin%7Bpmatrix%7D++++++++++V_%7B11%7D%5E%7B-1%7D%2BV_%7B11%7D%5E%7B-1%7DV_%7B12%7DV_%7B22.1%7D%5E%7B-1%7DV_%7B21%7DV_%7B11%7D%5E%7B-1%7D+%26+-V_%7B11%7D%5E%7B-1%7DV_%7B12%7DV_%7B22.1%7D%5E%7B-1%7D%5C%5C++++++++++-V_%7B22.1%7D%5E%7B-1%7DV_%7B21%7DV_%7B11%7D%5E%7B-1%7D+%26+V_%7B22.1%7D%5E%7B-1%7D++%5Cend%7Bpmatrix%7D++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;begin{pmatrix}          V_{11} &amp; V_{12}&#92;&#92;          V_{21} &amp; V_{22}&#92;&#92;  &#92;end{pmatrix}^{-1}  =&#92;begin{pmatrix}          V_{11}^{-1}+V_{11}^{-1}V_{12}V_{22.1}^{-1}V_{21}V_{11}^{-1} &amp; -V_{11}^{-1}V_{12}V_{22.1}^{-1}&#92;&#92;          -V_{22.1}^{-1}V_{21}V_{11}^{-1} &amp; V_{22.1}^{-1}  &#92;end{pmatrix}  " title="&#92;begin{pmatrix}          V_{11} &amp; V_{12}&#92;&#92;          V_{21} &amp; V_{22}&#92;&#92;  &#92;end{pmatrix}^{-1}  =&#92;begin{pmatrix}          V_{11}^{-1}+V_{11}^{-1}V_{12}V_{22.1}^{-1}V_{21}V_{11}^{-1} &amp; -V_{11}^{-1}V_{12}V_{22.1}^{-1}&#92;&#92;          -V_{22.1}^{-1}V_{21}V_{11}^{-1} &amp; V_{22.1}^{-1}  &#92;end{pmatrix}  " class="latex" /></p>
<p>Hence the inverse of a block matrix can be written neatly in one of two ways:<br />
<img src="//s0.wp.com/latex.php?latex=%5Cbegin%7Bpmatrix%7D++++++++++V_%7B11%7D+%26+V_%7B12%7D%5C%5C++++++++++V_%7B21%7D+%26+V_%7B22%7D%5C%5C++%5Cend%7Bpmatrix%7D%5E%7B-1%7D++%3D++%5Cbegin%7Bpmatrix%7D++V_%7B11.2%7D%5E%7B-1%7D+%26+-V_%7B11.2%7D%5E%7B-1%7DV_%7B12%7DV_%7B22%7D%5E%7B-1%7D%5C%5C++-V_%7B22%7D%5E%7B-1%7DV_%7B21%7DV_%7B11.2%7D%5E%7B-1%7D+%26++V_%7B22.1%7D%5E%7B-1%7D++%5Cend%7Bpmatrix%7D++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;begin{pmatrix}          V_{11} &amp; V_{12}&#92;&#92;          V_{21} &amp; V_{22}&#92;&#92;  &#92;end{pmatrix}^{-1}  =  &#92;begin{pmatrix}  V_{11.2}^{-1} &amp; -V_{11.2}^{-1}V_{12}V_{22}^{-1}&#92;&#92;  -V_{22}^{-1}V_{21}V_{11.2}^{-1} &amp;  V_{22.1}^{-1}  &#92;end{pmatrix}  " title="&#92;begin{pmatrix}          V_{11} &amp; V_{12}&#92;&#92;          V_{21} &amp; V_{22}&#92;&#92;  &#92;end{pmatrix}^{-1}  =  &#92;begin{pmatrix}  V_{11.2}^{-1} &amp; -V_{11.2}^{-1}V_{12}V_{22}^{-1}&#92;&#92;  -V_{22}^{-1}V_{21}V_{11.2}^{-1} &amp;  V_{22.1}^{-1}  &#92;end{pmatrix}  " class="latex" /></p>
<p><img src="//s0.wp.com/latex.php?latex=%5Cbegin%7Bpmatrix%7D++++++++++V_%7B11%7D+%26+V_%7B12%7D%5C%5C++++++++++V_%7B21%7D+%26+V_%7B22%7D%5C%5C++%5Cend%7Bpmatrix%7D%5E%7B-1%7D++%3D%5Cbegin%7Bpmatrix%7D++++++++++V_%7B11.2%7D%5E%7B-1%7D+%26+-V_%7B11%7D%5E%7B-1%7DV_%7B12%7DV_%7B22.1%7D%5E%7B-1%7D%5C%5C++++++++++-V_%7B22.1%7D%5E%7B-1%7DV_%7B21%7DV_%7B11%7D%5E%7B-1%7D+%26+V_%7B22.1%7D%5E%7B-1%7D++%5Cend%7Bpmatrix%7D++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;begin{pmatrix}          V_{11} &amp; V_{12}&#92;&#92;          V_{21} &amp; V_{22}&#92;&#92;  &#92;end{pmatrix}^{-1}  =&#92;begin{pmatrix}          V_{11.2}^{-1} &amp; -V_{11}^{-1}V_{12}V_{22.1}^{-1}&#92;&#92;          -V_{22.1}^{-1}V_{21}V_{11}^{-1} &amp; V_{22.1}^{-1}  &#92;end{pmatrix}  " title="&#92;begin{pmatrix}          V_{11} &amp; V_{12}&#92;&#92;          V_{21} &amp; V_{22}&#92;&#92;  &#92;end{pmatrix}^{-1}  =&#92;begin{pmatrix}          V_{11.2}^{-1} &amp; -V_{11}^{-1}V_{12}V_{22.1}^{-1}&#92;&#92;          -V_{22.1}^{-1}V_{21}V_{11}^{-1} &amp; V_{22.1}^{-1}  &#92;end{pmatrix}  " class="latex" /></p>
<p>The post <a rel="nofollow" href="http://www.lindonslog.com/mathematics/block-matrix-inverse/">Block Matrix Inverse</a> appeared first on <a rel="nofollow" href="http://www.lindonslog.com">Ive Moved</a>.</p>
]]></content:encoded>
			<wfw:commentRss>http://www.lindonslog.com/mathematics/block-matrix-inverse/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>Invert a Matrix using the Woodbury Matrix Inverse Formula Identity</title>
		<link>http://www.lindonslog.com/mathematics/invert-a-matrix-using-the-woodbury-matrix-inverse-formula-identity/</link>
		<comments>http://www.lindonslog.com/mathematics/invert-a-matrix-using-the-woodbury-matrix-inverse-formula-identity/#respond</comments>
		<pubDate>Wed, 15 May 2013 21:39:59 +0000</pubDate>
		<dc:creator><![CDATA[admin]]></dc:creator>
				<category><![CDATA[Linear Algebra]]></category>
		<category><![CDATA[Mathematics]]></category>

		<guid isPermaLink="false">http://www.lindonslog.com/?p=189</guid>
		<description><![CDATA[<p>Previously I wrote about the LDU decomposition and the Schur complement. These can be further used to derive the Sherman–Morrison–Woodbury formula, otherwise known as the matrix inversion lemma, for inverting a matrix. As shown in the previous post, a UDL and LDU are two ways of factorizing a matrix: Now consider taking the inverse of [&#8230;]</p>
<p>The post <a rel="nofollow" href="http://www.lindonslog.com/mathematics/invert-a-matrix-using-the-woodbury-matrix-inverse-formula-identity/">Invert a Matrix using the Woodbury Matrix Inverse Formula Identity</a> appeared first on <a rel="nofollow" href="http://www.lindonslog.com">Ive Moved</a>.</p>
]]></description>
				<content:encoded><![CDATA[<p>Previously I wrote about the <a href="http://www.lindonslog.com/mathematics/diagonalize-positive-definite-symmetric-matrix-schur-complement-ldu-decomposition/" target="_blank">LDU decomposition and the Schur complement</a>. These can be further used to derive the  Sherman–Morrison–Woodbury formula, otherwise known as the matrix inversion lemma, for inverting a matrix. As shown in the previous post, a UDL and LDU are two ways of factorizing a matrix:</p>
<p><img src="//s0.wp.com/latex.php?latex=%5Cbegin%7Bpmatrix%7D++++++++++V_%7B11%7D+%26+V_%7B12%7D%5C%5C++++++++++V_%7B21%7D+%26+V_%7B22%7D%5C%5C++%5Cend%7Bpmatrix%7D%3D++++%5Cbegin%7Bpmatrix%7D++++++++++1+%26++++V_%7B12%7DV_%7B22%7D%5E%7B-1%7D%5C%5C++0++++++%26+1%5C%5C++%5Cend%7Bpmatrix%7D++%5Cbegin%7Bpmatrix%7D+++++++++++V_%7B11.2%7D+%26+0+%5C%5C+++++++++++0+%26+V_%7B22%7D+%5C%5C+++%5Cend%7Bpmatrix%7D+++%5Cbegin%7Bpmatrix%7D++++++++++++1+%26+0+%5C%5C++V_%7B22%7D%5E%7B-1%7DV_%7B21%7D+%26+1+%5C%5C++%5Cend%7Bpmatrix%7D++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;begin{pmatrix}          V_{11} &amp; V_{12}&#92;&#92;          V_{21} &amp; V_{22}&#92;&#92;  &#92;end{pmatrix}=    &#92;begin{pmatrix}          1 &amp;    V_{12}V_{22}^{-1}&#92;&#92;  0      &amp; 1&#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}           V_{11.2} &amp; 0 &#92;&#92;           0 &amp; V_{22} &#92;&#92;   &#92;end{pmatrix}   &#92;begin{pmatrix}            1 &amp; 0 &#92;&#92;  V_{22}^{-1}V_{21} &amp; 1 &#92;&#92;  &#92;end{pmatrix}  " title="&#92;begin{pmatrix}          V_{11} &amp; V_{12}&#92;&#92;          V_{21} &amp; V_{22}&#92;&#92;  &#92;end{pmatrix}=    &#92;begin{pmatrix}          1 &amp;    V_{12}V_{22}^{-1}&#92;&#92;  0      &amp; 1&#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}           V_{11.2} &amp; 0 &#92;&#92;           0 &amp; V_{22} &#92;&#92;   &#92;end{pmatrix}   &#92;begin{pmatrix}            1 &amp; 0 &#92;&#92;  V_{22}^{-1}V_{21} &amp; 1 &#92;&#92;  &#92;end{pmatrix}  " class="latex" /></p>
<p><img src="//s0.wp.com/latex.php?latex=%5Cbegin%7Bpmatrix%7D++++++++++V_%7B11%7D+%26+V_%7B12%7D%5C%5C++++++++++V_%7B21%7D+%26+V_%7B22%7D%5C%5C++%5Cend%7Bpmatrix%7D++++%3D++%5Cbegin%7Bpmatrix%7D++++++++++1+%26+0%5C%5C++++++++++V_%7B21%7DV_%7B11%7D%5E%7B-1%7D+%26+1%5C%5C++%5Cend%7Bpmatrix%7D++%5Cbegin%7Bpmatrix%7D++++++++++++V_%7B11%7D+%26+0+%5C%5C++0+%26+V_%7B22.1%7D+%5C%5C++%5Cend%7Bpmatrix%7D++%5Cbegin%7Bpmatrix%7D++++++++++++1+%26+V_%7B11%7D%5E%7B-1%7DV_%7B12%7D+%5C%5C++0+%26+1+%5C%5C++%5Cend%7Bpmatrix%7D++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;begin{pmatrix}          V_{11} &amp; V_{12}&#92;&#92;          V_{21} &amp; V_{22}&#92;&#92;  &#92;end{pmatrix}    =  &#92;begin{pmatrix}          1 &amp; 0&#92;&#92;          V_{21}V_{11}^{-1} &amp; 1&#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}            V_{11} &amp; 0 &#92;&#92;  0 &amp; V_{22.1} &#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}            1 &amp; V_{11}^{-1}V_{12} &#92;&#92;  0 &amp; 1 &#92;&#92;  &#92;end{pmatrix}  " title="&#92;begin{pmatrix}          V_{11} &amp; V_{12}&#92;&#92;          V_{21} &amp; V_{22}&#92;&#92;  &#92;end{pmatrix}    =  &#92;begin{pmatrix}          1 &amp; 0&#92;&#92;          V_{21}V_{11}^{-1} &amp; 1&#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}            V_{11} &amp; 0 &#92;&#92;  0 &amp; V_{22.1} &#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}            1 &amp; V_{11}^{-1}V_{12} &#92;&#92;  0 &amp; 1 &#92;&#92;  &#92;end{pmatrix}  " class="latex" /><br />
Now consider taking the inverse of the matrices above, yielding</p>
<p><img src="//s0.wp.com/latex.php?latex=%5Cbegin%7Bpmatrix%7D++++++++++V_%7B11%7D+%26+V_%7B12%7D%5C%5C++++++++++V_%7B21%7D+%26+V_%7B22%7D%5C%5C++%5Cend%7Bpmatrix%7D%5E%7B-1%7D%3D++%5Cbegin%7Bpmatrix%7D++1+%26+0+%5C%5C++-V_%7B22%7D%5E%7B-1%7DV_%7B21%7D+%26+1+%5C%5C++%5Cend%7Bpmatrix%7D++++++%5Cbegin%7Bpmatrix%7D+++++++++++V_%7B11.2%7D%5E%7B-1%7D+%26+0+%5C%5C+++++++++++0+%26+V_%7B22%7D%5E%7B-1%7D+%5C%5C+++%5Cend%7Bpmatrix%7D+++%5Cbegin%7Bpmatrix%7D++++++++++1+%26+++-V_%7B12%7DV_%7B22%7D%5E%7B-1%7D%5C%5C++0++++++%26+1%5C%5C++%5Cend%7Bpmatrix%7D++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;begin{pmatrix}          V_{11} &amp; V_{12}&#92;&#92;          V_{21} &amp; V_{22}&#92;&#92;  &#92;end{pmatrix}^{-1}=  &#92;begin{pmatrix}  1 &amp; 0 &#92;&#92;  -V_{22}^{-1}V_{21} &amp; 1 &#92;&#92;  &#92;end{pmatrix}      &#92;begin{pmatrix}           V_{11.2}^{-1} &amp; 0 &#92;&#92;           0 &amp; V_{22}^{-1} &#92;&#92;   &#92;end{pmatrix}   &#92;begin{pmatrix}          1 &amp;   -V_{12}V_{22}^{-1}&#92;&#92;  0      &amp; 1&#92;&#92;  &#92;end{pmatrix}  " title="&#92;begin{pmatrix}          V_{11} &amp; V_{12}&#92;&#92;          V_{21} &amp; V_{22}&#92;&#92;  &#92;end{pmatrix}^{-1}=  &#92;begin{pmatrix}  1 &amp; 0 &#92;&#92;  -V_{22}^{-1}V_{21} &amp; 1 &#92;&#92;  &#92;end{pmatrix}      &#92;begin{pmatrix}           V_{11.2}^{-1} &amp; 0 &#92;&#92;           0 &amp; V_{22}^{-1} &#92;&#92;   &#92;end{pmatrix}   &#92;begin{pmatrix}          1 &amp;   -V_{12}V_{22}^{-1}&#92;&#92;  0      &amp; 1&#92;&#92;  &#92;end{pmatrix}  " class="latex" /></p>
<p><img src="//s0.wp.com/latex.php?latex=%5Cbegin%7Bpmatrix%7D++++++++++V_%7B11%7D+%26+V_%7B12%7D%5C%5C++++++++++V_%7B21%7D+%26+V_%7B22%7D%5C%5C++%5Cend%7Bpmatrix%7D%5E%7B-1%7D++%3D++%5Cbegin%7Bpmatrix%7D++1+%26+-V_%7B11%7D%5E%7B-1%7DV_%7B12%7D+%5C%5C++0+%26+1+%5C%5C++%5Cend%7Bpmatrix%7D++%5Cbegin%7Bpmatrix%7D++++++V_%7B11%7D%5E%7B-1%7D+%26+0+%5C%5C++0+%26+V_%7B22.1%7D%5E%7B-1%7D+%5C%5C++%5Cend%7Bpmatrix%7D++++%5Cbegin%7Bpmatrix%7D++++++++++1+%26+0%5C%5C++++++++++-V_%7B21%7DV_%7B11%7D%5E%7B-1%7D+%26+1%5C%5C++%5Cend%7Bpmatrix%7D++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;begin{pmatrix}          V_{11} &amp; V_{12}&#92;&#92;          V_{21} &amp; V_{22}&#92;&#92;  &#92;end{pmatrix}^{-1}  =  &#92;begin{pmatrix}  1 &amp; -V_{11}^{-1}V_{12} &#92;&#92;  0 &amp; 1 &#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}      V_{11}^{-1} &amp; 0 &#92;&#92;  0 &amp; V_{22.1}^{-1} &#92;&#92;  &#92;end{pmatrix}    &#92;begin{pmatrix}          1 &amp; 0&#92;&#92;          -V_{21}V_{11}^{-1} &amp; 1&#92;&#92;  &#92;end{pmatrix}  " title="&#92;begin{pmatrix}          V_{11} &amp; V_{12}&#92;&#92;          V_{21} &amp; V_{22}&#92;&#92;  &#92;end{pmatrix}^{-1}  =  &#92;begin{pmatrix}  1 &amp; -V_{11}^{-1}V_{12} &#92;&#92;  0 &amp; 1 &#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}      V_{11}^{-1} &amp; 0 &#92;&#92;  0 &amp; V_{22.1}^{-1} &#92;&#92;  &#92;end{pmatrix}    &#92;begin{pmatrix}          1 &amp; 0&#92;&#92;          -V_{21}V_{11}^{-1} &amp; 1&#92;&#92;  &#92;end{pmatrix}  " class="latex" /><br />
Multiplying the matrices on the RHS yields<br />
<img src="//s0.wp.com/latex.php?latex=%5Cbegin%7Bpmatrix%7D++++++++++V_%7B11%7D+%26+V_%7B12%7D%5C%5C++++++++++V_%7B21%7D+%26+V_%7B22%7D%5C%5C++%5Cend%7Bpmatrix%7D%5E%7B-1%7D++%3D++%5Cbegin%7Bpmatrix%7D++V_%7B11.2%7D%5E%7B-1%7D+%26+-V_%7B11.2%7D%5E%7B-1%7DV_%7B12%7DV_%7B22%7D%5E%7B-1%7D%5C%5C++-V_%7B22%7D%5E%7B-1%7DV_%7B21%7DV_%7B11.2%7D%5E%7B-1%7D+%26+V_%7B22%7D%5E%7B-1%7D%2BV_%7B22%7D%5E%7B-1%7DV_%7B21%7DV_%7B11.2%7D%5E%7B-1%7DV_%7B12%7DV_%7B22%7D%5E%7B-1%7D++%5Cend%7Bpmatrix%7D++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;begin{pmatrix}          V_{11} &amp; V_{12}&#92;&#92;          V_{21} &amp; V_{22}&#92;&#92;  &#92;end{pmatrix}^{-1}  =  &#92;begin{pmatrix}  V_{11.2}^{-1} &amp; -V_{11.2}^{-1}V_{12}V_{22}^{-1}&#92;&#92;  -V_{22}^{-1}V_{21}V_{11.2}^{-1} &amp; V_{22}^{-1}+V_{22}^{-1}V_{21}V_{11.2}^{-1}V_{12}V_{22}^{-1}  &#92;end{pmatrix}  " title="&#92;begin{pmatrix}          V_{11} &amp; V_{12}&#92;&#92;          V_{21} &amp; V_{22}&#92;&#92;  &#92;end{pmatrix}^{-1}  =  &#92;begin{pmatrix}  V_{11.2}^{-1} &amp; -V_{11.2}^{-1}V_{12}V_{22}^{-1}&#92;&#92;  -V_{22}^{-1}V_{21}V_{11.2}^{-1} &amp; V_{22}^{-1}+V_{22}^{-1}V_{21}V_{11.2}^{-1}V_{12}V_{22}^{-1}  &#92;end{pmatrix}  " class="latex" /></p>
<p><img src="//s0.wp.com/latex.php?latex=%5Cbegin%7Bpmatrix%7D++++++++++V_%7B11%7D+%26+V_%7B12%7D%5C%5C++++++++++V_%7B21%7D+%26+V_%7B22%7D%5C%5C++%5Cend%7Bpmatrix%7D%5E%7B-1%7D++%3D%5Cbegin%7Bpmatrix%7D++++++++++V_%7B11%7D%5E%7B-1%7D%2BV_%7B11%7D%5E%7B-1%7DV_%7B12%7DV_%7B22.1%7D%5E%7B-1%7DV_%7B21%7DV_%7B11%7D%5E%7B-1%7D+%26+-V_%7B11%7D%5E%7B-1%7DV_%7B12%7DV_%7B22.1%7D%5E%7B-1%7D%5C%5C++++++++++-V_%7B22.1%7D%5E%7B-1%7DV_%7B21%7DV_%7B11%7D%5E%7B-1%7D+%26+V_%7B22.1%7D%5E%7B-1%7D++%5Cend%7Bpmatrix%7D++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;begin{pmatrix}          V_{11} &amp; V_{12}&#92;&#92;          V_{21} &amp; V_{22}&#92;&#92;  &#92;end{pmatrix}^{-1}  =&#92;begin{pmatrix}          V_{11}^{-1}+V_{11}^{-1}V_{12}V_{22.1}^{-1}V_{21}V_{11}^{-1} &amp; -V_{11}^{-1}V_{12}V_{22.1}^{-1}&#92;&#92;          -V_{22.1}^{-1}V_{21}V_{11}^{-1} &amp; V_{22.1}^{-1}  &#92;end{pmatrix}  " title="&#92;begin{pmatrix}          V_{11} &amp; V_{12}&#92;&#92;          V_{21} &amp; V_{22}&#92;&#92;  &#92;end{pmatrix}^{-1}  =&#92;begin{pmatrix}          V_{11}^{-1}+V_{11}^{-1}V_{12}V_{22.1}^{-1}V_{21}V_{11}^{-1} &amp; -V_{11}^{-1}V_{12}V_{22.1}^{-1}&#92;&#92;          -V_{22.1}^{-1}V_{21}V_{11}^{-1} &amp; V_{22.1}^{-1}  &#92;end{pmatrix}  " class="latex" /><br />
These two results can be used to form neat expressions for the <a href="http://www.lindonslog.com/mathematics/block-matrix-inverse/" title="Block Matrix Inverse">inverse of a partitioned block matrix</a>. It follows that<br />
<img src="//s0.wp.com/latex.php?latex=%5Cbegin%7Bpmatrix%7D++V_%7B11.2%7D%5E%7B-1%7D+%26+-V_%7B11.2%7D%5E%7B-1%7DV_%7B12%7DV_%7B22%7D%5E%7B-1%7D%5C%5C++-V_%7B22%7D%5E%7B-1%7DV_%7B21%7DV_%7B11.2%7D%5E%7B-1%7D+%26+V_%7B22%7D%5E%7B-1%7D%2BV_%7B22%7D%5E%7B-1%7DV_%7B21%7DV_%7B11.2%7D%5E%7B-1%7DV_%7B12%7DV_%7B22%7D%5E%7B-1%7D++%5Cend%7Bpmatrix%7D%3D++%5Cbegin%7Bpmatrix%7D++++++++++V_%7B11%7D%5E%7B-1%7D%2BV_%7B11%7D%5E%7B-1%7DV_%7B12%7DV_%7B22.1%7D%5E%7B-1%7DV_%7B21%7DV_%7B11%7D%5E%7B-1%7D+%26+-V_%7B11%7D%5E%7B-1%7DV_%7B12%7DV_%7B22.1%7D%5E%7B-1%7D%5C%5C++++++++++-V_%7B22.1%7D%5E%7B-1%7DV_%7B21%7DV_%7B11%7D%5E%7B-1%7D+%26+V_%7B22.1%7D%5E%7B-1%7D++%5Cend%7Bpmatrix%7D++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;begin{pmatrix}  V_{11.2}^{-1} &amp; -V_{11.2}^{-1}V_{12}V_{22}^{-1}&#92;&#92;  -V_{22}^{-1}V_{21}V_{11.2}^{-1} &amp; V_{22}^{-1}+V_{22}^{-1}V_{21}V_{11.2}^{-1}V_{12}V_{22}^{-1}  &#92;end{pmatrix}=  &#92;begin{pmatrix}          V_{11}^{-1}+V_{11}^{-1}V_{12}V_{22.1}^{-1}V_{21}V_{11}^{-1} &amp; -V_{11}^{-1}V_{12}V_{22.1}^{-1}&#92;&#92;          -V_{22.1}^{-1}V_{21}V_{11}^{-1} &amp; V_{22.1}^{-1}  &#92;end{pmatrix}  " title="&#92;begin{pmatrix}  V_{11.2}^{-1} &amp; -V_{11.2}^{-1}V_{12}V_{22}^{-1}&#92;&#92;  -V_{22}^{-1}V_{21}V_{11.2}^{-1} &amp; V_{22}^{-1}+V_{22}^{-1}V_{21}V_{11.2}^{-1}V_{12}V_{22}^{-1}  &#92;end{pmatrix}=  &#92;begin{pmatrix}          V_{11}^{-1}+V_{11}^{-1}V_{12}V_{22.1}^{-1}V_{21}V_{11}^{-1} &amp; -V_{11}^{-1}V_{12}V_{22.1}^{-1}&#92;&#92;          -V_{22.1}^{-1}V_{21}V_{11}^{-1} &amp; V_{22.1}^{-1}  &#92;end{pmatrix}  " class="latex" /><br />
The equality holds for each block or element, so two expressions can be found for the Woodbury matrix inverse formula, namely:<br />
<img src="//s0.wp.com/latex.php?latex=V_%7B11.2%7D%5E%7B-1%7D%3DV_%7B11%7D%5E%7B-1%7D%2BV_%7B11%7D%5E%7B-1%7DV_%7B12%7DV_%7B22.1%7D%5E%7B-1%7DV_%7B21%7DV_%7B11%7D%5E%7B-1%7D++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="V_{11.2}^{-1}=V_{11}^{-1}+V_{11}^{-1}V_{12}V_{22.1}^{-1}V_{21}V_{11}^{-1}  " title="V_{11.2}^{-1}=V_{11}^{-1}+V_{11}^{-1}V_{12}V_{22.1}^{-1}V_{21}V_{11}^{-1}  " class="latex" /><br />
and<br />
<img src="//s0.wp.com/latex.php?latex=V_%7B22.1%7D%5E%7B-1%7D%3DV_%7B22%7D%5E%7B-1%7D%2BV_%7B22%7D%5E%7B-1%7DV_%7B21%7DV_%7B11.2%7D%5E%7B-1%7DV_%7B12%7DV_%7B22%7D%5E%7B-1%7D++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="V_{22.1}^{-1}=V_{22}^{-1}+V_{22}^{-1}V_{21}V_{11.2}^{-1}V_{12}V_{22}^{-1}  " title="V_{22.1}^{-1}=V_{22}^{-1}+V_{22}^{-1}V_{21}V_{11.2}^{-1}V_{12}V_{22}^{-1}  " class="latex" /><br />
where the dot notation corresponds to the Schur complement i.e.<br />
<img src="//s0.wp.com/latex.php?latex=V_%7B11.2%7D%3DV_%7B11%7D-V_%7B12%7DV_%7B22%7D%5E%7B-1%7DV_%7B21%7D%5C%5C++V_%7B22.1%7D%3DV_%7B22%7D-V_%7B21%7DV_%7B11%7D%5E%7B-1%7DV_%7B12%7D%5C%5C++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="V_{11.2}=V_{11}-V_{12}V_{22}^{-1}V_{21}&#92;&#92;  V_{22.1}=V_{22}-V_{21}V_{11}^{-1}V_{12}&#92;&#92;  " title="V_{11.2}=V_{11}-V_{12}V_{22}^{-1}V_{21}&#92;&#92;  V_{22.1}=V_{22}-V_{21}V_{11}^{-1}V_{12}&#92;&#92;  " class="latex" /><br />
An application of the Woodbury matrix inverse can be found in deriving <a href="http://www.lindonslog.com/mathematics/woodbury-matrix-inverse-multivariate-normal/" title="Woodbury Matrix Inverse">conditional distributions</a> for multivariate normals.</p>
<p>The post <a rel="nofollow" href="http://www.lindonslog.com/mathematics/invert-a-matrix-using-the-woodbury-matrix-inverse-formula-identity/">Invert a Matrix using the Woodbury Matrix Inverse Formula Identity</a> appeared first on <a rel="nofollow" href="http://www.lindonslog.com">Ive Moved</a>.</p>
]]></content:encoded>
			<wfw:commentRss>http://www.lindonslog.com/mathematics/invert-a-matrix-using-the-woodbury-matrix-inverse-formula-identity/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>Diagonalize a Positive-Definite Symmetric Matrix using the Schur Complement and LDU Decomposition</title>
		<link>http://www.lindonslog.com/mathematics/diagonalize-positive-definite-symmetric-matrix-schur-complement-ldu-decomposition/</link>
		<comments>http://www.lindonslog.com/mathematics/diagonalize-positive-definite-symmetric-matrix-schur-complement-ldu-decomposition/#respond</comments>
		<pubDate>Wed, 15 May 2013 19:49:35 +0000</pubDate>
		<dc:creator><![CDATA[admin]]></dc:creator>
				<category><![CDATA[Linear Algebra]]></category>
		<category><![CDATA[Mathematics]]></category>

		<guid isPermaLink="false">http://www.lindonslog.com/?p=165</guid>
		<description><![CDATA[<p>Diagonalizing a matrix comes up frequently for me when wanting to diagonalize the variance matrix of a multivariate normal to derive conditional distributions. I prefer to proceed by doing an LDU Decomposition and leaving it in terms of the Schur complement as I find it easier to remember. Consider some matrix V and partition it [&#8230;]</p>
<p>The post <a rel="nofollow" href="http://www.lindonslog.com/mathematics/diagonalize-positive-definite-symmetric-matrix-schur-complement-ldu-decomposition/">Diagonalize a Positive-Definite Symmetric Matrix using the Schur Complement and LDU Decomposition</a> appeared first on <a rel="nofollow" href="http://www.lindonslog.com">Ive Moved</a>.</p>
]]></description>
				<content:encoded><![CDATA[<p>Diagonalizing a matrix comes up frequently for me when wanting to diagonalize the variance matrix of a <a href="http://www.lindonslog.com/mathematics/multivariate-normal-conditional-distribution/" title="Multivariate Normal Conditional Distribution">multivariate normal to derive conditional distributions</a>. I prefer to proceed by doing an LDU Decomposition and leaving it in terms of the Schur complement as I find it easier to remember. Consider some matrix V and partition it as follows<br />
<img src="//s0.wp.com/latex.php?latex=%5Cbegin%7Bpmatrix%7D++++++++++V_%7B11%7D+%26+V_%7B12%7D%5C%5C++++++++++V_%7B21%7D+%26+V_%7B22%7D%5C%5C++%5Cend%7Bpmatrix%7D%3DV++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;begin{pmatrix}          V_{11} &amp; V_{12}&#92;&#92;          V_{21} &amp; V_{22}&#92;&#92;  &#92;end{pmatrix}=V  " title="&#92;begin{pmatrix}          V_{11} &amp; V_{12}&#92;&#92;          V_{21} &amp; V_{22}&#92;&#92;  &#92;end{pmatrix}=V  " class="latex" /><br />
Consider right and left multiplying this matrix by<br />
<img src="//s0.wp.com/latex.php?latex=%5Cbegin%7Bpmatrix%7D++++++++++1+%26+-V_%7B12%7DV_%7B22%7D%5E%7B-1%7D%5C%5C++++++++++0+%26+1%5C%5C++%5Cend%7Bpmatrix%7D++++%5Cbegin%7Bpmatrix%7D++++++++++V_%7B11%7D+%26+V_%7B12%7D%5C%5C++++++++++V_%7B21%7D+%26+V_%7B22%7D%5C%5C++%5Cend%7Bpmatrix%7D++%5Cbegin%7Bpmatrix%7D++++++++++++1+%26+0+%5C%5C++-V_%7B22%7D%5E%7B-1%7DV_%7B21%7D+%26+1+%5C%5C++%5Cend%7Bpmatrix%7D++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;begin{pmatrix}          1 &amp; -V_{12}V_{22}^{-1}&#92;&#92;          0 &amp; 1&#92;&#92;  &#92;end{pmatrix}    &#92;begin{pmatrix}          V_{11} &amp; V_{12}&#92;&#92;          V_{21} &amp; V_{22}&#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}            1 &amp; 0 &#92;&#92;  -V_{22}^{-1}V_{21} &amp; 1 &#92;&#92;  &#92;end{pmatrix}  " title="&#92;begin{pmatrix}          1 &amp; -V_{12}V_{22}^{-1}&#92;&#92;          0 &amp; 1&#92;&#92;  &#92;end{pmatrix}    &#92;begin{pmatrix}          V_{11} &amp; V_{12}&#92;&#92;          V_{21} &amp; V_{22}&#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}            1 &amp; 0 &#92;&#92;  -V_{22}^{-1}V_{21} &amp; 1 &#92;&#92;  &#92;end{pmatrix}  " class="latex" /><br />
The matrices really correspond to the L and U matrices in the LDU decomposition, noting that the matrix on the right or left is just the transpose of the other. Define the Schur complement of the matrix V with respect to the block V22 as<br />
<img src="//s0.wp.com/latex.php?latex=V_%7B11.2%7D%3DV_%7B11%7D-V_%7B12%7DV_%7B22%7D%5E%7B-1%7DV_%7B21%7D++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="V_{11.2}=V_{11}-V_{12}V_{22}^{-1}V_{21}  " title="V_{11.2}=V_{11}-V_{12}V_{22}^{-1}V_{21}  " class="latex" /><br />
then working through the above multiplication it follows that<br />
<img src="//s0.wp.com/latex.php?latex=%5Cbegin%7Bpmatrix%7D++++++++++1+%26+-V_%7B12%7DV_%7B22%7D%5E%7B-1%7D%5C%5C++++++++++0+%26+1%5C%5C++%5Cend%7Bpmatrix%7D++++%5Cbegin%7Bpmatrix%7D++++++++++V_%7B11%7D+%26+V_%7B12%7D%5C%5C++++++++++V_%7B21%7D+%26+V_%7B22%7D%5C%5C++%5Cend%7Bpmatrix%7D++%5Cbegin%7Bpmatrix%7D++++++++++++1+%26+0+%5C%5C++-V_%7B22%7D%5E%7B-1%7DV_%7B21%7D+%26+1+%5C%5C++%5Cend%7Bpmatrix%7D++%3D++%5Cbegin%7Bpmatrix%7D+++++++++++V_%7B11.2%7D+%26+0+%5C%5C+++++++++++0+%26+V_%7B22%7D+%5C%5C+++%5Cend%7Bpmatrix%7D+++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;begin{pmatrix}          1 &amp; -V_{12}V_{22}^{-1}&#92;&#92;          0 &amp; 1&#92;&#92;  &#92;end{pmatrix}    &#92;begin{pmatrix}          V_{11} &amp; V_{12}&#92;&#92;          V_{21} &amp; V_{22}&#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}            1 &amp; 0 &#92;&#92;  -V_{22}^{-1}V_{21} &amp; 1 &#92;&#92;  &#92;end{pmatrix}  =  &#92;begin{pmatrix}           V_{11.2} &amp; 0 &#92;&#92;           0 &amp; V_{22} &#92;&#92;   &#92;end{pmatrix}   " title="&#92;begin{pmatrix}          1 &amp; -V_{12}V_{22}^{-1}&#92;&#92;          0 &amp; 1&#92;&#92;  &#92;end{pmatrix}    &#92;begin{pmatrix}          V_{11} &amp; V_{12}&#92;&#92;          V_{21} &amp; V_{22}&#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}            1 &amp; 0 &#92;&#92;  -V_{22}^{-1}V_{21} &amp; 1 &#92;&#92;  &#92;end{pmatrix}  =  &#92;begin{pmatrix}           V_{11.2} &amp; 0 &#92;&#92;           0 &amp; V_{22} &#92;&#92;   &#92;end{pmatrix}   " class="latex" /><br />
This result is useful in deriving the <a href="http://www.lindonslog.com/mathematics/invert-a-matrix-using-the-woodbury-matrix-inverse-formula-identity/">Sherman–Morrison–Woodbury matrix inverse formula/identity</a>, otherwise known as the matrix inversion lemma.<br />
One can now simply multiply the above equation by the corresponding inverse matrices to obtain the LDU decomposition of the matrix V. The inverse matrices are easy </p>
<p><img src="//s0.wp.com/latex.php?latex=%5Cbegin%7Bpmatrix%7D++++++++++1+%26+V_%7B12%7DV_%7B22%7D%5E%7B-1%7D%5C%5C++++++++++0+%26+1%5C%5C++%5Cend%7Bpmatrix%7D++%5Cbegin%7Bpmatrix%7D++++++++++1+%26+-V_%7B12%7DV_%7B22%7D%5E%7B-1%7D%5C%5C++++++++++0+%26+1%5C%5C++%5Cend%7Bpmatrix%7D++++%5Cbegin%7Bpmatrix%7D++++++++++V_%7B11%7D+%26+V_%7B12%7D%5C%5C++++++++++V_%7B21%7D+%26+V_%7B22%7D%5C%5C++%5Cend%7Bpmatrix%7D++%5Cbegin%7Bpmatrix%7D+++1+%26+0+%5C%5C++-V_%7B22%7D%5E%7B-1%7DV_%7B21%7D+%26+1+%5C%5C++%5Cend%7Bpmatrix%7D++%5Cbegin%7Bpmatrix%7D++++++++++++1+%26+0+%5C%5C++V_%7B22%7D%5E%7B-1%7DV_%7B21%7D+%26+1+%5C%5C++%5Cend%7Bpmatrix%7D++%3D++%5Cbegin%7Bpmatrix%7D++++++++++1+%26+++++V_%7B12%7DV_%7B22%7D%5E%7B-1%7D+%5C%5C++++++0+%26+1%5C%5C++%5Cend%7Bpmatrix%7D++%5Cbegin%7Bpmatrix%7D+++++++++++V_%7B11.2%7D+%26+0+%5C%5C+++++++++++0+%26+V_%7B22%7D+%5C%5C+++%5Cend%7Bpmatrix%7D+++%5Cbegin%7Bpmatrix%7D++++++++++++1+%26+0+%5C%5C++V_%7B22%7D%5E%7B-1%7DV_%7B21%7D+%26+1+%5C%5C++%5Cend%7Bpmatrix%7D++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;begin{pmatrix}          1 &amp; V_{12}V_{22}^{-1}&#92;&#92;          0 &amp; 1&#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}          1 &amp; -V_{12}V_{22}^{-1}&#92;&#92;          0 &amp; 1&#92;&#92;  &#92;end{pmatrix}    &#92;begin{pmatrix}          V_{11} &amp; V_{12}&#92;&#92;          V_{21} &amp; V_{22}&#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}   1 &amp; 0 &#92;&#92;  -V_{22}^{-1}V_{21} &amp; 1 &#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}            1 &amp; 0 &#92;&#92;  V_{22}^{-1}V_{21} &amp; 1 &#92;&#92;  &#92;end{pmatrix}  =  &#92;begin{pmatrix}          1 &amp;     V_{12}V_{22}^{-1} &#92;&#92;      0 &amp; 1&#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}           V_{11.2} &amp; 0 &#92;&#92;           0 &amp; V_{22} &#92;&#92;   &#92;end{pmatrix}   &#92;begin{pmatrix}            1 &amp; 0 &#92;&#92;  V_{22}^{-1}V_{21} &amp; 1 &#92;&#92;  &#92;end{pmatrix}  " title="&#92;begin{pmatrix}          1 &amp; V_{12}V_{22}^{-1}&#92;&#92;          0 &amp; 1&#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}          1 &amp; -V_{12}V_{22}^{-1}&#92;&#92;          0 &amp; 1&#92;&#92;  &#92;end{pmatrix}    &#92;begin{pmatrix}          V_{11} &amp; V_{12}&#92;&#92;          V_{21} &amp; V_{22}&#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}   1 &amp; 0 &#92;&#92;  -V_{22}^{-1}V_{21} &amp; 1 &#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}            1 &amp; 0 &#92;&#92;  V_{22}^{-1}V_{21} &amp; 1 &#92;&#92;  &#92;end{pmatrix}  =  &#92;begin{pmatrix}          1 &amp;     V_{12}V_{22}^{-1} &#92;&#92;      0 &amp; 1&#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}           V_{11.2} &amp; 0 &#92;&#92;           0 &amp; V_{22} &#92;&#92;   &#92;end{pmatrix}   &#92;begin{pmatrix}            1 &amp; 0 &#92;&#92;  V_{22}^{-1}V_{21} &amp; 1 &#92;&#92;  &#92;end{pmatrix}  " class="latex" /><br />
So finally<br />
<img src="//s0.wp.com/latex.php?latex=%5Cbegin%7Bpmatrix%7D++++++++++V_%7B11%7D+%26+V_%7B12%7D%5C%5C++++++++++V_%7B21%7D+%26+V_%7B22%7D%5C%5C++%5Cend%7Bpmatrix%7D%3D++++%5Cbegin%7Bpmatrix%7D++++++++++1+%26++++V_%7B12%7DV_%7B22%7D%5E%7B-1%7D%5C%5C++0++++++%26+1%5C%5C++%5Cend%7Bpmatrix%7D++%5Cbegin%7Bpmatrix%7D+++++++++++V_%7B11.2%7D+%26+0+%5C%5C+++++++++++0+%26+V_%7B22%7D+%5C%5C+++%5Cend%7Bpmatrix%7D+++%5Cbegin%7Bpmatrix%7D++++++++++++1+%26+0+%5C%5C++V_%7B22%7D%5E%7B-1%7DV_%7B21%7D+%26+1+%5C%5C++%5Cend%7Bpmatrix%7D++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;begin{pmatrix}          V_{11} &amp; V_{12}&#92;&#92;          V_{21} &amp; V_{22}&#92;&#92;  &#92;end{pmatrix}=    &#92;begin{pmatrix}          1 &amp;    V_{12}V_{22}^{-1}&#92;&#92;  0      &amp; 1&#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}           V_{11.2} &amp; 0 &#92;&#92;           0 &amp; V_{22} &#92;&#92;   &#92;end{pmatrix}   &#92;begin{pmatrix}            1 &amp; 0 &#92;&#92;  V_{22}^{-1}V_{21} &amp; 1 &#92;&#92;  &#92;end{pmatrix}  " title="&#92;begin{pmatrix}          V_{11} &amp; V_{12}&#92;&#92;          V_{21} &amp; V_{22}&#92;&#92;  &#92;end{pmatrix}=    &#92;begin{pmatrix}          1 &amp;    V_{12}V_{22}^{-1}&#92;&#92;  0      &amp; 1&#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}           V_{11.2} &amp; 0 &#92;&#92;           0 &amp; V_{22} &#92;&#92;   &#92;end{pmatrix}   &#92;begin{pmatrix}            1 &amp; 0 &#92;&#92;  V_{22}^{-1}V_{21} &amp; 1 &#92;&#92;  &#92;end{pmatrix}  " class="latex" /><br />
<img src="//s0.wp.com/latex.php?latex=V%3DUDL++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="V=UDL  " title="V=UDL  " class="latex" /><br />
Notice how this is a UDL factorization. It is entirely possible to do things a little differently and result with the LDU decomposition<br />
Consider right and left multiplying this matrix by<br />
<img src="//s0.wp.com/latex.php?latex=%5Cbegin%7Bpmatrix%7D++++++++++1+%26+0%5C%5C++++++++++-V_%7B21%7DV_%7B11%7D%5E%7B-1%7D+%26+1%5C%5C++%5Cend%7Bpmatrix%7D++++%5Cbegin%7Bpmatrix%7D++++++++++V_%7B11%7D+%26+V_%7B12%7D%5C%5C++++++++++V_%7B21%7D+%26+V_%7B22%7D%5C%5C++%5Cend%7Bpmatrix%7D++%5Cbegin%7Bpmatrix%7D++++++++++++1+%26+-V_%7B11%7D%5E%7B-1%7DV_%7B12%7D+%5C%5C++0+%26+1+%5C%5C++%5Cend%7Bpmatrix%7D++%3D++%5Cbegin%7Bpmatrix%7D++++++++++++V_%7B11%7D+%26+0+%5C%5C++0+%26+V_%7B22.1%7D+%5C%5C++%5Cend%7Bpmatrix%7D++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;begin{pmatrix}          1 &amp; 0&#92;&#92;          -V_{21}V_{11}^{-1} &amp; 1&#92;&#92;  &#92;end{pmatrix}    &#92;begin{pmatrix}          V_{11} &amp; V_{12}&#92;&#92;          V_{21} &amp; V_{22}&#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}            1 &amp; -V_{11}^{-1}V_{12} &#92;&#92;  0 &amp; 1 &#92;&#92;  &#92;end{pmatrix}  =  &#92;begin{pmatrix}            V_{11} &amp; 0 &#92;&#92;  0 &amp; V_{22.1} &#92;&#92;  &#92;end{pmatrix}  " title="&#92;begin{pmatrix}          1 &amp; 0&#92;&#92;          -V_{21}V_{11}^{-1} &amp; 1&#92;&#92;  &#92;end{pmatrix}    &#92;begin{pmatrix}          V_{11} &amp; V_{12}&#92;&#92;          V_{21} &amp; V_{22}&#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}            1 &amp; -V_{11}^{-1}V_{12} &#92;&#92;  0 &amp; 1 &#92;&#92;  &#92;end{pmatrix}  =  &#92;begin{pmatrix}            V_{11} &amp; 0 &#92;&#92;  0 &amp; V_{22.1} &#92;&#92;  &#92;end{pmatrix}  " class="latex" /><br />
where<br />
<img src="//s0.wp.com/latex.php?latex=V_%7B22.1%7D%3DV_%7B22%7D-V_%7B21%7DV_%7B11%7D%5E%7B-1%7DV_%7B12%7D++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="V_{22.1}=V_{22}-V_{21}V_{11}^{-1}V_{12}  " title="V_{22.1}=V_{22}-V_{21}V_{11}^{-1}V_{12}  " class="latex" /><br />
i.e. the Schur complement of matrix V with respect to block 11. So finally<br />
<img src="//s0.wp.com/latex.php?latex=%5Cbegin%7Bpmatrix%7D++++++++++V_%7B11%7D+%26+V_%7B12%7D%5C%5C++++++++++V_%7B21%7D+%26+V_%7B22%7D%5C%5C++%5Cend%7Bpmatrix%7D++++%3D++%5Cbegin%7Bpmatrix%7D++++++++++1+%26+0%5C%5C++++++++++V_%7B21%7DV_%7B11%7D%5E%7B-1%7D+%26+1%5C%5C++%5Cend%7Bpmatrix%7D++%5Cbegin%7Bpmatrix%7D++++++++++++V_%7B11%7D+%26+0+%5C%5C++0+%26+V_%7B22.1%7D+%5C%5C++%5Cend%7Bpmatrix%7D++%5Cbegin%7Bpmatrix%7D++++++++++++1+%26+V_%7B11%7D%5E%7B-1%7DV_%7B12%7D+%5C%5C++0+%26+1+%5C%5C++%5Cend%7Bpmatrix%7D++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;begin{pmatrix}          V_{11} &amp; V_{12}&#92;&#92;          V_{21} &amp; V_{22}&#92;&#92;  &#92;end{pmatrix}    =  &#92;begin{pmatrix}          1 &amp; 0&#92;&#92;          V_{21}V_{11}^{-1} &amp; 1&#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}            V_{11} &amp; 0 &#92;&#92;  0 &amp; V_{22.1} &#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}            1 &amp; V_{11}^{-1}V_{12} &#92;&#92;  0 &amp; 1 &#92;&#92;  &#92;end{pmatrix}  " title="&#92;begin{pmatrix}          V_{11} &amp; V_{12}&#92;&#92;          V_{21} &amp; V_{22}&#92;&#92;  &#92;end{pmatrix}    =  &#92;begin{pmatrix}          1 &amp; 0&#92;&#92;          V_{21}V_{11}^{-1} &amp; 1&#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}            V_{11} &amp; 0 &#92;&#92;  0 &amp; V_{22.1} &#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}            1 &amp; V_{11}^{-1}V_{12} &#92;&#92;  0 &amp; 1 &#92;&#92;  &#92;end{pmatrix}  " class="latex" /><br />
<img src="//s0.wp.com/latex.php?latex=V%3DLDU++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="V=LDU  " title="V=LDU  " class="latex" /></p>
<p>The post <a rel="nofollow" href="http://www.lindonslog.com/mathematics/diagonalize-positive-definite-symmetric-matrix-schur-complement-ldu-decomposition/">Diagonalize a Positive-Definite Symmetric Matrix using the Schur Complement and LDU Decomposition</a> appeared first on <a rel="nofollow" href="http://www.lindonslog.com">Ive Moved</a>.</p>
]]></content:encoded>
			<wfw:commentRss>http://www.lindonslog.com/mathematics/diagonalize-positive-definite-symmetric-matrix-schur-complement-ldu-decomposition/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
	</channel>
</rss>
