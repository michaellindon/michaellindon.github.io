---
id: 165
title: Diagonalize a Positive-Definite Symmetric Matrix using the Schur Complement and LDU Decomposition
date: 2013-05-15T19:49:35+00:00
author: admin
layout: post
guid: http://www.lindonslog.com/?p=165
permalink: /mathematics/diagonalize-positive-definite-symmetric-matrix-schur-complement-ldu-decomposition/
categories:
  - Linear Algebra
  - Mathematics
---
Diagonalizing a matrix comes up frequently for me when wanting to diagonalize the variance matrix of a [multivariate normal to derive conditional distributions](http://www.lindonslog.com/mathematics/multivariate-normal-conditional-distribution/ "Multivariate Normal Conditional Distribution"). I prefer to proceed by doing an LDU Decomposition and leaving it in terms of the Schur complement as I find it easier to remember. Consider some matrix V and partition it as follows
  
<img src="//s0.wp.com/latex.php?latex=%5Cbegin%7Bpmatrix%7D++++++++++V_%7B11%7D+%26+V_%7B12%7D%5C%5C++++++++++V_%7B21%7D+%26+V_%7B22%7D%5C%5C++%5Cend%7Bpmatrix%7D%3DV++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;begin{pmatrix}          V_{11} & V_{12}&#92;&#92;          V_{21} & V_{22}&#92;&#92;  &#92;end{pmatrix}=V  " title="&#92;begin{pmatrix}          V_{11} & V_{12}&#92;&#92;          V_{21} & V_{22}&#92;&#92;  &#92;end{pmatrix}=V  " class="latex" />
  
Consider right and left multiplying this matrix by
  
<img src="//s0.wp.com/latex.php?latex=%5Cbegin%7Bpmatrix%7D++++++++++1+%26+-V_%7B12%7DV_%7B22%7D%5E%7B-1%7D%5C%5C++++++++++0+%26+1%5C%5C++%5Cend%7Bpmatrix%7D++++%5Cbegin%7Bpmatrix%7D++++++++++V_%7B11%7D+%26+V_%7B12%7D%5C%5C++++++++++V_%7B21%7D+%26+V_%7B22%7D%5C%5C++%5Cend%7Bpmatrix%7D++%5Cbegin%7Bpmatrix%7D++++++++++++1+%26+0+%5C%5C++-V_%7B22%7D%5E%7B-1%7DV_%7B21%7D+%26+1+%5C%5C++%5Cend%7Bpmatrix%7D++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;begin{pmatrix}          1 & -V_{12}V_{22}^{-1}&#92;&#92;          0 & 1&#92;&#92;  &#92;end{pmatrix}    &#92;begin{pmatrix}          V_{11} & V_{12}&#92;&#92;          V_{21} & V_{22}&#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}            1 & 0 &#92;&#92;  -V_{22}^{-1}V_{21} & 1 &#92;&#92;  &#92;end{pmatrix}  " title="&#92;begin{pmatrix}          1 & -V_{12}V_{22}^{-1}&#92;&#92;          0 & 1&#92;&#92;  &#92;end{pmatrix}    &#92;begin{pmatrix}          V_{11} & V_{12}&#92;&#92;          V_{21} & V_{22}&#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}            1 & 0 &#92;&#92;  -V_{22}^{-1}V_{21} & 1 &#92;&#92;  &#92;end{pmatrix}  " class="latex" />
  
The matrices really correspond to the L and U matrices in the LDU decomposition, noting that the matrix on the right or left is just the transpose of the other. Define the Schur complement of the matrix V with respect to the block V22 as
  
<img src="//s0.wp.com/latex.php?latex=V_%7B11.2%7D%3DV_%7B11%7D-V_%7B12%7DV_%7B22%7D%5E%7B-1%7DV_%7B21%7D++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="V_{11.2}=V_{11}-V_{12}V_{22}^{-1}V_{21}  " title="V_{11.2}=V_{11}-V_{12}V_{22}^{-1}V_{21}  " class="latex" />
  
then working through the above multiplication it follows that
  
<img src="//s0.wp.com/latex.php?latex=%5Cbegin%7Bpmatrix%7D++++++++++1+%26+-V_%7B12%7DV_%7B22%7D%5E%7B-1%7D%5C%5C++++++++++0+%26+1%5C%5C++%5Cend%7Bpmatrix%7D++++%5Cbegin%7Bpmatrix%7D++++++++++V_%7B11%7D+%26+V_%7B12%7D%5C%5C++++++++++V_%7B21%7D+%26+V_%7B22%7D%5C%5C++%5Cend%7Bpmatrix%7D++%5Cbegin%7Bpmatrix%7D++++++++++++1+%26+0+%5C%5C++-V_%7B22%7D%5E%7B-1%7DV_%7B21%7D+%26+1+%5C%5C++%5Cend%7Bpmatrix%7D++%3D++%5Cbegin%7Bpmatrix%7D+++++++++++V_%7B11.2%7D+%26+0+%5C%5C+++++++++++0+%26+V_%7B22%7D+%5C%5C+++%5Cend%7Bpmatrix%7D+++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;begin{pmatrix}          1 & -V_{12}V_{22}^{-1}&#92;&#92;          0 & 1&#92;&#92;  &#92;end{pmatrix}    &#92;begin{pmatrix}          V_{11} & V_{12}&#92;&#92;          V_{21} & V_{22}&#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}            1 & 0 &#92;&#92;  -V_{22}^{-1}V_{21} & 1 &#92;&#92;  &#92;end{pmatrix}  =  &#92;begin{pmatrix}           V_{11.2} & 0 &#92;&#92;           0 & V_{22} &#92;&#92;   &#92;end{pmatrix}   " title="&#92;begin{pmatrix}          1 & -V_{12}V_{22}^{-1}&#92;&#92;          0 & 1&#92;&#92;  &#92;end{pmatrix}    &#92;begin{pmatrix}          V_{11} & V_{12}&#92;&#92;          V_{21} & V_{22}&#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}            1 & 0 &#92;&#92;  -V_{22}^{-1}V_{21} & 1 &#92;&#92;  &#92;end{pmatrix}  =  &#92;begin{pmatrix}           V_{11.2} & 0 &#92;&#92;           0 & V_{22} &#92;&#92;   &#92;end{pmatrix}   " class="latex" />
  
This result is useful in deriving the [Sherman–Morrison–Woodbury matrix inverse formula/identity](http://www.lindonslog.com/mathematics/invert-a-matrix-using-the-woodbury-matrix-inverse-formula-identity/), otherwise known as the matrix inversion lemma.
  
One can now simply multiply the above equation by the corresponding inverse matrices to obtain the LDU decomposition of the matrix V. The inverse matrices are easy 

<img src="//s0.wp.com/latex.php?latex=%5Cbegin%7Bpmatrix%7D++++++++++1+%26+V_%7B12%7DV_%7B22%7D%5E%7B-1%7D%5C%5C++++++++++0+%26+1%5C%5C++%5Cend%7Bpmatrix%7D++%5Cbegin%7Bpmatrix%7D++++++++++1+%26+-V_%7B12%7DV_%7B22%7D%5E%7B-1%7D%5C%5C++++++++++0+%26+1%5C%5C++%5Cend%7Bpmatrix%7D++++%5Cbegin%7Bpmatrix%7D++++++++++V_%7B11%7D+%26+V_%7B12%7D%5C%5C++++++++++V_%7B21%7D+%26+V_%7B22%7D%5C%5C++%5Cend%7Bpmatrix%7D++%5Cbegin%7Bpmatrix%7D+++1+%26+0+%5C%5C++-V_%7B22%7D%5E%7B-1%7DV_%7B21%7D+%26+1+%5C%5C++%5Cend%7Bpmatrix%7D++%5Cbegin%7Bpmatrix%7D++++++++++++1+%26+0+%5C%5C++V_%7B22%7D%5E%7B-1%7DV_%7B21%7D+%26+1+%5C%5C++%5Cend%7Bpmatrix%7D++%3D++%5Cbegin%7Bpmatrix%7D++++++++++1+%26+++++V_%7B12%7DV_%7B22%7D%5E%7B-1%7D+%5C%5C++++++0+%26+1%5C%5C++%5Cend%7Bpmatrix%7D++%5Cbegin%7Bpmatrix%7D+++++++++++V_%7B11.2%7D+%26+0+%5C%5C+++++++++++0+%26+V_%7B22%7D+%5C%5C+++%5Cend%7Bpmatrix%7D+++%5Cbegin%7Bpmatrix%7D++++++++++++1+%26+0+%5C%5C++V_%7B22%7D%5E%7B-1%7DV_%7B21%7D+%26+1+%5C%5C++%5Cend%7Bpmatrix%7D++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;begin{pmatrix}          1 & V_{12}V_{22}^{-1}&#92;&#92;          0 & 1&#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}          1 & -V_{12}V_{22}^{-1}&#92;&#92;          0 & 1&#92;&#92;  &#92;end{pmatrix}    &#92;begin{pmatrix}          V_{11} & V_{12}&#92;&#92;          V_{21} & V_{22}&#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}   1 & 0 &#92;&#92;  -V_{22}^{-1}V_{21} & 1 &#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}            1 & 0 &#92;&#92;  V_{22}^{-1}V_{21} & 1 &#92;&#92;  &#92;end{pmatrix}  =  &#92;begin{pmatrix}          1 &     V_{12}V_{22}^{-1} &#92;&#92;      0 & 1&#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}           V_{11.2} & 0 &#92;&#92;           0 & V_{22} &#92;&#92;   &#92;end{pmatrix}   &#92;begin{pmatrix}            1 & 0 &#92;&#92;  V_{22}^{-1}V_{21} & 1 &#92;&#92;  &#92;end{pmatrix}  " title="&#92;begin{pmatrix}          1 & V_{12}V_{22}^{-1}&#92;&#92;          0 & 1&#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}          1 & -V_{12}V_{22}^{-1}&#92;&#92;          0 & 1&#92;&#92;  &#92;end{pmatrix}    &#92;begin{pmatrix}          V_{11} & V_{12}&#92;&#92;          V_{21} & V_{22}&#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}   1 & 0 &#92;&#92;  -V_{22}^{-1}V_{21} & 1 &#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}            1 & 0 &#92;&#92;  V_{22}^{-1}V_{21} & 1 &#92;&#92;  &#92;end{pmatrix}  =  &#92;begin{pmatrix}          1 &     V_{12}V_{22}^{-1} &#92;&#92;      0 & 1&#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}           V_{11.2} & 0 &#92;&#92;           0 & V_{22} &#92;&#92;   &#92;end{pmatrix}   &#92;begin{pmatrix}            1 & 0 &#92;&#92;  V_{22}^{-1}V_{21} & 1 &#92;&#92;  &#92;end{pmatrix}  " class="latex" />
  
So finally
  
<img src="//s0.wp.com/latex.php?latex=%5Cbegin%7Bpmatrix%7D++++++++++V_%7B11%7D+%26+V_%7B12%7D%5C%5C++++++++++V_%7B21%7D+%26+V_%7B22%7D%5C%5C++%5Cend%7Bpmatrix%7D%3D++++%5Cbegin%7Bpmatrix%7D++++++++++1+%26++++V_%7B12%7DV_%7B22%7D%5E%7B-1%7D%5C%5C++0++++++%26+1%5C%5C++%5Cend%7Bpmatrix%7D++%5Cbegin%7Bpmatrix%7D+++++++++++V_%7B11.2%7D+%26+0+%5C%5C+++++++++++0+%26+V_%7B22%7D+%5C%5C+++%5Cend%7Bpmatrix%7D+++%5Cbegin%7Bpmatrix%7D++++++++++++1+%26+0+%5C%5C++V_%7B22%7D%5E%7B-1%7DV_%7B21%7D+%26+1+%5C%5C++%5Cend%7Bpmatrix%7D++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;begin{pmatrix}          V_{11} & V_{12}&#92;&#92;          V_{21} & V_{22}&#92;&#92;  &#92;end{pmatrix}=    &#92;begin{pmatrix}          1 &    V_{12}V_{22}^{-1}&#92;&#92;  0      & 1&#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}           V_{11.2} & 0 &#92;&#92;           0 & V_{22} &#92;&#92;   &#92;end{pmatrix}   &#92;begin{pmatrix}            1 & 0 &#92;&#92;  V_{22}^{-1}V_{21} & 1 &#92;&#92;  &#92;end{pmatrix}  " title="&#92;begin{pmatrix}          V_{11} & V_{12}&#92;&#92;          V_{21} & V_{22}&#92;&#92;  &#92;end{pmatrix}=    &#92;begin{pmatrix}          1 &    V_{12}V_{22}^{-1}&#92;&#92;  0      & 1&#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}           V_{11.2} & 0 &#92;&#92;           0 & V_{22} &#92;&#92;   &#92;end{pmatrix}   &#92;begin{pmatrix}            1 & 0 &#92;&#92;  V_{22}^{-1}V_{21} & 1 &#92;&#92;  &#92;end{pmatrix}  " class="latex" />
  
<img src="//s0.wp.com/latex.php?latex=V%3DUDL++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="V=UDL  " title="V=UDL  " class="latex" />
  
Notice how this is a UDL factorization. It is entirely possible to do things a little differently and result with the LDU decomposition
  
Consider right and left multiplying this matrix by
  
<img src="//s0.wp.com/latex.php?latex=%5Cbegin%7Bpmatrix%7D++++++++++1+%26+0%5C%5C++++++++++-V_%7B21%7DV_%7B11%7D%5E%7B-1%7D+%26+1%5C%5C++%5Cend%7Bpmatrix%7D++++%5Cbegin%7Bpmatrix%7D++++++++++V_%7B11%7D+%26+V_%7B12%7D%5C%5C++++++++++V_%7B21%7D+%26+V_%7B22%7D%5C%5C++%5Cend%7Bpmatrix%7D++%5Cbegin%7Bpmatrix%7D++++++++++++1+%26+-V_%7B11%7D%5E%7B-1%7DV_%7B12%7D+%5C%5C++0+%26+1+%5C%5C++%5Cend%7Bpmatrix%7D++%3D++%5Cbegin%7Bpmatrix%7D++++++++++++V_%7B11%7D+%26+0+%5C%5C++0+%26+V_%7B22.1%7D+%5C%5C++%5Cend%7Bpmatrix%7D++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;begin{pmatrix}          1 & 0&#92;&#92;          -V_{21}V_{11}^{-1} & 1&#92;&#92;  &#92;end{pmatrix}    &#92;begin{pmatrix}          V_{11} & V_{12}&#92;&#92;          V_{21} & V_{22}&#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}            1 & -V_{11}^{-1}V_{12} &#92;&#92;  0 & 1 &#92;&#92;  &#92;end{pmatrix}  =  &#92;begin{pmatrix}            V_{11} & 0 &#92;&#92;  0 & V_{22.1} &#92;&#92;  &#92;end{pmatrix}  " title="&#92;begin{pmatrix}          1 & 0&#92;&#92;          -V_{21}V_{11}^{-1} & 1&#92;&#92;  &#92;end{pmatrix}    &#92;begin{pmatrix}          V_{11} & V_{12}&#92;&#92;          V_{21} & V_{22}&#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}            1 & -V_{11}^{-1}V_{12} &#92;&#92;  0 & 1 &#92;&#92;  &#92;end{pmatrix}  =  &#92;begin{pmatrix}            V_{11} & 0 &#92;&#92;  0 & V_{22.1} &#92;&#92;  &#92;end{pmatrix}  " class="latex" />
  
where
  
<img src="//s0.wp.com/latex.php?latex=V_%7B22.1%7D%3DV_%7B22%7D-V_%7B21%7DV_%7B11%7D%5E%7B-1%7DV_%7B12%7D++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="V_{22.1}=V_{22}-V_{21}V_{11}^{-1}V_{12}  " title="V_{22.1}=V_{22}-V_{21}V_{11}^{-1}V_{12}  " class="latex" />
  
i.e. the Schur complement of matrix V with respect to block 11. So finally
  
<img src="//s0.wp.com/latex.php?latex=%5Cbegin%7Bpmatrix%7D++++++++++V_%7B11%7D+%26+V_%7B12%7D%5C%5C++++++++++V_%7B21%7D+%26+V_%7B22%7D%5C%5C++%5Cend%7Bpmatrix%7D++++%3D++%5Cbegin%7Bpmatrix%7D++++++++++1+%26+0%5C%5C++++++++++V_%7B21%7DV_%7B11%7D%5E%7B-1%7D+%26+1%5C%5C++%5Cend%7Bpmatrix%7D++%5Cbegin%7Bpmatrix%7D++++++++++++V_%7B11%7D+%26+0+%5C%5C++0+%26+V_%7B22.1%7D+%5C%5C++%5Cend%7Bpmatrix%7D++%5Cbegin%7Bpmatrix%7D++++++++++++1+%26+V_%7B11%7D%5E%7B-1%7DV_%7B12%7D+%5C%5C++0+%26+1+%5C%5C++%5Cend%7Bpmatrix%7D++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="&#92;begin{pmatrix}          V_{11} & V_{12}&#92;&#92;          V_{21} & V_{22}&#92;&#92;  &#92;end{pmatrix}    =  &#92;begin{pmatrix}          1 & 0&#92;&#92;          V_{21}V_{11}^{-1} & 1&#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}            V_{11} & 0 &#92;&#92;  0 & V_{22.1} &#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}            1 & V_{11}^{-1}V_{12} &#92;&#92;  0 & 1 &#92;&#92;  &#92;end{pmatrix}  " title="&#92;begin{pmatrix}          V_{11} & V_{12}&#92;&#92;          V_{21} & V_{22}&#92;&#92;  &#92;end{pmatrix}    =  &#92;begin{pmatrix}          1 & 0&#92;&#92;          V_{21}V_{11}^{-1} & 1&#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}            V_{11} & 0 &#92;&#92;  0 & V_{22.1} &#92;&#92;  &#92;end{pmatrix}  &#92;begin{pmatrix}            1 & V_{11}^{-1}V_{12} &#92;&#92;  0 & 1 &#92;&#92;  &#92;end{pmatrix}  " class="latex" />
  
<img src="//s0.wp.com/latex.php?latex=V%3DLDU++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="V=LDU  " title="V=LDU  " class="latex" />