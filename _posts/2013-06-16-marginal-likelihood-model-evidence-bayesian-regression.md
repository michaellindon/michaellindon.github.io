---
id: 318
title: Marginal Likelihood and Model Evidence in Bayesian Regression
date: 2013-06-16T15:52:46+00:00
author: admin
layout: post
guid: http://www.lindonslog.com/?p=318
permalink: /mathematics/statistics/marginal-likelihood-model-evidence-bayesian-regression/
categories:
  - Statistics
tags:
  - Bayesian
  - Linear Model
  - Marginal Likelihood
  - Model Selection
  - Regression
---
The marginal likelihood or the model evidence is the probability of observing the data given a specific model. This is used in Bayesian model selection and comparison when computing Bayes factor between models, which is simply the ratio of the two respective marginal likelihoods. This can be used to select which covariates to include in a linear model for describing data. Consider the usual normal-inverse gamma prior specification on the regression parameters and variance.

## Normal Inverse-Gamma Priors

<img src="//s0.wp.com/latex.php?latex=%5Cpi%28%5Cbeta%2C%5Csigma%5E%7B2%7D%29%3D%5Cpi%28%5Cbeta%7C%5Csigma%5E%7B2%7D%29%5Cpi%28%5Csigma%5E%7B2%7D%29%5C%5C++%5Cpi%28%5Cbeta%7C%5Csigma%5E%7B2%7D%29%3DN%28%5Cmu_%7B0%7D%2C%5Csigma%5E%7B2%7D+%5CLambda_%7B0%7D%5E%7B-1%7D%29%5C%5C++%5Cpi%28%5Csigma%5E%7B2%7D%29%3DIG%28a_%7B0%7D%2Cb_%7B0%7D%29%5C%5C++f%28Y%7C%5Cbeta%2C%5Csigma%5E%7B2%7D%29%3DN%28X%5Cbeta%2C%5Csigma%5E%7B2%7D%29%5C%5C++&#038;bg=ffffff&#038;fg=000&#038;s=1" alt="&#92;pi(&#92;beta,&#92;sigma^{2})=&#92;pi(&#92;beta|&#92;sigma^{2})&#92;pi(&#92;sigma^{2})&#92;&#92;  &#92;pi(&#92;beta|&#92;sigma^{2})=N(&#92;mu_{0},&#92;sigma^{2} &#92;Lambda_{0}^{-1})&#92;&#92;  &#92;pi(&#92;sigma^{2})=IG(a_{0},b_{0})&#92;&#92;  f(Y|&#92;beta,&#92;sigma^{2})=N(X&#92;beta,&#92;sigma^{2})&#92;&#92;  " title="&#92;pi(&#92;beta,&#92;sigma^{2})=&#92;pi(&#92;beta|&#92;sigma^{2})&#92;pi(&#92;sigma^{2})&#92;&#92;  &#92;pi(&#92;beta|&#92;sigma^{2})=N(&#92;mu_{0},&#92;sigma^{2} &#92;Lambda_{0}^{-1})&#92;&#92;  &#92;pi(&#92;sigma^{2})=IG(a_{0},b_{0})&#92;&#92;  f(Y|&#92;beta,&#92;sigma^{2})=N(X&#92;beta,&#92;sigma^{2})&#92;&#92;  " class="latex" />

Now construct the joint, out of which the regression coefficients and variance will be integrated.

<img src="//s0.wp.com/latex.php?latex=f%28Y%7C%5Cbeta%2C%5Csigma%5E%7B2%7D%29%5Cpi%28%5Cbeta%7C%5Csigma%5E%7B2%7D%29%5Cpi%28%5Csigma%5E%7B2%7D%29%3D++%5Cleft%28+%5Cfrac%7B1%7D%7B2%5Cpi%7D+%5Cright%29%5E%7B%5Cfrac%7Bn%7D%7B2%7D%7D+%5Cleft%28+%5Cfrac%7B1%7D%7B%5Csigma%5E%7B2%7D%7D%5Cright%29%5E%7B%5Cfrac%7Bn%7D%7B2%7D%7D+e%5E%7B-%5Cfrac%7B1%7D%7B2%5Csigma%5E%7B2%7D%7D%28Y-X%5Cbeta%29%27%28Y-X%5Cbeta%29%7D+++%5Cleft%28+%5Cfrac%7B1%7D%7B2%5Cpi%7D%5Cright%29+%5E%7B%5Cfrac%7Bk%7D%7B2%7D%7D%5Cleft%28+%5Cfrac%7B1%7D%7B%5Csigma%5E%7B2%7D%7D+%5Cright%29%5E%7B%5Cfrac%7Bk%7D%7B2%7D%7D+%7C%5CLambda_%7B0%7D%7C%5E%7B%5Cfrac%7B1%7D%7B2%7D%7D+e%5E%7B-%5Cfrac%7B1%7D%7B2%5Csigma%5E%7B2%7D%7D%28%5Cbeta-%5Cmu_%7B0%7D%29%27%5CLambda_%7B0%7D%28%5Cbeta-%5Cmu_%7B0%7D%29%7D++%5Cfrac%7Bb_%7B0%7D%5E%7Ba_%7B0%7D%7D%7D%7B%5CGamma%28a_%7B0%7D%29%7D%5Cleft%28%5Cfrac%7B1%7D%7B%5Csigma%5E%7B2%7D%7D%5Cright%29%5E%7Ba_%7B0%7D-1%7De%5E%7B-%5Cfrac%7Bb_%7B0%7D%7D%7B%5Csigma%5E%7B2%7D%7D%7D%5C%5C++&#038;bg=ffffff&#038;fg=000&#038;s=1" alt="f(Y|&#92;beta,&#92;sigma^{2})&#92;pi(&#92;beta|&#92;sigma^{2})&#92;pi(&#92;sigma^{2})=  &#92;left( &#92;frac{1}{2&#92;pi} &#92;right)^{&#92;frac{n}{2}} &#92;left( &#92;frac{1}{&#92;sigma^{2}}&#92;right)^{&#92;frac{n}{2}} e^{-&#92;frac{1}{2&#92;sigma^{2}}(Y-X&#92;beta)&#039;(Y-X&#92;beta)}   &#92;left( &#92;frac{1}{2&#92;pi}&#92;right) ^{&#92;frac{k}{2}}&#92;left( &#92;frac{1}{&#92;sigma^{2}} &#92;right)^{&#92;frac{k}{2}} |&#92;Lambda_{0}|^{&#92;frac{1}{2}} e^{-&#92;frac{1}{2&#92;sigma^{2}}(&#92;beta-&#92;mu_{0})&#039;&#92;Lambda_{0}(&#92;beta-&#92;mu_{0})}  &#92;frac{b_{0}^{a_{0}}}{&#92;Gamma(a_{0})}&#92;left(&#92;frac{1}{&#92;sigma^{2}}&#92;right)^{a_{0}-1}e^{-&#92;frac{b_{0}}{&#92;sigma^{2}}}&#92;&#92;  " title="f(Y|&#92;beta,&#92;sigma^{2})&#92;pi(&#92;beta|&#92;sigma^{2})&#92;pi(&#92;sigma^{2})=  &#92;left( &#92;frac{1}{2&#92;pi} &#92;right)^{&#92;frac{n}{2}} &#92;left( &#92;frac{1}{&#92;sigma^{2}}&#92;right)^{&#92;frac{n}{2}} e^{-&#92;frac{1}{2&#92;sigma^{2}}(Y-X&#92;beta)&#039;(Y-X&#92;beta)}   &#92;left( &#92;frac{1}{2&#92;pi}&#92;right) ^{&#92;frac{k}{2}}&#92;left( &#92;frac{1}{&#92;sigma^{2}} &#92;right)^{&#92;frac{k}{2}} |&#92;Lambda_{0}|^{&#92;frac{1}{2}} e^{-&#92;frac{1}{2&#92;sigma^{2}}(&#92;beta-&#92;mu_{0})&#039;&#92;Lambda_{0}(&#92;beta-&#92;mu_{0})}  &#92;frac{b_{0}^{a_{0}}}{&#92;Gamma(a_{0})}&#92;left(&#92;frac{1}{&#92;sigma^{2}}&#92;right)^{a_{0}-1}e^{-&#92;frac{b_{0}}{&#92;sigma^{2}}}&#92;&#92;  " class="latex" />

This can be made neater by rearrangement. Consider first the two exponentials above. The exponents can be combined and rewritten in such a manner that a normal kernel in Beta is recognizable. 

<img src="//s0.wp.com/latex.php?latex=%28Y-X%5Cbeta%29%27%28Y-X%5Cbeta%29%2B%28%5Cbeta-%5Cmu_%7B0%7D%29%5CLambda_%7B0%7D%28%5Cbeta_%7B0%7D-%5Cmu_%7B0%7D%29%3D%5C%5C++%5Cbeta%27%28X%27X%2B%5CLambda_%7B0%7D%29%5Cbeta-2%5Cbeta%27%28X%27X%5Chat%7B%5Cbeta%7D%2B%5CLambda_%7B0%7D%5Cmu_%7B0%7D%29+++%2B%5Cmu_%7B0%7D%27%5CLambda_%7B0%7D%5Cmu_%7B0%7D%2B%5Chat%7B%5Cbeta%7DX%27X%5Chat%7B%5Cbeta%7D%2BY%27%28I-P%29Y%3D%5C%5C++%5Cbeta%27%28X%27X%2B%5CLambda_%7B0%7D%29%5Cbeta-2%5Cbeta%27%28X%27X%5Chat%7B%5Cbeta%7D%2B%5CLambda_%7B0%7D%5Cmu_%7B0%7D%29+++%2B%5Cmu_%7B0%7D%27%5CLambda_%7B0%7D%5Cmu_%7B0%7D%2BY%27Y++&#038;bg=ffffff&#038;fg=000&#038;s=0" alt="(Y-X&#92;beta)&#039;(Y-X&#92;beta)+(&#92;beta-&#92;mu_{0})&#92;Lambda_{0}(&#92;beta_{0}-&#92;mu_{0})=&#92;&#92;  &#92;beta&#039;(X&#039;X+&#92;Lambda_{0})&#92;beta-2&#92;beta&#039;(X&#039;X&#92;hat{&#92;beta}+&#92;Lambda_{0}&#92;mu_{0})   +&#92;mu_{0}&#039;&#92;Lambda_{0}&#92;mu_{0}+&#92;hat{&#92;beta}X&#039;X&#92;hat{&#92;beta}+Y&#039;(I-P)Y=&#92;&#92;  &#92;beta&#039;(X&#039;X+&#92;Lambda_{0})&#92;beta-2&#92;beta&#039;(X&#039;X&#92;hat{&#92;beta}+&#92;Lambda_{0}&#92;mu_{0})   +&#92;mu_{0}&#039;&#92;Lambda_{0}&#92;mu_{0}+Y&#039;Y  " title="(Y-X&#92;beta)&#039;(Y-X&#92;beta)+(&#92;beta-&#92;mu_{0})&#92;Lambda_{0}(&#92;beta_{0}-&#92;mu_{0})=&#92;&#92;  &#92;beta&#039;(X&#039;X+&#92;Lambda_{0})&#92;beta-2&#92;beta&#039;(X&#039;X&#92;hat{&#92;beta}+&#92;Lambda_{0}&#92;mu_{0})   +&#92;mu_{0}&#039;&#92;Lambda_{0}&#92;mu_{0}+&#92;hat{&#92;beta}X&#039;X&#92;hat{&#92;beta}+Y&#039;(I-P)Y=&#92;&#92;  &#92;beta&#039;(X&#039;X+&#92;Lambda_{0})&#92;beta-2&#92;beta&#039;(X&#039;X&#92;hat{&#92;beta}+&#92;Lambda_{0}&#92;mu_{0})   +&#92;mu_{0}&#039;&#92;Lambda_{0}&#92;mu_{0}+Y&#039;Y  " class="latex" />

Define:
  
<img src="//s0.wp.com/latex.php?latex=%5CLambda_%7Bn%7D%3DX%27X%2B%5CLambda_%7B0%7D%5C%5C++%5Cmu_%7Bn%7D%3D%28X%27X%2B%5CLambda_%7B0%7D%29%5E%7B-1%7D%28X%27X%5Chat%7B%5Cbeta%7D%2B%5CLambda_%7B0%7D%5Cmu_%7B0%7D%29%3D%5CLambda_%7Bn%7D%5E%7B-1%7D%28X%27X%5Chat%7B%5Cbeta%7D%2B%5CLambda_%7B0%7D%5Cmu_%7B0%7D%29++&#038;bg=ffffff&#038;fg=000&#038;s=1" alt="&#92;Lambda_{n}=X&#039;X+&#92;Lambda_{0}&#92;&#92;  &#92;mu_{n}=(X&#039;X+&#92;Lambda_{0})^{-1}(X&#039;X&#92;hat{&#92;beta}+&#92;Lambda_{0}&#92;mu_{0})=&#92;Lambda_{n}^{-1}(X&#039;X&#92;hat{&#92;beta}+&#92;Lambda_{0}&#92;mu_{0})  " title="&#92;Lambda_{n}=X&#039;X+&#92;Lambda_{0}&#92;&#92;  &#92;mu_{n}=(X&#039;X+&#92;Lambda_{0})^{-1}(X&#039;X&#92;hat{&#92;beta}+&#92;Lambda_{0}&#92;mu_{0})=&#92;Lambda_{n}^{-1}(X&#039;X&#92;hat{&#92;beta}+&#92;Lambda_{0}&#92;mu_{0})  " class="latex" />
  
then the above can written as:

<img src="//s0.wp.com/latex.php?latex=%28Y-X%5Cbeta%29%27%28Y-X%5Cbeta%29%2B%28%5Cbeta-%5Cmu_%7B0%7D%29%5CLambda_%7B0%7D%28%5Cbeta_%7B0%7D-%5Cmu_%7B0%7D%29%3D%5C%5C++%5Cbeta%27%5CLambda_%7Bn%7D%5Cbeta-2%5Cbeta%27%5CLambda_%7Bn%7D%5Cmu_%7Bn%7D%2B%5Cmu_%7B0%7D%27%5CLambda_%7B0%7D%5Cmu_%7B0%7D%2BY%27Y%3D%5C%5C++%28%5Cbeta-%5Cmu_%7Bn%7D%29%5CLambda_%7Bn%7D%28%5Cbeta-%5Cmu_%7Bn%7D%29-%5Cmu_%7Bn%7D%5CLambda_%7Bn%7D%5Cmu_%7Bn%7D%2B%5Cmu_%7B0%7D%27%5CLambda_%7B0%7D%5Cmu_%7B0%7D%2BY%27Y%5C%5C++&#038;bg=ffffff&#038;fg=000&#038;s=1" alt="(Y-X&#92;beta)&#039;(Y-X&#92;beta)+(&#92;beta-&#92;mu_{0})&#92;Lambda_{0}(&#92;beta_{0}-&#92;mu_{0})=&#92;&#92;  &#92;beta&#039;&#92;Lambda_{n}&#92;beta-2&#92;beta&#039;&#92;Lambda_{n}&#92;mu_{n}+&#92;mu_{0}&#039;&#92;Lambda_{0}&#92;mu_{0}+Y&#039;Y=&#92;&#92;  (&#92;beta-&#92;mu_{n})&#92;Lambda_{n}(&#92;beta-&#92;mu_{n})-&#92;mu_{n}&#92;Lambda_{n}&#92;mu_{n}+&#92;mu_{0}&#039;&#92;Lambda_{0}&#92;mu_{0}+Y&#039;Y&#92;&#92;  " title="(Y-X&#92;beta)&#039;(Y-X&#92;beta)+(&#92;beta-&#92;mu_{0})&#92;Lambda_{0}(&#92;beta_{0}-&#92;mu_{0})=&#92;&#92;  &#92;beta&#039;&#92;Lambda_{n}&#92;beta-2&#92;beta&#039;&#92;Lambda_{n}&#92;mu_{n}+&#92;mu_{0}&#039;&#92;Lambda_{0}&#92;mu_{0}+Y&#039;Y=&#92;&#92;  (&#92;beta-&#92;mu_{n})&#92;Lambda_{n}(&#92;beta-&#92;mu_{n})-&#92;mu_{n}&#92;Lambda_{n}&#92;mu_{n}+&#92;mu_{0}&#039;&#92;Lambda_{0}&#92;mu_{0}+Y&#039;Y&#92;&#92;  " class="latex" />
  
where the last line was achieved by completing the square.

<img src="//s0.wp.com/latex.php?latex=f%28Y%7C%5Cbeta%2C%5Csigma%5E%7B2%7D%29%5Cpi%28%5Cbeta%7C%5Csigma%5E%7B2%7D%29%5Cpi%28%5Csigma%5E%7B2%7D%29%3Df%28Y%2C%5Cbeta%2C%5Csigma%5E%7B2%7D%29%3D%5C%5C++%5Cleft%28+%5Cfrac%7B1%7D%7B2%5Cpi%7D+%5Cright%29%5E%7B%5Cfrac%7Bn%7D%7B2%7D%7D+%5Cleft%28+%5Cfrac%7B1%7D%7B%5Csigma%5E%7B2%7D%7D%5Cright%29%5E%7B%5Cfrac%7Bn%7D%7B2%7D%7D+e%5E%7B-%5Cfrac%7B1%7D%7B2%5Csigma%5E%7B2%7D%7D%28Y%27Y-%5Cmu_%7Bn%7D%5CLambda_%7Bn%7D%5Cmu_%7Bn%7D%2B%5Cmu_%7B0%7D%27%5CLambda_%7B0%7D%5Cmu_%7B0%7D%29%7D++%5Cleft%28+%5Cfrac%7B1%7D%7B2%5Cpi%7D%5Cright%29+%5E%7B%5Cfrac%7Bk%7D%7B2%7D%7D%5Cleft%28+%5Cfrac%7B1%7D%7B%5Csigma%5E%7B2%7D%7D+%5Cright%29%5E%7B%5Cfrac%7Bk%7D%7B2%7D%7D+%7C%5CLambda_%7B0%7D%7C%5E%7B%5Cfrac%7B1%7D%7B2%7D%7D+e%5E%7B-%5Cfrac%7B1%7D%7B2%5Csigma%5E%7B2%7D%7D%28%5Cbeta-%5Cmu_%7Bn%7D%29%5CLambda_%7Bn%7D%28%5Cbeta-%5Cmu_%7Bn%7D%29%7D+++%5Cfrac%7Bb_%7B0%7D%5E%7Ba_%7B0%7D%7D%7D%7B%5CGamma%28a_%7B0%7D%29%7D%5Cleft%28%5Cfrac%7B1%7D%7B%5Csigma%5E%7B2%7D%7D%5Cright%29%5E%7Ba_%7B0%7D-1%7De%5E%7B-%5Cfrac%7Bb_%7B0%7D%7D%7B%5Csigma%5E%7B2%7D%7D%7D%5C%5C++&#038;bg=ffffff&#038;fg=000&#038;s=1" alt="f(Y|&#92;beta,&#92;sigma^{2})&#92;pi(&#92;beta|&#92;sigma^{2})&#92;pi(&#92;sigma^{2})=f(Y,&#92;beta,&#92;sigma^{2})=&#92;&#92;  &#92;left( &#92;frac{1}{2&#92;pi} &#92;right)^{&#92;frac{n}{2}} &#92;left( &#92;frac{1}{&#92;sigma^{2}}&#92;right)^{&#92;frac{n}{2}} e^{-&#92;frac{1}{2&#92;sigma^{2}}(Y&#039;Y-&#92;mu_{n}&#92;Lambda_{n}&#92;mu_{n}+&#92;mu_{0}&#039;&#92;Lambda_{0}&#92;mu_{0})}  &#92;left( &#92;frac{1}{2&#92;pi}&#92;right) ^{&#92;frac{k}{2}}&#92;left( &#92;frac{1}{&#92;sigma^{2}} &#92;right)^{&#92;frac{k}{2}} |&#92;Lambda_{0}|^{&#92;frac{1}{2}} e^{-&#92;frac{1}{2&#92;sigma^{2}}(&#92;beta-&#92;mu_{n})&#92;Lambda_{n}(&#92;beta-&#92;mu_{n})}   &#92;frac{b_{0}^{a_{0}}}{&#92;Gamma(a_{0})}&#92;left(&#92;frac{1}{&#92;sigma^{2}}&#92;right)^{a_{0}-1}e^{-&#92;frac{b_{0}}{&#92;sigma^{2}}}&#92;&#92;  " title="f(Y|&#92;beta,&#92;sigma^{2})&#92;pi(&#92;beta|&#92;sigma^{2})&#92;pi(&#92;sigma^{2})=f(Y,&#92;beta,&#92;sigma^{2})=&#92;&#92;  &#92;left( &#92;frac{1}{2&#92;pi} &#92;right)^{&#92;frac{n}{2}} &#92;left( &#92;frac{1}{&#92;sigma^{2}}&#92;right)^{&#92;frac{n}{2}} e^{-&#92;frac{1}{2&#92;sigma^{2}}(Y&#039;Y-&#92;mu_{n}&#92;Lambda_{n}&#92;mu_{n}+&#92;mu_{0}&#039;&#92;Lambda_{0}&#92;mu_{0})}  &#92;left( &#92;frac{1}{2&#92;pi}&#92;right) ^{&#92;frac{k}{2}}&#92;left( &#92;frac{1}{&#92;sigma^{2}} &#92;right)^{&#92;frac{k}{2}} |&#92;Lambda_{0}|^{&#92;frac{1}{2}} e^{-&#92;frac{1}{2&#92;sigma^{2}}(&#92;beta-&#92;mu_{n})&#92;Lambda_{n}(&#92;beta-&#92;mu_{n})}   &#92;frac{b_{0}^{a_{0}}}{&#92;Gamma(a_{0})}&#92;left(&#92;frac{1}{&#92;sigma^{2}}&#92;right)^{a_{0}-1}e^{-&#92;frac{b_{0}}{&#92;sigma^{2}}}&#92;&#92;  " class="latex" />

Recognizing the kernel of a normal for Beta and knowing the normalizing constant the integral over Beta is now simple. Integrating out Beta yields:

<img src="//s0.wp.com/latex.php?latex=f%28Y%2C%5Csigma%5E%7B2%7D%29%3D++%5Cleft%28+%5Cfrac%7B1%7D%7B2%5Cpi%7D+%5Cright%29%5E%7B%5Cfrac%7Bn%7D%7B2%7D%7D+%5Cleft%28+%5Cfrac%7B1%7D%7B%5Csigma%5E%7B2%7D%7D%5Cright%29%5E%7B%5Cfrac%7Bn%7D%7B2%7D%7D+e%5E%7B-%5Cfrac%7B1%7D%7B2%5Csigma%5E%7B2%7D%7D%28Y%27Y-%5Cmu_%7Bn%7D%5CLambda_%7Bn%7D%5Cmu_%7Bn%7D%2B%5Cmu_%7B0%7D%27%5CLambda_%7B0%7D%5Cmu_%7B0%7D%29%7D+++%5Cfrac%7B%7C%5CLambda_%7B0%7D%7C%5E%7B%5Cfrac%7B1%7D%7B2%7D%7D%7D%7B%7C%5CLambda_%7Bn%7D%7C%5E%7B%5Cfrac%7B1%7D%7B2%7D%7D%7D+++%5Cfrac%7Bb_%7B0%7D%5E%7Ba_%7B0%7D%7D%7D%7B%5CGamma%28a_%7B0%7D%29%7D%5Cleft%28%5Cfrac%7B1%7D%7B%5Csigma%5E%7B2%7D%7D%5Cright%29%5E%7Ba_%7B0%7D-1%7De%5E%7B-%5Cfrac%7Bb_%7B0%7D%7D%7B%5Csigma%5E%7B2%7D%7D%7D%5C%5C++&#038;bg=ffffff&#038;fg=000&#038;s=1" alt="f(Y,&#92;sigma^{2})=  &#92;left( &#92;frac{1}{2&#92;pi} &#92;right)^{&#92;frac{n}{2}} &#92;left( &#92;frac{1}{&#92;sigma^{2}}&#92;right)^{&#92;frac{n}{2}} e^{-&#92;frac{1}{2&#92;sigma^{2}}(Y&#039;Y-&#92;mu_{n}&#92;Lambda_{n}&#92;mu_{n}+&#92;mu_{0}&#039;&#92;Lambda_{0}&#92;mu_{0})}   &#92;frac{|&#92;Lambda_{0}|^{&#92;frac{1}{2}}}{|&#92;Lambda_{n}|^{&#92;frac{1}{2}}}   &#92;frac{b_{0}^{a_{0}}}{&#92;Gamma(a_{0})}&#92;left(&#92;frac{1}{&#92;sigma^{2}}&#92;right)^{a_{0}-1}e^{-&#92;frac{b_{0}}{&#92;sigma^{2}}}&#92;&#92;  " title="f(Y,&#92;sigma^{2})=  &#92;left( &#92;frac{1}{2&#92;pi} &#92;right)^{&#92;frac{n}{2}} &#92;left( &#92;frac{1}{&#92;sigma^{2}}&#92;right)^{&#92;frac{n}{2}} e^{-&#92;frac{1}{2&#92;sigma^{2}}(Y&#039;Y-&#92;mu_{n}&#92;Lambda_{n}&#92;mu_{n}+&#92;mu_{0}&#039;&#92;Lambda_{0}&#92;mu_{0})}   &#92;frac{|&#92;Lambda_{0}|^{&#92;frac{1}{2}}}{|&#92;Lambda_{n}|^{&#92;frac{1}{2}}}   &#92;frac{b_{0}^{a_{0}}}{&#92;Gamma(a_{0})}&#92;left(&#92;frac{1}{&#92;sigma^{2}}&#92;right)^{a_{0}-1}e^{-&#92;frac{b_{0}}{&#92;sigma^{2}}}&#92;&#92;  " class="latex" />

Following a similar strategy as that for Beta, this can be rearranged into something containing a Gamma kernel for sigma squared.

<img src="//s0.wp.com/latex.php?latex=f%28Y%2C%5Csigma%5E%7B2%7D%29%3D%5Cleft%28+%5Cfrac%7B1%7D%7B2%5Cpi%7D+%5Cright%29%5E%7B%5Cfrac%7Bn%7D%7B2%7D%7D+%5Cleft%28+%5Cfrac%7B1%7D%7B%5Csigma%5E%7B2%7D%7D%5Cright%29%5E%7B%5Cfrac%7Bn%7D%7B2%7D%2Ba_%7B0%7D-1%7D+e%5E%7B-%5Cfrac%7Bb_%7B0%7D%2B%5Cfrac%7B1%7D%7B2%7D%28Y%27Y-%5Cmu_%7Bn%7D%27%5CLambda_%7Bn%7D%5Cmu_%7Bn%7D%2B%5Cmu_%7B0%7D%27%5CLambda_%7B0%7D%5Cmu_%7B0%7D%29%7D%7B%5Csigma%5E%7B2%7D%7D%7D++++%5Cfrac%7B%7C%5CLambda_%7B0%7D%7C%5E%7B%5Cfrac%7B1%7D%7B2%7D%7D%7D%7B%7C%5CLambda_%7Bn%7D%7C%5E%7B%5Cfrac%7B1%7D%7B2%7D%7D%7D+++%5Cfrac%7Bb_%7B0%7D%5E%7Ba_%7B0%7D%7D%7D%7B%5CGamma%28a_%7B0%7D%29%7D++&#038;bg=ffffff&#038;fg=000&#038;s=1" alt="f(Y,&#92;sigma^{2})=&#92;left( &#92;frac{1}{2&#92;pi} &#92;right)^{&#92;frac{n}{2}} &#92;left( &#92;frac{1}{&#92;sigma^{2}}&#92;right)^{&#92;frac{n}{2}+a_{0}-1} e^{-&#92;frac{b_{0}+&#92;frac{1}{2}(Y&#039;Y-&#92;mu_{n}&#039;&#92;Lambda_{n}&#92;mu_{n}+&#92;mu_{0}&#039;&#92;Lambda_{0}&#92;mu_{0})}{&#92;sigma^{2}}}    &#92;frac{|&#92;Lambda_{0}|^{&#92;frac{1}{2}}}{|&#92;Lambda_{n}|^{&#92;frac{1}{2}}}   &#92;frac{b_{0}^{a_{0}}}{&#92;Gamma(a_{0})}  " title="f(Y,&#92;sigma^{2})=&#92;left( &#92;frac{1}{2&#92;pi} &#92;right)^{&#92;frac{n}{2}} &#92;left( &#92;frac{1}{&#92;sigma^{2}}&#92;right)^{&#92;frac{n}{2}+a_{0}-1} e^{-&#92;frac{b_{0}+&#92;frac{1}{2}(Y&#039;Y-&#92;mu_{n}&#039;&#92;Lambda_{n}&#92;mu_{n}+&#92;mu_{0}&#039;&#92;Lambda_{0}&#92;mu_{0})}{&#92;sigma^{2}}}    &#92;frac{|&#92;Lambda_{0}|^{&#92;frac{1}{2}}}{|&#92;Lambda_{n}|^{&#92;frac{1}{2}}}   &#92;frac{b_{0}^{a_{0}}}{&#92;Gamma(a_{0})}  " class="latex" />

Define
  
<img src="//s0.wp.com/latex.php?latex=a_%7Bn%7D%3Da_%7B0%7D%2B%5Cfrac%7Bn%7D%7B2%7D%5C%5C++b_%7Bn%7D%3Db_%7B0%7D%2B%5Cfrac%7B1%7D%7B2%7D%28Y%27Y-%5Cmu_%7Bn%7D%5CLambda_%7Bn%7D%5Cmu_%7Bn%7D%2B%5Cmu_%7B0%7D%27%5CLambda_%7B0%7D%5Cmu_%7B0%7D%29++&#038;bg=ffffff&#038;fg=000&#038;s=1" alt="a_{n}=a_{0}+&#92;frac{n}{2}&#92;&#92;  b_{n}=b_{0}+&#92;frac{1}{2}(Y&#039;Y-&#92;mu_{n}&#92;Lambda_{n}&#92;mu_{n}+&#92;mu_{0}&#039;&#92;Lambda_{0}&#92;mu_{0})  " title="a_{n}=a_{0}+&#92;frac{n}{2}&#92;&#92;  b_{n}=b_{0}+&#92;frac{1}{2}(Y&#039;Y-&#92;mu_{n}&#92;Lambda_{n}&#92;mu_{n}+&#92;mu_{0}&#039;&#92;Lambda_{0}&#92;mu_{0})  " class="latex" />
  
Then the above reads

<img src="//s0.wp.com/latex.php?latex=f%28Y%2C%5Csigma%5E%7B2%7D%29%3D%5Cleft%28+%5Cfrac%7B1%7D%7B2%5Cpi%7D+%5Cright%29%5E%7B%5Cfrac%7Bn%7D%7B2%7D%7D++++%5Cfrac%7B%7C%5CLambda_%7B0%7D%7C%5E%7B%5Cfrac%7B1%7D%7B2%7D%7D%7D%7B%7C%5CLambda_%7Bn%7D%7C%5E%7B%5Cfrac%7B1%7D%7B2%7D%7D%7D++%5Cfrac%7Bb_%7B0%7D%5E%7Ba_%7B0%7D%7D%7D%7B%5CGamma%28a_%7B0%7D%29%7D+++%5Cleft%28+%5Cfrac%7B1%7D%7B%5Csigma%5E%7B2%7D%7D%5Cright%29%5E%7Ba_%7Bn%7D-1%7D+e%5E%7B-%5Cfrac%7Bb_%7Bn%7D%7D%7B%5Csigma%5E%7B2%7D%7D%7D%5C%5C+++&#038;bg=ffffff&#038;fg=000&#038;s=1" alt="f(Y,&#92;sigma^{2})=&#92;left( &#92;frac{1}{2&#92;pi} &#92;right)^{&#92;frac{n}{2}}    &#92;frac{|&#92;Lambda_{0}|^{&#92;frac{1}{2}}}{|&#92;Lambda_{n}|^{&#92;frac{1}{2}}}  &#92;frac{b_{0}^{a_{0}}}{&#92;Gamma(a_{0})}   &#92;left( &#92;frac{1}{&#92;sigma^{2}}&#92;right)^{a_{n}-1} e^{-&#92;frac{b_{n}}{&#92;sigma^{2}}}&#92;&#92;   " title="f(Y,&#92;sigma^{2})=&#92;left( &#92;frac{1}{2&#92;pi} &#92;right)^{&#92;frac{n}{2}}    &#92;frac{|&#92;Lambda_{0}|^{&#92;frac{1}{2}}}{|&#92;Lambda_{n}|^{&#92;frac{1}{2}}}  &#92;frac{b_{0}^{a_{0}}}{&#92;Gamma(a_{0})}   &#92;left( &#92;frac{1}{&#92;sigma^{2}}&#92;right)^{a_{n}-1} e^{-&#92;frac{b_{n}}{&#92;sigma^{2}}}&#92;&#92;   " class="latex" />

Recognizing the kernel of a Gamma makes the integration easy, which yields the final result for the marginal likelihood below.

## Marginal Likelihood/Model Evidence

<img src="//s0.wp.com/latex.php?latex=m%28Y%29%3D%5Cleft%28+%5Cfrac%7B1%7D%7B2%5Cpi%7D+%5Cright%29%5E%7B%5Cfrac%7Bn%7D%7B2%7D%7D++++%5Cfrac%7B%7C%5CLambda_%7B0%7D%7C%5E%7B%5Cfrac%7B1%7D%7B2%7D%7D%7D%7B%7C%5CLambda_%7Bn%7D%7C%5E%7B%5Cfrac%7B1%7D%7B2%7D%7D%7D++%5Cfrac%7Bb_%7B0%7D%5E%7Ba_%7B0%7D%7D%7D%7Bb_%7Bn%7D%5E%7Ba_%7Bn%7D%7D%7D++%5Cfrac%7B%5CGamma%28a_%7Bn%7D%29%7D%7B%5CGamma%28a_%7B0%7D%29%7D%5C%5C+&#038;bg=ffffff&#038;fg=000&#038;s=2" alt="m(Y)=&#92;left( &#92;frac{1}{2&#92;pi} &#92;right)^{&#92;frac{n}{2}}    &#92;frac{|&#92;Lambda_{0}|^{&#92;frac{1}{2}}}{|&#92;Lambda_{n}|^{&#92;frac{1}{2}}}  &#92;frac{b_{0}^{a_{0}}}{b_{n}^{a_{n}}}  &#92;frac{&#92;Gamma(a_{n})}{&#92;Gamma(a_{0})}&#92;&#92; " title="m(Y)=&#92;left( &#92;frac{1}{2&#92;pi} &#92;right)^{&#92;frac{n}{2}}    &#92;frac{|&#92;Lambda_{0}|^{&#92;frac{1}{2}}}{|&#92;Lambda_{n}|^{&#92;frac{1}{2}}}  &#92;frac{b_{0}^{a_{0}}}{b_{n}^{a_{n}}}  &#92;frac{&#92;Gamma(a_{n})}{&#92;Gamma(a_{0})}&#92;&#92; " class="latex" />

An example application of this can be found here in [linear model selection](http://www.lindonslog.com/mathematics/statistics/model-selection-in-bayesian-linear-regression/ "Model Selection in Bayesian Linear Regression").